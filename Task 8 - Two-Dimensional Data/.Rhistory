cat("\n")
}
cat("–ß–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π Q: ", Q, "\n\n")
# 3) –ù–∞–π–¥–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#    –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ö–µ–Ω–¥–∞–ª–ª–∞ Íöå (—Ç–∞—É –ö–µ–Ω–¥–∞–ª–ª–∞, Kendall‚Äôs tau)
#    ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–∞—Ä–∞—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π,
#    –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –æ–±—â–µ–µ —á–∏—Å–ª–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä:
#
#    –§–æ—Ä–º—É–ª–∞ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#        P-Q
#    Íöå = ‚Äî‚Äî‚Äî
#        P+Q
#    –≥–¥–µ:
#    ‚Ä¢ P ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç –æ–¥–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∫ –¥—Ä—É–≥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–µ–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å—Ç–æ—Ä–æ–Ω—É;
#    ‚Ä¢ Q ‚Äî –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏–ª–∏ –∏–Ω–≤–µ—Ä—Å–∏–∏.
#
#    –§–æ—Ä–º—É–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π P:
#
#        N*(N-1)
#    P = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî - Q
#           2
P <- (nrow(x5.tour)*(nrow(x5.tour)-1))/2 - Q; cat("–ß–∏—Å–ª–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π P: ", P, "\n\n")
T.Kendall <- (P-Q)/(P+Q);                     cat("Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞: ", T.Kendall, "\n\n")
#    Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ —Ç–∞–∫–∂–µ –º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –æ—Ç ‚Äì1 –¥–æ 1 –∏ —Ä–∞–≤–µ–Ω 0 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
#    –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Q –Æ–ª–∞, –∑–Ω–∞–∫ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é: –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏.
#    –¢–∞–∫,
#         ‚Ä¢ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä—è–º–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:     –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–π –¥—Ä—É–≥–∞—è —Ç–∞–∫–∂–µ —Ä–∞—Å—Ç—ë—Ç;
#         ‚Ä¢ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: —Ä–æ—Å—Ç—É –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –¥—Ä—É–≥–æ–π.
x1 <- read.csv("C:/Users/ak179/OneDrive/–ú–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞/2 –ö–£–†–°/1 –°–ï–ú–ï–°–¢–†/–õ–µ–∫—Ü–∏–∏ (2 –∫—É—Ä—Å)/–Ø–∑—ã–∫ R (—à–ø–æ—Ä—ã –∏ –∑–∞–¥–∞—á–∏)/–°–∫—Ä–∏–ø—Ç—ã/–ó–∞–¥–∞–Ω–∏–µ 8/pet_state.dat")
#    1.1) –ü–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø–µ—Ä–≤—ã–µ 6 –Ω–∞—á–∞–ª—å–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã:
head(x1)
#         –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤—Å–µ–π —Ç–∞–±–ª–∏—Ü—ã:
str(x1)
x1$married <- factor(x1$married)
x1$pet     <- factor(x1$pet)
str(x1)
levels(x1$married) <- c("–æ–¥–∏–Ω–æ–∫–∏–π ", "–≤ –±—Ä–∞–∫–µ")
levels(x1$pet)     <- c("–∫–æ—à–∫–∏ ", "—Å–æ–±–∞–∫–∏")
#    1.4) –ü–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã —Å —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –µ—ë:
str(x1)
#    1.2) –ò–∑–º–µ–Ω–∏–º —Ñ–æ—Ä–º–∞—Ç —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã —Å —á–∏—Å–ª–æ–≤–æ–≥–æ –Ω–∞ –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–π.
#         –î–ª—è —ç—Ç–æ–≥–æ –ø–µ—Ä–µ–≤–µ–¥–µ–º –≤–µ–∫—Ç–æ—Ä—ã –∏–∑ —á–∏—Å–ª–æ–≤–æ–≥–æ —Ä–∞–∑—Ä—è–¥–∞ –≤ —Ñ–∞–∫—Ç–æ—Ä,
#         —Ç.–µ. —É—Ä–æ–≤–Ω–∏ "0" –∏ "1" –±—É–¥—É—Ç –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã –≤ –≤–∏–¥–µ —á–∏—Å–µ–ª (1 –∏ 2).
x1$married <- factor(x1$married)
#    1.4) –ü–æ—Å–º–æ—Ç—Ä–∏–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã —Å —Ñ–∞–∫—Ç–æ—Ä–∞–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –µ—ë:
str(x1)
#         –°–≤–æ–¥–∫–∞ –ø–æ —Ç–∞–±–ª–∏—Ü–µ:
summary(x1)
x1 <- na.omit(x1); summary(x1)
x1.tbl <- table(x1); x1.tbl
x1.tbl <- t(x1.tbl); x1.tbl
# -/–û–ë–©–ê–Ø –¢–ï–û–†–ò–Ø/-
# ----------------
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é, —Ç.–µ. –≤—ã—è–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –Ω–∏—Ö ‚Äî –ø—Ä–∏—á–∏–Ω–∞,
# –∞ –∫–∞–∫–∞—è ‚Äî —Å–ª–µ–¥—Å—Ç–≤–∏–µ, —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ.
#
# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –ª–∏—à—å —Å–∞–º–æ –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏,
# –æ–ø–∏—Å–∞—Ç—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.
# –ù–∞ –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, —á—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è —Å–≤—è–∑—å ‚Äî —ç—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–ª–∏—è–Ω–∏–µ, —Ç.–µ. –º–µ–∂–¥—É
# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –æ—Ç–≤–µ—á–∞–µ—Ç ¬´–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞¬ª
OR.Q <- function(x, transposition = FALSE) {
# -/–ò–ù–°–¢–†–£–ö–¶–ò–Ø/-
# x - –ª–∏–±–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ã—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π —Å 2 –∫–æ–ª–æ–Ω–∫–∞–º–∏. –ª–∏–±–æ —Å—Ä–∞–∑—É —Ç–∞–±–ª–∏—Ü–µ–π —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏.
# transposition - –Ω—É–∂–Ω–æ –ª–∏ —Ç—Ä–∞—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –≤–ª–∏—è–µ—Ç!)
# 1) –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç NA):
if (((is.data.frame(x)) | (is.numeric(x))) & !is.table(x)) {
x <- na.omit(x)
#    -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#    –§—É–Ω–∫—Ü–∏—è "na.omit(x)" –≤—ã–¥–∞—ë—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç x, —Ü–µ–ª–∏–∫–æ–º –æ–ø—É—Å–∫–∞—è (omit)
#    —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ —Ö–æ—Ç—è –±—ã –ø–æ –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
# 2) –¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏:
#    2.1) –°–æ—Å—Ç–∞–≤–∏–º —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º:
x <- table(x)}
#                                               |   –í –¥–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏ –¥–≤–µ –ì–†–ê–î–ê–¶–ò–ò:
#         -/–ü–†–ò–ú–ï–†/-:                           |     ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (pet) –ø–æ —Å—Ç—Ä–æ–∫–∞–º - "–∫–æ—à–∫–∏" –∏ "—Å–æ–±–∞–∫–∏"
#                              married          |     ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (married) –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º  - "–æ–¥–∏–Ω–æ–∫–∏–π" –∏ "–≤ –±—Ä–∞–∫–µ"
#                                               |   –ü–æ —Å—Ç–æ–ª–±—Ü–∞–º; —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ–±–æ–∑–Ω–∞—á–∏–ª–∏ –±—É–∫–≤–∞–º–∏ a, b, c, d.
#                      | –æ–¥–∏–Ω–æ–∫–∏–π | –≤ –±—Ä–∞–∫–µ |   |
#               ------------------------------  |   –¢.–µ. —Ç–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ë–ò–ù–ê–†–ù–´–ú–ò.
#               –∫–æ—à–∫–∏  |    a     |    b    |   |   –í —Å–ª—É—á–∞–µ –¥–≤—É—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏
#         pet   ------------------------------  |   –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ç—ã—Ä–µ —è—á–µ–π–∫–∏, –∏–ª–∏ –ø–æ–ª—è.
#               —Å–æ–±–∞–∫–∏ |    c     |    d    |   |
#                                               |   –ï—ë —Ç–∞–∫ –∏ –Ω–∞–∑—ã–≤–∞—é—Ç ‚Äî —á–µ—Ç—ã—Ä—ë—Ö–ø–æ–ª—å–Ω–æ–π (fourfold),
#                                               |   –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–µ–π 2 √ó 2 (two by two table).
#
#         –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ t() –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏.
if(transposition == TRUE) {
x <- t(x); cat("–¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ (—Ç): \n"); cat("-------------------------------------------------------"); cat("\n"); print(x); cat("-------------------------------------------------------" ,"\n"); cat("\n\n")
} else {   cat("–¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏:\n");      cat("-------------------------------------------------------"); cat("\n"); print(x); cat("-------------------------------------------------------" ,"\n"); cat("\n\n")}
#  3) –ù–∞–π–¥–µ–º:
#    ‚Ä¢ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ OR;
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q –Æ–ª–∞ (–º–æ–¥—É–ª—å).
#
#    3.1) –û—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ OR:
#
#         –ï—Å–ª–∏ –æ–±–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ë–ò–ù–ê–†–ù–´, –º–µ—Ä—É –∏—Ö —Å–≤—è–∑–∏ –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å,
#         —Å–æ–æ—Ç–Ω–µ—Å—è —à–∞–Ω—Å—ã –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å –∏–∑ –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø—Ä–∏
#         —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –≤—Ç–æ—Ä–æ–≥–æ.
#
#         –ü—Ä–∏–º–µ—Ä –ø–æ–∏—Å–∫–∞ OR:
#                                               |                    | –¢–∞–∫, –º—ã –º–æ–∂–µ–º —Å—Ä–∞–≤–Ω–∏—Ç—å —à–∞–Ω—Å—ã:
#                              married          |                    |  ‚Ä¢ a/c - —É–≤–∏–¥–µ—Ç—å –∫–æ–≥–æ-—Ç–æ c –ø–∏—Ç–æ–º—Ü–µ–º –∫–æ—à–∫–æ–π, –Ω–∞–±–ª—é–¥–∞—è —Ç–æ–ª—å–∫–æ –∑–∞ –æ–¥–∏–Ω–æ–∫–∏–º–∏,
##                                              | –§–æ—Ä–º—É–ª–∞ —à–∞–Ω—Å–æ–≤ OR: |  ‚Ä¢ b/d ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞ —Ç–µ—Ö, –∫—Ç–æ –≤ –±—Ä–∞–∫–µ.
#                      | –æ–¥–∏–Ω–æ–∫–∏–π | –≤ –±—Ä–∞–∫–µ |   |                    |
#               ------------------------------  |      a/c   a*d     |
#               –∫–æ—à–∫–∏  |    a     |    b    |   | OR = ‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî     | –°—Ä–∞–≤–Ω–∏—Ç—å —à–∞–Ω—Å—ã –º–æ–∂–Ω–æ, –≤—ã—á–∏—Å–ª–∏–≤ –∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–µ ‚Äî –º—ã –ø–æ–ª—É—á–∏–º –º–µ—Ä—É —Å–≤—è–∑–∏,
#         pet   ------------------------------  |      b/d   b*c     | –∫–æ—Ç–æ—Ä–∞—è —Ç–∞–∫ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è: –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ (Odds Ratio, OR)
#               —Å–æ–±–∞–∫–∏ |    c     |    d    |   |                    | –í –ø–æ—Å–ª–µ–¥–Ω–µ–º –≤–∏–¥–µ –ø—Ä–æ—è—Å–Ω—è–µ—Ç—Å—è —Å–º—ã—Å–ª –æ—Ç–Ω–æ—à–µ–Ω–∏—è —à–∞–Ω—Å–æ–≤ (ad/bc).
#                                               |                    |
#
#        ad –∏ bc ‚Äî —ç—Ç–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—ã 2 √ó 2, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã
#        –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, —Ç–∞–∫:
#                                        ‚Ä¢ a ‚Äî "–æ–¥–∏–Ω–æ—á–∫–∏" —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏ –∫–æ—à–∫–∞–º–∏;
#                                        ‚Ä¢ d ‚Äî "–≤ –±—Ä–∞–∫–µ"  —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏ —Å–æ–±–∞–∫–∞–º–∏.
#
#        –ï—Å–ª–∏ –≤—Å–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞—é—Ç –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å ad, —Ç–æ —ç—Ç–æ –ø–æ–ª–Ω–∞—è,
#        –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å: —É "–æ–¥–∏–Ω–æ—á–µ–∫" –ø–∏—Ç–æ–º—Ü—ã –≤—Å–µ–≥–¥–∞ —è–≤–ª—è—é—Ç—Å—è –∫–æ—à–∫–∞–º–∏.
#
#        –î–∏–∞–≥–æ–Ω–∞–ª—å bc –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å: –ø–∏—Ç–æ–º—Ü—ã —è–≤–ª—è—é—Ç—Å—è –∫–æ—à–∫–∞–º–∏ –≤—Å–µ–≥–¥–∞ —É —Ç–µ—Ö, –∫—Ç–æ "–≤ –±—Ä–∞–∫–µ".
a <- x[1,1];  b <- x[1,2]
c <- x[2,1];  d <- x[2,2]
cat ("–¢–µ–Ω–¥–µ–Ω—Ü–∏–∏:", "\n")
cat("-------------------------------------------------------" ,"\n")
cat( "‚Ä¢ –¥–∏–∞–≥–æ–Ω–∞–ª—å ad - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è:",
"(", as.character((as.data.frame(x))[[1]])[1], "/", as.character((as.data.frame(x))[[2]])[1],"=", a, ")",
"–∏",
"(", as.character((as.data.frame(x))[[1]])[4], "/", as.character((as.data.frame(x))[[2]])[4],"=", d, ")")
cat("\n")
cat( "‚Ä¢ –¥–∏–∞–≥–æ–Ω–∞–ª—å bc - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è:",
"(", as.character((as.data.frame(x))[[1]])[3], "/", as.character((as.data.frame(x))[[2]])[3],"=", b, ")",
"–∏",
"(", as.character((as.data.frame(x))[[1]])[2], "/", as.character((as.data.frame(x))[[2]])[2],"=", c, ")")
cat("\n")
cat("-------------------------------------------------------" ,"\n")
cat("\n\n")
# –û—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ OR:
OR <- (a/c)/(b/d)
#    3.2) –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q –Æ–ª–∞ (–º–æ–¥—É–ª—å):
#
#                                 |  –û—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ —Ö–æ—Ä–æ—à–æ —Å–≤–æ–π –ø—Ä–æ—Å—Ç–æ—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω–æ—Å—Ç—å—é, –Ω–æ –∏–º–µ–µ—Ç –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏.
#         –§–æ—Ä–º—É–ª–∞:                |  –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏. –ö–æ–≥–¥–∞ —Å–≤—è–∑–∏ –Ω–µ—Ç, —Ç.–µ. –æ–Ω–∞ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é, OR = 1. –ö—Ä–æ–º–µ
##                                |  —Ç–æ–≥–æ, OR –Ω–µ—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ: –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É –æ–Ω–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤
#             OR - 1   ad - bc    |  –ø—Ä–µ–¥–µ–ª–µ –¥–æ –Ω—É–ª—è, –∞ –≤ –±–æ–ª—å—à—É—é ‚Äî –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏. –≠—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
#         Q = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî    |  —É—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–æ–∫—É—Å–æ–º: –¥–µ–ª–∏–º OR –Ω–∞ —Å–∞–º–æ
#             OR + 1   ad + bc    |  —Å–µ–±—è, –ø—Ä–∏ —ç—Ç–æ–º –∏–∑ —á–∏—Å–ª–∏—Ç–µ–ª—è –≤—ã—á–∏—Ç–∞–µ–º –µ–¥–∏–Ω–∏—Ü—É, –∞ –∫ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—é ‚Äî
##                                |  –Ω–∞–æ–±–æ—Ä–æ—Ç, –ø—Ä–∏–±–∞–≤–ª—è–µ–º.
#
#         ad - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è, —á—Ç–æ —Ç–µ, –∫—Ç–æ –æ–¥–∏–Ω–æ–∫–∏ —Å –ø–∏—Ç–æ–º—Ü–µ–º –∫–æ—à–∫–æ–π –∏ —Ç–µ, –∫—Ç–æ –≤ –±—Ä–∞–∫–µ —Å –ø–∏—Ç–æ–º—Ü–µ–º —Å–æ–±–∞–∫–æ–π
#         bc - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è, —á—Ç–æ —Ç–µ, –∫—Ç–æ –≤ –±—Ä–∞–∫–µ —Å –ø–∏—Ç–æ–º—Ü–µ–º –∫–æ—à–∫–æ–π –∏ —Ç–µ, –∫—Ç–æ –æ–¥–∏–Ω–æ–∫–∏ —Å –ø–∏—Ç–æ–º—Ü–µ–º —Å–æ–±–∞–∫–æ–π
#
#         –ï—Å–ª–∏ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã, —Ç–æ –ø–æ–ª—É—á–∞–µ–º 0, –µ—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç, —Ç–æ –ø–æ–ª—É—á–∞–µ–º 1 –∏–ª–∏ -1.
#
#         –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q:
Q <- (OR-1)/(OR+1)
if (Q > 0) {trend <- "—Ç–µ–Ω–¥–µ–Ω—Ü–∏—è ¬´ad¬ª –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–µ–π ¬´bc¬ª"}
if (Q < 0) {trend <- "—Ç–µ–Ω–¥–µ–Ω—Ü–∏—è ¬´bc¬ª –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–µ–π ¬´ad¬ª"}
# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:
#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è
#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).
if  (abs(Q) <  0.10)                    {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
if ((abs(Q) >= 0.10) & (abs(Q) < 0.30)) {power.com <- "—Å–ª–∞–±–∞—è"     }
if ((abs(Q) >= 0.30) & (abs(Q) < 0.50)) {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
if  (abs(Q) >= 0.50)                    {power.com <- "—Ç–µ—Å–Ω–∞—è"     }
cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
'–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":","\n")
cat("-------------------------------------------------------"   ,"\n")
cat("‚Ä¢ OR - –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤: ", OR                             ,"\n")
cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q –Æ–ª–∞:     ", Q                              ,"\n")
cat("-------------------------------------------------------"   ,"\n")
cat("‚Ä¢ –í—ã–≤–æ–¥: 1) –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0;0m', "—Å–≤—è–∑—å",
'\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
"—Å",
'\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m')
cat("\n")
cat("         2)", trend)
cat("\n")
cat("-------------------------------------------------------" ,"\n")
}
Cramer.V <- function(x){
# 1) –ù–∞–π–¥–µ–º:
#    ‚Ä¢ [–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏] –æ–∂–∏–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã;
#    ‚Ä¢ œá2 –ü–∏—Ä—Å–æ–Ω–∞;
#    ‚Ä¢ V  –ö—Ä–∞–º–µ—Ä–∞.
#    1.1) [–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏] –æ–∂–∏–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–∏ –ù–ï–ó–ê–í–ò–°–ò–ú–´–• –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
#         1.1.1) –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç NA):
if (((is.data.frame(x)) | (is.numeric(x))) & !is.table(x)) {
x <- na.omit(x)
#         1.1.1) –°–æ—Å—Ç–∞–≤–∏–º —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏:
x <- table(x)}
cat("–¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏:"); cat("\n")
cat("-------------------------------------------------------"); cat("\n")
print(x)
cat("-------------------------------------------------------"); cat("\n"); cat("\n")
#         1.1.2) –ü–µ—Ä–µ–≤–µ–¥—ë–º –≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã:
relat.x.tbl <- x/sum(x)
#                -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#                –§—É–Ω–∫—Ü–∏—è length() –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç, —Ç.–∫. –ø–æ—Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–±—Ü–æ–≤,
#                –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º nrow() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫.
#                –¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sum() –æ—Ç —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏.
#         1.1.3) –ù–∞—Ö–æ–¥–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≤–µ–∫—Ç–æ—Ä–∞ –ú–ê–†–ì–ò–ù–ê–õ–¨–ù–´–• —á–∞—Å—Ç–æ—Ç):
marg.rows <- vector()                                # —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π –≤–µ–∫—Ç–æ—Ä
marg.rows <- apply(relat.x.tbl, MARGIN = 1, FUN = sum)# —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º
marg.cols <- apply(relat.x.tbl, MARGIN = 2, FUN = sum)# —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
#                -/–ü–û–Ø–°–ù–ï–ù–ò–ï/-:
#                –ß—Ç–æ –º—ã –Ω–∞—à–ª–∏? –ú–ê–†–ì–ò–ù–ê–õ–¨–ù–´–ï –ß–ê–°–¢–û–¢–´ - marg.rows –∏ marg.cols, —Å–ª–æ–≤–æ –ú–ê–†–ì–ò–ù–û - –∑–∞–ø–∏—Å–∫–∏ –Ω–∞ –ø–æ–ª—è—Ö
#                          |   –í–ö–æ–Ω—Ç–∞–∫—Ç–µ  | –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ |   –§–µ–π—Å–±—É–∫    |
#                -----------------------------------------------------------------------
#                mail.ru   |              |               |              |  marg.rows[1]
#                -----------------------------------------------------------------------
#                yandex.ru |              |               |              |  marg.rows[2]
#                -----------------------------------------------------------------------
#                gmail.com |              |               |              |  marg.rows[3]
#                -----------------------------------------------------------------------
#                          | marg.cols[1] |  marg.cols[4] | marg.cols[3] |      1
#         1.1.4) –ü–æ –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω—ã–º —á–∞—Å—Ç–æ—Ç–∞–º –≤—ã—á–∏—Å–ª—è–µ–º –û–¢–ù–û–°–ò–¢–ï–õ–¨–ù–´–ï —á–∞—Å—Ç–æ—Ç—ã –¥–ª—è "–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –ù–ï–ó–ê–í–ò–°–ò–ú–´–• –ü–†–ò–ó–ù–ê–ö–û–í":
#                (—ç—Ç–æ –ø–æ–ø–∞—Ä–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç –æ–¥–Ω–æ–π –∏ –¥—Ä—É–≥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö).
model.prob <- marg.rows %o% marg.cols # (–µ—â–µ –æ–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è - –≤–Ω–µ—à–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤)
#                -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#                –û–ø–µ—Ä–∞—Ü–∏—è " %o% " –ø–æ–ø–∞—Ä–Ω–æ –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞
#                –Ω–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥—Ä—É–≥–æ–≥–æ (—Ç–∞–∫–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º).
#                -/–ü–û–Ø–°–ù–ï–ù–ò–ï/-:
#                –ü—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ:
#                          |          –í–ö–æ–Ω—Ç–∞–∫—Ç–µ          |        –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏        |           –§–µ–π—Å–±—É–∫           |
#                -------------------------------------------------------------------------------------------------------------------
#                mail.ru   | marg.rows[1] * marg.cols[1] | marg.rows[1] * marg.cols[2] | marg.rows[1] * marg.cols[3] |  marg.rows[1]
#                -------------------------------------------------------------------------------------------------------------------
#                yandex.ru | marg.rows[2] * marg.cols[1] | marg.rows[2] * marg.cols[2] | marg.rows[2] * marg.cols[3] |  marg.rows[2]
#                -------------------------------------------------------------------------------------------------------------------
#                gmail.com | marg.rows[3] * marg.cols[1] | marg.rows[3] * marg.cols[2] | marg.rows[3] * marg.cols[3] |  marg.rows[3]
#                -------------------------------------------------------------------------------------------------------------------
#                          |          marg.cols[1]       |          marg.cols[4]       |          marg.cols[3]       |      1
#         1.1.5) –ü–µ—Ä–µ–≤–æ–¥–∏–º –æ–∂–∏–¥–∞–µ–º—ã–µ –û–¢–ù–û–°–ò–¢–ï–õ–¨–ù–´–ï —á–∞—Å—Ç–æ—Ç—ã –≤ –ê–ë–°–û–õ–Æ–¢–ù–´–ï, —É–º–Ω–æ–∂–∞—è model.prob
#                –Ω–∞ –æ–±—ä—ë–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ model.freq
model.freq <- model.prob * sum(x)
cat("[–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ] –æ–∂–∏–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:"); cat("\n")
cat("-------------------------------------------------------"); cat("\n")
print(model.freq)
cat("-------------------------------------------------------"); cat("\n"); cat("\n")
#    1.2) œá2 –ü–∏—Ä—Å–æ–Ω–∞ (–∫–≤–∞–¥—Ä–∞—Ç—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤):
#         –°—Ä–∞–≤–Ω–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ "—ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ" –∏ "—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è [–∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö] —á–∞—Å—Ç–æ—Ç,
#
#         –§–æ—Ä–º—É–ª–∞ œá2 –ü–∏—Ä—Å–æ–Ω–∞:   |
#                               |  –≥–¥–µ:
#              k  (O·µ¢ - E·µ¢)¬≤    |  ‚Ä¢ O·µ¢ - —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏ –Ω–∞–±–ª—é–¥–∞–µ–º–∞—è  (Observed) —á–∞—Å—Ç–æ—Ç–∞;
#         œá2 = Œ£  ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî    |  ‚Ä¢ E·µ¢ - [—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏] –æ–∂–∏–¥–∞–µ–º–∞—è (Expected) —á–∞—Å—Ç–æ—Ç–∞;
#             i=1     E·µ¢        |  ‚Ä¢ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É "Observed" –∏ "Expected" –Ω–∞–∑—ã–≤–∞—é—Ç –æ—Å—Ç–∞—Ç–∫–æ–º (residual).
Pirs.X2 <- sum(((x - model.freq)**2)/model.freq)
#    1.3) V –ö—Ä–∞–º–µ—Ä–∞:
#         –£ œá2 –ü–∏—Ä—Å–æ–Ω–∞ —Ç–∞–∫ –∂–µ, –∫–∞–∫ —É OR, –µ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏: –æ–Ω –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è
#         –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö [0 : –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏], –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä—ë–º–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π
#         –∏ –æ—Ç —á–∏—Å–ª–∞ –≥—Ä–∞–¥–∞—Ü–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
#         –≠—Ç–∏ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞ —É—Å—Ç—Ä–∞–Ω—è—é—Ç, –Ω–æ—Ä–º–∏—Ä—É—è œá2 –Ω–∞ N –∏ –≤–Ω–æ—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏ ‚Äî —Ç–∞–∫
#         –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤—ã–µ –º–µ—Ä—ã —Å–≤—è–∑–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç V –ö—Ä–∞–º–µ—Ä–∞ (Cram√©r‚Äôs V):
#         V –ö—Ä–∞–º–µ—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è:
#          ‚Ä¢ –û–¢ "0" - –ø—Ä–∏ –ø–æ–ª–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏
#          ‚Ä¢ –î–û "1" - –ø—Ä–∏ –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–≤—è–∑–∏.
#         –§–æ—Ä–º—É–ª–∞ V –ö—Ä–∞–º–µ—Ä–∞:
#
#                                         |  –≥–¥–µ:
#                    x¬≤                   |  ‚Ä¢ l ‚Äî –º–µ–Ω—å—à–µ–µ –∏–∑ –ì–†–ê–î–ê–¶–ò–ô (–∫–æ–ª–∏—á–µ—Å—Ç–≤ —Å—Ç—Ä–æ–∫ r –∏ —Å—Ç–æ–ª–±—Ü–æ–≤) c –≤ —Ç–∞–±–ª–∏—Ü–µ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏;
#         Vc = ‚àö(‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî); l = min(r,c)  |  —Ç.–µ. –∏–∑ —Ç–∞–±–ª–∏—Ü—ã 3X2 l=2, —Ç–∞–±–ª–∏—Ü—ã 5X3 l=3 –∏ —Ç.–ø.
#                 N(l-1)                  |
Cram.V <- sqrt(Pirs.X2/(sum(x)*(min(c(nrow(model.freq), (ncol(model.freq))))-1)))
# 2) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:
#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è
#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).
if  (abs(Kram.V) <  0.10)                         {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
if ((abs(Kram.V) >= 0.10) & (abs(Kram.V) < 0.30)) {power.com <- "—Å–ª–∞–±–∞—è"     }
if ((abs(Kram.V) >= 0.30) & (abs(Kram.V) < 0.50)) {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
if  (abs(Kram.V) >= 0.50)                         {power.com <- "—Ç–µ—Å–Ω–∞—è"     }
cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
'–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":"          ,"\n")
cat("-------------------------------------------------------"             ,"\n")
cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œá2 –ü–∏—Ä—Å–æ–Ω–∞:", Pirs.X2                                  ,"\n")
cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç V  –ö—Ä–∞–º–µ—Ä–∞:", Cram.V                                   ,"\n")
cat("-------------------------------------------------------"             ,"\n")
cat("‚Ä¢ –í—ã–≤–æ–¥: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0;0m', "—Å–≤—è–∑—å",
'\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
"—Å",
'\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m');                cat("\n")
cat("-------------------------------------------------------"             ,"\n")
}
Kendall.T <- function(x, full.print=FALSE){
# 2) –ù–∞–π–¥–µ–º —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π Q;
#    2.1) –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–¥—Å—á—ë—Ç–∞ —Å–Ω–∞—á–∞–ª–∞ —É–ø–æ—Ä—è–¥–æ—á–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π,
#         –∏ –¥–∞–ª–µ–µ –±—É–¥–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ç–æ—Ä—É—é
i <- order(x[ , 1]); i# –≤–µ–∫—Ç–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–æ–∫, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–æ 1-–º—É —Å—Ç–æ–ª–±—Ü—É
#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#         ---------------
#         –§—É–Ω–∫—Ü–∏—è "order()" –≤—ã–¥–∞—ë—Ç –Ω–æ–º–µ—Ä–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã experts
#         –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–æ–ª–±—Ü–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ —Ñ–∏–ª—å—Ç—Ä–µ
#         -/–ü–†–ò–ú–ï–† order()/-:
#         -------------------
#         –ö–æ–º–∞–Ω–¥–∞ x[ , 1] –≤—ã–≤–µ–¥–µ—Ç –≤–µ–∫—Ç–æ—Ä tour.1, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –ø–æ—Ä—è–¥–æ–∫, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–π –∏–Ω–¥–µ–∫—Å–∞–º–∏:
#         –∏–Ω–¥–µ–∫—Å : 1 2 3 4 5 6 7 8
#         tour.1 : 7 5 3 4 6 1 2 8
#         –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è x[ , 1] —É—Å–ª–æ–≤–Ω–æ –¥–ª—è —Å–µ–±—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—Å—Ç–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ,
#         —Ç–æ –∏–Ω–¥–µ–∫—Å—ã –±—É–¥—É—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
#         –∏–Ω–¥–µ–∫—Å : 6 7 3 4 2 5 1 8
#         tour.1 : 1 2 3 4 5 6 7 8
#         –ö–æ–º–∞–Ω–¥–∞ order(x[ , 1]) –∫–∞–∫ —Ä–∞–∑ –∏ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã:
#         i <- order(x[ , 1]) - —ç—Ç–æ: 6 7 3 4 2 5 1 8
#    2.2) –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É —Ç–∞–∫, —á—Ç–æ–±—ã –≤–µ–∫—Ç–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ i –∑–∞–¥–∞–ª –Ω–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ x
x <- x[i, ]; x # —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –≤ –Ω–æ–≤–æ–º –ø–æ—Ä—è–¥–∫–µ
#    2.3) –ù–∞–ø–∏—à–µ–º —Ü–∏–∫–ª –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏–Ω–≤–µ—Ä—Å–∏–π:
#         –ü—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –µ—ë –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã
#         —Ç–∞–∫–∂–µ –≤—ã—Å—Ç—Ä–æ–∏—Ç—å—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è, —Ç.–µ. –ø—Ä–∏ –ø–æ–ø–∞—Ä–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫
#         –∑–Ω–∞—á–µ–Ω–∏–µ –í–ï–†–•–ù–ï–ô —Å—Ç—Ä–æ–∫–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ú–ï–ù–¨–®–ò–ú, —á–µ–º –ù–ò–ñ–ù–ò–ï–ô —Å—Ç—Ä–æ–∫–∏.
#         –ï—Å–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, –º–µ–Ω—å—à–∏–º –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∏–∂–Ω–µ–π —Å—Ç—Ä–æ–∫–∏,
#         —Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Äî –∏–Ω–≤–µ—Ä—Å–∏—é.
#         –ö–æ–¥ –Ω–∏–∂–µ –Ω–∞–ø–∏—Å–∏–Ω —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –≤ –∫–æ–Ω—Å–æ–ª–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–≤–æ—é —Ä–∞–±–æ—Ç—É:
if (full.print==TRUE){
cat("–¢–∞–±–ª–∏—Ü–∞ x: ", "\n\n"); t(x)
Q <- numeric(1); P <- numeric(1)
for (i in 1:(nrow(x) - 1)) {
cat('\033[1m', i, "—Ü–∏–∫–ª:", '\033[0;0m', "\n");                                         cat("--------------------------------------------","\n")
#         —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
x.i  <- x[i:nrow(x), 2];                              cat("–∑–Ω–∞—á–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:", x.i,  "\n");                                        cat("--------------------------------------------","\n")
#         –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –º–µ–Ω—å—à–∏–µ –∏ –±–æ–ª—å—à–µ –ø–µ—Ä–≤–æ–≥–æ
inversionsQ   <- x.i[x.i < x.i[1]];                   cat("inversions   Q            :","–º–µ–Ω—å—à–µ", x.i[1], "—Ç–æ–ª—å–∫–æ:", inversionsQ   ,"\n");  cat("--------------------------------------------","\n")
coincidencesP <- x.i[x.i > x.i[1]];                   cat("coincidences P            :","–±–æ–ª—å—à–µ", x.i[1], "—Ç–æ–ª—å–∫–æ:", coincidencesP ,"\n");  cat("--------------------------------------------","\n")
#         –æ–±—ä—ë–º —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —Ç.–µ. —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π
Q1 <- Q + length(inversionsQ);                        cat("—á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π   Q        :", Q1, "(",Q,"+",length(inversionsQ)  ,")","\n");     cat("--------------------------------------------","\n");
P1 <- P + length(coincidencesP);                      cat("—á–∏—Å–ª–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π P        :", P1, "(",P,"+",length(coincidencesP),")","\n");     cat("--------------------------------------------","\n"); cat("\n");
Q <- Q1; P<-P1
}
}else{
Q <- numeric(1)
for (i in 1:(nrow(x) - 1)) {
x.i  <- x[i:nrow(x), 2]           # —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
inversions <- x.i[x.i < x.i[1]]   # –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –º–µ–Ω—å—à–∏–µ –ø–µ—Ä–≤–æ–≥–æ
Q <- Q + length(inversions)       # –æ–±—ä—ë–º —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —Ç.–µ. —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π
}
}
# 3) –ù–∞–π–¥–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#    –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ö–µ–Ω–¥–∞–ª–ª–∞ Íöå (—Ç–∞—É –ö–µ–Ω–¥–∞–ª–ª–∞, Kendall‚Äôs tau)
#    ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–∞—Ä–∞—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π,
#    –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –æ–±—â–µ–µ —á–∏—Å–ª–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä:
#
#    –§–æ—Ä–º—É–ª–∞ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#        P - Q    |    –≥–¥–µ:
#   ùõï = ‚Äî‚Äî‚Äî‚Äî‚Äî    |    ‚Ä¢ P ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç –æ–¥–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∫ –¥—Ä—É–≥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–µ–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å—Ç–æ—Ä–æ–Ω—É;
#        P + Q    |    ‚Ä¢ Q ‚Äî –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏–ª–∏ –∏–Ω–≤–µ—Ä—Å–∏–∏.
#
#
#    –§–æ—Ä–º—É–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö  | –§–æ—Ä–º—É–ª–∞ (P) –≤—ã–≤–µ–¥–µ–Ω–∞ –∏–∑:
#    –∏–∑–º–µ–Ω–µ–Ω–∏–π P:           |
#                           |
#        N*(N-1)            |           N*(N-1)
#    P = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî - Q        |   P + Q = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
#           2               |              2
P <- (nrow(x)*(nrow(x)-1))/2 - Q
T.Kendall <- (P-Q)/(P+Q)
#    Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ —Ç–∞–∫–∂–µ –º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö  [‚Äì1 : 1] –∏ —Ä–∞–≤–µ–Ω 0 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
#    –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Q –Æ–ª–∞, –∑–Ω–∞–∫ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é: –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï —Å–≤—è–∑–∏.
#    –¢–∞–∫,
#         ‚Ä¢ (+) –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä—è–º–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:     –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–π –¥—Ä—É–≥–∞—è —Ç–∞–∫–∂–µ —Ä–∞—Å—Ç—ë—Ç;
#         ‚Ä¢ (-) –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: —Ä–æ—Å—Ç—É –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –¥—Ä—É–≥–æ–π.
# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:
#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è
#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).
if  (abs(T.Kendall) <  0.10)                            {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
if ((abs(T.Kendall) >= 0.10) & (abs(T.Kendall) < 0.30)) {power.com <- "—Å–ª–∞–±–∞—è"     }
if ((abs(T.Kendall) >= 0.30) & (abs(T.Kendall) < 0.50)) {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
if  (abs(T.Kendall) >= 0.50)                            {power.com <- "—Ç–µ—Å–Ω–∞—è"     }
# –Ω–∞–±–ª—é–¥–µ–Ω–∏—è - —Ç–æ —á—Ç–æ –ø–æ —Å—Ç—Ä–æ–∫–∞–º, –ø—Ä–∏–º:   index tour.1 tour.2
#                                           3     3      3
# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - —Å—Ç–æ–ª–±—Ü—ã.
cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
'–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":"                            ,"\n")
cat("-------------------------------------------------------------"                         ,"\n")
cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Íöå –ö–µ–Ω–¥–∞–ª–ª–∞:", T.Kendall                    ,"\n")
cat("‚Ä¢ Q - —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π    :", Q                            ,"\n")
cat("‚Ä¢ P - —á–∏—Å–ª–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π  :", P                            ,"\n")
cat("-------------------------------------------------------------"                         ,"\n")
if (T.Kendall>0){
cat("‚Ä¢ –í—ã–≤–æ–¥: 1) Íöå –ö–µ–Ω–¥–∞–ª–ª–∞", '\033[1m',  "–ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω,",'\033[0;0m', "–∑–Ω–∞—á–∏—Ç, —Å–≤—è–∑—å –º–µ–∂–¥—É", "\n")
cat("            –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è)", '\033[1m',  "–ø—Ä—è–º–∞—è,",'\033[0;0m',"—Ç.–µ. –≤ ",     "\n")
cat("            –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö —á–∞—â–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, —á–µ–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è\n")}
if (T.Kendall<0){
cat("‚Ä¢ –í—ã–≤–æ–¥: 1) Íöå –ö–µ–Ω–¥–∞–ª–ª–∞", '\033[1m',  "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω,",'\033[0;0m', "–∑–Ω–∞—á–∏—Ç, —Å–≤—è–∑—å –º–µ–∂–¥—É", "\n")
cat("            –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è)", '\033[1m',  "–æ–±—Ä–∞—Ç–Ω–∞—è",'\033[0;0m',"—Ç.–µ. –≤ ",    "\n")
cat("            –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö —á–∞—â–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è, —á–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è\n")}
cat("\n")
cat("         2)",paste0("Íöå –ö–µ–Ω–¥–∞–ª–ª–∞ = ", round(T.Kendall, 7), ", –∑–Ω–∞—á–∏—Ç, —á—Ç–æ, –±–µ—Ä—è –Ω–∞—É–≥–∞–¥"),"\n")
cat("            –¥–≤–µ –ø–∞—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, –º—ã –æ–±–Ω–∞—Ä—É–∂–∏–º –≤ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö: \n")
cat("            ‚Ä¢ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ  –≤", paste0(round((0.5+(T.Kendall/2))*100,1), "%"), "—Å–ª—É—á–∞–µ–≤,   \n")
cat("            ‚Ä¢ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –≤", paste0(round((0.5-(T.Kendall/2))*100,1), "%"), "—Å–ª—É—á–∞–µ–≤.   \n")
cat("\n")
cat("         3) –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0;0m', "—Å–≤—è–∑—å",
'\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
"—Å",
'\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m');          cat("\n")
cat("-------------------------------------------------------------" ,"\n")
# a.	–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –ª–∏—à—å —Å–∞–º–æ –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏, –æ–ø–∏—Å–∞—Ç—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –¢.–µ. Q–Æ–ª–∞>0.10 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏—à—å —Ç–æ, —á—Ç–æ –µ—Å—Ç—å —Å–ª–∞–±–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
# b.	–ê –≤–æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–Ω–≥–æ–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
}
# –í–æ–ø—Ä–æ—Å 5: –í–æ—Å–µ–º—å –∫–æ–º–∞–Ω–¥ —É—á–∞—Å—Ç–≤–æ–≤–∞–ª–∏ –≤ –¥–≤—É—Ö —Ç—É—Ä–∞—Ö —Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–π;
#           –¥–∞–Ω–Ω—ã–µ –æ –∑–∞–Ω—è—Ç—ã—Ö –∏–º–∏ –º–µ—Å—Ç–∞—Ö –≤ –∫–∞–∂–¥–æ–º —Ç—É—Ä–µ –∑–∞–ø–∏—Å–∞–Ω—ã –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–∞—Ö:
x5.tour.1 <- read.csv("C:/Users/ak179/OneDrive/–ú–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞/2 –ö–£–†–°/1 –°–ï–ú–ï–°–¢–†/–õ–µ–∫—Ü–∏–∏ (2 –∫—É—Ä—Å)/–Ø–∑—ã–∫ R (—à–ø–æ—Ä—ã –∏ –∑–∞–¥–∞—á–∏)/–°–∫—Ä–∏–ø—Ç—ã/–ó–∞–¥–∞–Ω–∏–µ 8/5_6.tour.1.dat")
x5.tour.2 <- read.csv("C:/Users/ak179/OneDrive/–ú–∞–≥–∏—Å—Ç—Ä–∞—Ç—É—Ä–∞/2 –ö–£–†–°/1 –°–ï–ú–ï–°–¢–†/–õ–µ–∫—Ü–∏–∏ (2 –∫—É—Ä—Å)/–Ø–∑—ã–∫ R (—à–ø–æ—Ä—ã –∏ –∑–∞–¥–∞—á–∏)/–°–∫—Ä–∏–ø—Ç—ã/–ó–∞–¥–∞–Ω–∏–µ 8/5_6.tour.2.dat")
# –ó–∞–¥–∞—á–∞:
# ‚Ä¢ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Å—Ö–æ–∂–∏–º–∏ –æ–∫–∞–∑–∞–ª–∏—Å—å –ø–æ–∑–∏—Ü–∏–∏ –∫–æ–º–∞–Ω–¥ –≤ –¥–≤—É—Ö —Ç—É—Ä–∞—Ö, –Ω–∞–π–¥—è œÑ –ö–µ–Ω–¥–∞–ª–ª–∞;
# ‚Ä¢ –í–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π Q.
# –†–µ—à–µ–Ω–∏–µ:
# 1)  –°–æ—Å—Ç–∞–≤–∏–º –∏–∑ –¥–≤—É—Ö –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–∞–±–ª–∏—Ü –æ–¥–Ω—É –æ–±—â—É—é:
x5.tour <- cbind(x5.tour.1, x5.tour.2); x5.tour
# 2) –ù–∞–π–¥–µ–º —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π Q;
#    2.1) –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–¥—Å—á—ë—Ç–∞ —Å–Ω–∞—á–∞–ª–∞ —É–ø–æ—Ä—è–¥–æ—á–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π,
#         –∏ –¥–∞–ª–µ–µ –±—É–¥–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ç–æ—Ä—É—é
i <- order(x5.tour[ , 1]); i  # –≤–µ–∫—Ç–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–æ–∫, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–æ 1-–º—É —Å—Ç–æ–ª–±—Ü—É
#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#         ---------------
#         –§—É–Ω–∫—Ü–∏—è "order()" –≤—ã–¥–∞—ë—Ç –Ω–æ–º–µ—Ä–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã experts
#         –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–æ–ª–±—Ü–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ —Ñ–∏–ª—å—Ç—Ä–µ
#         -/–ü–†–ò–ú–ï–† order()/-:
#         -------------------
#         –ö–æ–º–∞–Ω–¥–∞ x5.tour[ , 1] –≤—ã–≤–µ–¥–µ—Ç –≤–µ–∫—Ç–æ—Ä tour.1, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –ø–æ—Ä—è–¥–æ–∫, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–π –∏–Ω–¥–µ–∫—Å–∞–º–∏:
#         –∏–Ω–¥–µ–∫—Å : 1 2 3 4 5 6 7 8
#         tour.1 : 7 5 3 4 6 1 2 8
#         –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è x5.tour[ , 1] —É—Å–ª–æ–≤–Ω–æ –¥–ª—è —Å–µ–±—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—Å—Ç–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ,
#         —Ç–æ –∏–Ω–¥–µ–∫—Å—ã –±—É–¥—É—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
#         –∏–Ω–¥–µ–∫—Å : 6 7 3 4 2 5 1 8
#         tour.1 : 1 2 3 4 5 6 7 8
#         –ö–æ–º–∞–Ω–¥–∞ order(x5.tour[ , 1]) –∫–∞–∫ —Ä–∞–∑ –∏ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã:
#         i <- order(x5.tour[ , 1]) - —ç—Ç–æ: 6 7 3 4 2 5 1 8
#    2.2) –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É —Ç–∞–∫, —á—Ç–æ–±—ã –≤–µ–∫—Ç–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ i –∑–∞–¥–∞–ª –Ω–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ x5.tour
x5.tour <- x5.tour[i, ]; x5.tour  # —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –≤ –Ω–æ–≤–æ–º –ø–æ—Ä—è–¥–∫–µ
#    2.3) –ù–∞–ø–∏—à–µ–º —Ü–∏–∫–ª –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏–Ω–≤–µ—Ä—Å–∏–π:
#         –ü—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Ç—É—Ä–æ–≤ –µ—ë –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã
#         —Ç–∞–∫–∂–µ –≤—ã—Å—Ç—Ä–æ–∏—Ç—å—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è, —Ç.–µ. –ø—Ä–∏ –ø–æ–ø–∞—Ä–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫
#         –∑–Ω–∞—á–µ–Ω–∏–µ –í–ï–†–•–ù–ï–ô —Å—Ç—Ä–æ–∫–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ú–ï–ù–¨–®–ò–ú, —á–µ–º –ù–ò–ñ–ù–ò–ï–ô —Å—Ç—Ä–æ–∫–∏.
#         –ï—Å–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, –º–µ–Ω—å—à–∏–º –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∏–∂–Ω–µ–π —Å—Ç—Ä–æ–∫–∏,
#         —Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Äî –∏–Ω–≤–µ—Ä—Å–∏—é.
#         –ö–æ–¥ –Ω–∏–∂–µ –Ω–∞–ø–∏—Å–∏–Ω —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –≤ –∫–æ–Ω—Å–æ–ª–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–≤–æ—é —Ä–∞–±–æ—Ç—É:
cat("–¢–∞–±–ª–∏—Ü–∞ x5.tour: ", "\n\n"); t(x5.tour)
Q <- numeric(1)
for (i in 1:nrow(x5.tour) - 1) {
cat('\033[1m', i+1, "—Ü–∏–∫–ª:", '\033[0;0m', "\n");                            cat("------------------------------------------","\n")
# —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä
x5.tour.i  <- x5.tour[i:nrow(x5.tour), 2];               cat("x5.tour.i  : ", x5.tour.i,  "\n");                                     cat("------------------------------------------","\n")
# –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –º–µ–Ω—å—à–∏–µ –ø–µ—Ä–≤–æ–≥–æ
inversions <- x5.tour.i[x5.tour.i < x5.tour.i[1]];       cat("inversions : ","–º–µ–Ω—å—à–µ", x5.tour.i[1], "—Ç–æ–ª—å–∫–æ:", inversions  ,"\n");  cat("------------------------------------------","\n")
# –æ–±—ä—ë–º —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —Ç.–µ. —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π
Q1          <- Q + length(inversions);                   cat("Q          : ", Q1, "(",Q,"+ length(",inversions,")",")","\n");        cat("------------------------------------------","\n"); cat("\n");
Q <- Q1
};cat("–ß–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π Q: ", Q, "\n\n")
# 3) –ù–∞–π–¥–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#    –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ö–µ–Ω–¥–∞–ª–ª–∞ Íöå (—Ç–∞—É –ö–µ–Ω–¥–∞–ª–ª–∞, Kendall‚Äôs tau)
#    ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–∞—Ä–∞—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π,
#    –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –æ–±—â–µ–µ —á–∏—Å–ª–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä:
#
#    –§–æ—Ä–º—É–ª–∞ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#        P - Q    |    –≥–¥–µ:
#   ùõï = ‚Äî‚Äî‚Äî‚Äî‚Äî    |    ‚Ä¢ P ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç –æ–¥–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∫ –¥—Ä—É–≥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–µ–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å—Ç–æ—Ä–æ–Ω—É;
#        P + Q    |    ‚Ä¢ Q ‚Äî –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏–ª–∏ –∏–Ω–≤–µ—Ä—Å–∏–∏.
#
#
#    –§–æ—Ä–º—É–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö  | –§–æ—Ä–º—É–ª–∞ (P) –≤—ã–≤–µ–¥–µ–Ω–∞ –∏–∑:
#    –∏–∑–º–µ–Ω–µ–Ω–∏–π P:           |
#                           |
#        N*(N-1)            |           N*(N-1)
#    P = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî - Q        |   P + Q = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
#           2               |              2
P <- (nrow(x5.tour)*(nrow(x5.tour)-1))/2 - Q; cat("–ß–∏—Å–ª–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π P: ", P, "\n\n")
T.Kendall <- (P-Q)/(P+Q);                     cat("Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞: ", T.Kendall, "\n\n")
#    Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ —Ç–∞–∫–∂–µ –º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö  [‚Äì1 : 1] –∏ —Ä–∞–≤–µ–Ω 0 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
#    –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Q –Æ–ª–∞, –∑–Ω–∞–∫ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é: –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï —Å–≤—è–∑–∏.
#    –¢–∞–∫,
#         ‚Ä¢ (+) –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä—è–º–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:     –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–π –¥—Ä—É–≥–∞—è —Ç–∞–∫–∂–µ —Ä–∞—Å—Ç—ë—Ç;
#         ‚Ä¢ (-) –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: —Ä–æ—Å—Ç—É –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –¥—Ä—É–≥–æ–π.
# –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞, —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É—è—Å—å —Ç–∞–±–ª–∏—Ü–µ–π –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
# –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#   <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#   ‚â•    0.10	—Å–ª–∞–±–∞—è
#   ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#   ‚â•    0.50	—Ç–µ—Å–Ω–∞—è
# 1)
# Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω, –∑–Ω–∞—á–∏—Ç, —Å–≤—è–∑—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è) –ø—Ä—è–º–∞—è,
# —Ç.–µ.—á–∞—â–µ –ø—Ä–æ–∏—Å—Ö–æ–¥—è—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –≤ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö, —á–µ–º –æ—Ç–ª–∏—á–∏—è.
# Íöå = 0.2142857 –∑–Ω–∞—á–∏—Ç, —á—Ç–æ, –±–µ—Ä—è –Ω–∞—É–≥–∞–¥ –ø–æ–∑–∏—Ü–∏–∏ 2 –∫–æ–º–∞–Ω–¥ –≤ 2 —Ç—É—Ä–∞—Ö (–¥–≤–µ –ø–∞—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π),
# –º—ã –æ–±–Ω–∞—Ä—É–∂–∏–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç—É—Ä–æ–≤ –≤ 60.8% —Å–ª—É—á–∞–µ–≤, –∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ, –∞ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ, –≤ 39.2%.
# 2)
# a.	–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –ª–∏—à—å —Å–∞–º–æ –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏, –æ–ø–∏—Å–∞—Ç—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –¢.–µ. Q–Æ–ª–∞>0.10 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏—à—å —Ç–æ, —á—Ç–æ –µ—Å—Ç—å —Å–ª–∞–±–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
# b.	–ê –≤–æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–Ω–≥–æ–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
x123 <- data.frame(exp.1 = c(1,2,3,4,9,8,7,10,5,6), exp.2 = c(1,4,3,2,9,8,7,10,5,6))
x123
Kendall.T(x123, T)
