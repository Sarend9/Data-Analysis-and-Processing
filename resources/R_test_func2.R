# -/–û–ë–©–ê–Ø –¢–ï–û–†–ò–Ø/-
# ----------------
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é, —Ç.–µ. –≤—ã—è–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –Ω–∏—Ö ‚Äî –ø—Ä–∏—á–∏–Ω–∞, 
# –∞ –∫–∞–∫–∞—è ‚Äî —Å–ª–µ–¥—Å—Ç–≤–∏–µ, —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. 
#
# –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –ª–∏—à—å —Å–∞–º–æ –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏, 
# –æ–ø–∏—Å–∞—Ç—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏.


# –ù–∞ –≤–æ–ø—Ä–æ—Å –æ —Ç–æ–º, –∫–∞–∫ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, —á—Ç–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–∞—è —Å–≤—è–∑—å ‚Äî —ç—Ç–æ –∏–º–µ–Ω–Ω–æ –≤–ª–∏—è–Ω–∏–µ, —Ç.–µ. –º–µ–∂–¥—É
# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –ø—Ä–∏—á–∏–Ω–Ω–æ-—Å–ª–µ–¥—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è, –æ—Ç–≤–µ—á–∞–µ—Ç ¬´–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞¬ª


OR.Q <- function(x, transposition = FALSE) {
  
# -/–ò–ù–°–¢–†–£–ö–¶–ò–Ø/-  
# x - –ª–∏–±–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ–±—ã—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ–π —Å 2 –∫–æ–ª–æ–Ω–∫–∞–º–∏. –ª–∏–±–æ —Å—Ä–∞–∑—É —Ç–∞–±–ª–∏—Ü–µ–π —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏. 
# transposition - –Ω—É–∂–Ω–æ –ª–∏ —Ç—Ä–∞—Å–ø–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –≤–ª–∏—è–µ—Ç!)
  
# 1) –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç NA):  
     if (((is.data.frame(x)) | (is.numeric(x))) & !is.table(x)) {
     x <- na.omit(x)
  
#    -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:   
#    –§—É–Ω–∫—Ü–∏—è "na.omit(x)" –≤—ã–¥–∞—ë—Ç –∏—Å—Ö–æ–¥–Ω—ã–π –æ–±—ä–µ–∫—Ç x, —Ü–µ–ª–∏–∫–æ–º –æ–ø—É—Å–∫–∞—è (omit) 
#    —Å—Ç—Ä–æ–∫–∏ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ —Ö–æ—Ç—è –±—ã –ø–æ –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.
  
# 2) –¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏:
  
#    2.1) –°–æ—Å—Ç–∞–≤–∏–º —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏ –ø–æ –Ω–∞—à–∏–º –¥–∞–Ω–Ω—ã–º:
  x <- table(x)}
#                                               |   –í –¥–∞–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏ –¥–≤–µ –ì–†–ê–î–ê–¶–ò–ò: 
#         -/–ü–†–ò–ú–ï–†/-:                           |     ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (pet) –ø–æ —Å—Ç—Ä–æ–∫–∞–º - "–∫–æ—à–∫–∏" –∏ "—Å–æ–±–∞–∫–∏"
#                              married          |     ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (married) –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º  - "–æ–¥–∏–Ω–æ–∫–∏–π" –∏ "–≤ –±—Ä–∞–∫–µ"
#                                               |   –ü–æ —Å—Ç–æ–ª–±—Ü–∞–º; —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —á–∞—Å—Ç–æ—Ç—ã –æ–±–æ–∑–Ω–∞—á–∏–ª–∏ –±—É–∫–≤–∞–º–∏ a, b, c, d. 
#                      | –æ–¥–∏–Ω–æ–∫–∏–π | –≤ –±—Ä–∞–∫–µ |   |  
#               ------------------------------  |   –¢.–µ. —Ç–∞–∫–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ë–ò–ù–ê–†–ù–´–ú–ò.
#               –∫–æ—à–∫–∏  |    a     |    b    |   |   –í —Å–ª—É—á–∞–µ –¥–≤—É—Ö –±–∏–Ω–∞—Ä–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏
#         pet   ------------------------------  |   –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–µ—Ç—ã—Ä–µ —è—á–µ–π–∫–∏, –∏–ª–∏ –ø–æ–ª—è. 
#               —Å–æ–±–∞–∫–∏ |    c     |    d    |   |         
#                                               |   –ï—ë —Ç–∞–∫ –∏ –Ω–∞–∑—ã–≤–∞—é—Ç ‚Äî —á–µ—Ç—ã—Ä—ë—Ö–ø–æ–ª—å–Ω–æ–π (fourfold),
#                                               |   –∏–ª–∏ —Ç–∞–±–ª–∏—Ü–µ–π 2 √ó 2 (two by two table).
#         
#         –°–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ t() –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏.
          if(transposition == TRUE) {
          x <- t(x); cat("–¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏ (—Ç): \n"); cat("-------------------------------------------------------"); cat("\n"); print(x); cat("-------------------------------------------------------" ,"\n"); cat("\n\n")
          } else {   cat("–¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂–µ–Ω–Ω–æ—Å—Ç–∏:\n");      cat("-------------------------------------------------------"); cat("\n"); print(x); cat("-------------------------------------------------------" ,"\n"); cat("\n\n")}


#  3) –ù–∞–π–¥–µ–º:
#    ‚Ä¢ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ OR;
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q –Æ–ª–∞ (–º–æ–¥—É–ª—å).
#
#    3.1) –û—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ OR:
#         
#         –ï—Å–ª–∏ –æ–±–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ë–ò–ù–ê–†–ù–´, –º–µ—Ä—É –∏—Ö —Å–≤—è–∑–∏ –ª–µ–≥–∫–æ –ø–æ–ª—É—á–∏—Ç—å, 
#         —Å–æ–æ—Ç–Ω–µ—Å—è —à–∞–Ω—Å—ã –∫–∞–∫–æ–≥–æ-–Ω–∏–±—É–¥—å –∏–∑ –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –ø—Ä–∏ 
#         —Ä–∞–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –≤—Ç–æ—Ä–æ–≥–æ. 
#          
#         –ü—Ä–∏–º–µ—Ä –ø–æ–∏—Å–∫–∞ OR:
#                                               |                    | –¢–∞–∫, –º—ã –º–æ–∂–µ–º —Å—Ä–∞–≤–Ω–∏—Ç—å —à–∞–Ω—Å—ã:
#                              married          |                    |  ‚Ä¢ a/c - —É–≤–∏–¥–µ—Ç—å –∫–æ–≥–æ-—Ç–æ c –ø–∏—Ç–æ–º—Ü–µ–º –∫–æ—à–∫–æ–π, –Ω–∞–±–ª—é–¥–∞—è —Ç–æ–ª—å–∫–æ –∑–∞ –æ–¥–∏–Ω–æ–∫–∏–º–∏, 
##                                              | –§–æ—Ä–º—É–ª–∞ —à–∞–Ω—Å–æ–≤ OR: |  ‚Ä¢ b/d ‚Äî —Ç–æ–ª—å–∫–æ –∑–∞ —Ç–µ—Ö, –∫—Ç–æ –≤ –±—Ä–∞–∫–µ.
#                      | –æ–¥–∏–Ω–æ–∫–∏–π | –≤ –±—Ä–∞–∫–µ |   |                    |
#               ------------------------------  |      a/c   a*d     |
#               –∫–æ—à–∫–∏  |    a     |    b    |   | OR = ‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî     | –°—Ä–∞–≤–Ω–∏—Ç—å —à–∞–Ω—Å—ã –º–æ–∂–Ω–æ, –≤—ã—á–∏—Å–ª–∏–≤ –∏—Ö –æ—Ç–Ω–æ—à–µ–Ω–∏–µ ‚Äî –º—ã –ø–æ–ª—É—á–∏–º –º–µ—Ä—É —Å–≤—è–∑–∏, 
#         pet   ------------------------------  |      b/d   b*c     | –∫–æ—Ç–æ—Ä–∞—è —Ç–∞–∫ –∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è: –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ (Odds Ratio, OR) 
#               —Å–æ–±–∞–∫–∏ |    c     |    d    |   |                    | –í –ø–æ—Å–ª–µ–¥–Ω–µ–º –≤–∏–¥–µ –ø—Ä–æ—è—Å–Ω—è–µ—Ç—Å—è —Å–º—ã—Å–ª –æ—Ç–Ω–æ—à–µ–Ω–∏—è —à–∞–Ω—Å–æ–≤ (ad/bc). 
#                                               |                    |
#          
#        ad –∏ bc ‚Äî —ç—Ç–æ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ —Ç–∞–±–ª–∏—Ü—ã 2 √ó 2, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ã 
#        –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, —Ç–∞–∫: 
#                                        ‚Ä¢ a ‚Äî "–æ–¥–∏–Ω–æ—á–∫–∏" —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏ –∫–æ—à–∫–∞–º–∏; 
#                                        ‚Ä¢ d ‚Äî "–≤ –±—Ä–∞–∫–µ"  —Å –ø–∏—Ç–æ–º—Ü–∞–º–∏ —Å–æ–±–∞–∫–∞–º–∏. 
#          
#        –ï—Å–ª–∏ –≤—Å–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ–ø–∞–¥–∞—é—Ç –Ω–∞ –¥–∏–∞–≥–æ–Ω–∞–ª—å ad, —Ç–æ —ç—Ç–æ –ø–æ–ª–Ω–∞—è, 
#        –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–∞—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å: —É "–æ–¥–∏–Ω–æ—á–µ–∫" –ø–∏—Ç–æ–º—Ü—ã –≤—Å–µ–≥–¥–∞ —è–≤–ª—è—é—Ç—Å—è –∫–æ—à–∫–∞–º–∏.
#          
#        –î–∏–∞–≥–æ–Ω–∞–ª—å bc –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –æ–±—Ä–∞—Ç–Ω—É—é –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç—å: –ø–∏—Ç–æ–º—Ü—ã —è–≤–ª—è—é—Ç—Å—è –∫–æ—à–∫–∞–º–∏ –≤—Å–µ–≥–¥–∞ —É —Ç–µ—Ö, –∫—Ç–æ "–≤ –±—Ä–∞–∫–µ".         
         
         a <- x[1,1];  b <- x[1,2]

         c <- x[2,1];  d <- x[2,2]
         
         cat ("–¢–µ–Ω–¥–µ–Ω—Ü–∏–∏:", "\n")
         cat("-------------------------------------------------------" ,"\n")
         cat( "‚Ä¢ –¥–∏–∞–≥–æ–Ω–∞–ª—å ad - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è:", 
         "(", as.character((as.data.frame(x))[[1]])[1], "/", as.character((as.data.frame(x))[[2]])[1],"=", a, ")", 
         "–∏",
         "(", as.character((as.data.frame(x))[[1]])[4], "/", as.character((as.data.frame(x))[[2]])[4],"=", d, ")") 
         cat("\n")    
         cat( "‚Ä¢ –¥–∏–∞–≥–æ–Ω–∞–ª—å bc - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è:", 
         "(", as.character((as.data.frame(x))[[1]])[3], "/", as.character((as.data.frame(x))[[2]])[3],"=", b, ")", 
         "–∏",
         "(", as.character((as.data.frame(x))[[1]])[2], "/", as.character((as.data.frame(x))[[2]])[2],"=", c, ")") 
         cat("\n")    
         cat("-------------------------------------------------------" ,"\n")
         cat("\n\n")    
         
         
     # –û—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ OR:
         OR <- (a/c)/(b/d)
         

#    3.2) –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q –Æ–ª–∞ (–º–æ–¥—É–ª—å):        
#         
#                                 |  –û—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤ —Ö–æ—Ä–æ—à–æ —Å–≤–æ–π –ø—Ä–æ—Å—Ç–æ—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω–æ—Å—Ç—å—é, –Ω–æ –∏–º–µ–µ—Ç –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏.
#         –§–æ—Ä–º—É–ª–∞:                |  –∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏. –ö–æ–≥–¥–∞ —Å–≤—è–∑–∏ –Ω–µ—Ç, —Ç.–µ. –æ–Ω–∞ —Ä–∞–≤–Ω–∞ –Ω—É–ª—é, OR = 1. –ö—Ä–æ–º–µ         
##                                |  —Ç–æ–≥–æ, OR –Ω–µ—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ: –≤ –º–µ–Ω—å—à—É—é —Å—Ç–æ—Ä–æ–Ω—É –æ–Ω–æ –∏–∑–º–µ–Ω—è–µ—Ç—Å—è –≤  
#             OR - 1   ad - bc    |  –ø—Ä–µ–¥–µ–ª–µ –¥–æ –Ω—É–ª—è, –∞ –≤ –±–æ–ª—å—à—É—é ‚Äî –¥–æ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏. –≠—Ç–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏
#         Q = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî    |  —É—Å—Ç—Ä–∞–Ω—è—é—Ç—Å—è –ø—Ä–æ—Å—Ç—ã–º –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Ñ–æ–∫—É—Å–æ–º: –¥–µ–ª–∏–º OR –Ω–∞ —Å–∞–º–æ 
#             OR + 1   ad + bc    |  —Å–µ–±—è, –ø—Ä–∏ —ç—Ç–æ–º –∏–∑ —á–∏—Å–ª–∏—Ç–µ–ª—è –≤—ã—á–∏—Ç–∞–µ–º –µ–¥–∏–Ω–∏—Ü—É, –∞ –∫ –∑–Ω–∞–º–µ–Ω–∞—Ç–µ–ª—é ‚Äî 
##                                |  –Ω–∞–æ–±–æ—Ä–æ—Ç, –ø—Ä–∏–±–∞–≤–ª—è–µ–º.
#         
#         ad - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è, —á—Ç–æ —Ç–µ, –∫—Ç–æ –æ–¥–∏–Ω–æ–∫–∏ —Å –ø–∏—Ç–æ–º—Ü–µ–º –∫–æ—à–∫–æ–π –∏ —Ç–µ, –∫—Ç–æ –≤ –±—Ä–∞–∫–µ —Å –ø–∏—Ç–æ–º—Ü–µ–º —Å–æ–±–∞–∫–æ–π
#         bc - —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è, —á—Ç–æ —Ç–µ, –∫—Ç–æ –≤ –±—Ä–∞–∫–µ —Å –ø–∏—Ç–æ–º—Ü–µ–º –∫–æ—à–∫–æ–π –∏ —Ç–µ, –∫—Ç–æ –æ–¥–∏–Ω–æ–∫–∏ —Å –ø–∏—Ç–æ–º—Ü–µ–º —Å–æ–±–∞–∫–æ–π
#           
#         –ï—Å–ª–∏ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã, —Ç–æ –ø–æ–ª—É—á–∞–µ–º 0, –µ—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç, —Ç–æ –ø–æ–ª—É—á–∞–µ–º 1 –∏–ª–∏ -1.  
#         
#         –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q:         
          Q <- (OR-1)/(OR+1)

          if (Q > 0) {trend <- "—Ç–µ–Ω–¥–µ–Ω—Ü–∏—è ¬´ad¬ª –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–µ–π ¬´bc¬ª"}
          if (Q < 0) {trend <- "—Ç–µ–Ω–¥–µ–Ω—Ü–∏—è ¬´bc¬ª –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç –Ω–∞–¥ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–µ–π ¬´ad¬ª"}
          
# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:

#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è

#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).

     if  (abs(Q) <  0.10)                    {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
     if ((abs(Q) >= 0.10) & (abs(Q) < 0.30)) {power.com <- "—Å–ª–∞–±–∞—è"     }
     if ((abs(Q) >= 0.30) & (abs(Q) < 0.50)) {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
     if  (abs(Q) >= 0.50)                    {power.com <- "—Ç–µ—Å–Ω–∞—è"     }


     cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
         '–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":","\n")
     cat("-------------------------------------------------------"   ,"\n")
     cat("‚Ä¢ OR - –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —à–∞–Ω—Å–æ–≤: ", round(OR, 6)                   ,"\n")
     cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Q –Æ–ª–∞    : ", round(Q, 6)                    ,"\n")
     cat("-------------------------------------------------------"   ,"\n")

     cat("‚Ä¢ –í—ã–≤–æ–¥: 1) –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0;0m', "—Å–≤—è–∑—å", 
                      '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
                      "—Å",
                      '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m')
     cat("\n")      
     cat("         2)", trend)  
     cat("\n")   
     cat("-------------------------------------------------------" ,"\n")
}

Cramer.V <- function(x){
  
# 1) –ù–∞–π–¥–µ–º:
#    ‚Ä¢ [–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏] –æ–∂–∏–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã;
#    ‚Ä¢ œá2 –ü–∏—Ä—Å–æ–Ω–∞;
#    ‚Ä¢ V  –ö—Ä–∞–º–µ—Ä–∞.
  
#    1.1) [–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏] –æ–∂–∏–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–∏ –ù–ï–ó–ê–í–ò–°–ò–ú–´–• –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:
  
#         1.1.1) –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ —Å–ª–µ–¥—É–µ—Ç –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç NA):
                 if (((is.data.frame(x)) | (is.numeric(x))) & !is.table(x)) {
                 x <- na.omit(x)
                 
#         1.1.1) –°–æ—Å—Ç–∞–≤–∏–º —Ç–∞–±–ª–∏—Ü—É —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏:
                 x <- table(x)}
      
                 cat("–¢–∞–±–ª–∏—Ü–∞ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏:"); cat("\n")
                 cat("-------------------------------------------------------"); cat("\n")
                 print(x)
                 cat("-------------------------------------------------------"); cat("\n"); cat("\n")
  

#         1.1.2) –ü–µ—Ä–µ–≤–µ–¥—ë–º –≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–µ —á–∞—Å—Ç–æ—Ç—ã:
                 relat.x.tbl <- x/sum(x)
  
#                -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:    
#                –§—É–Ω–∫—Ü–∏—è length() –Ω–µ –ø–æ–¥–æ–π–¥–µ—Ç, —Ç.–∫. –ø–æ—Å—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ–±—Ü–æ–≤,
#                –ø–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É–µ–º nrow() –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —Å—Ç—Ä–æ–∫.
#                –¢–∞–∫ –∂–µ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sum() –æ—Ç —Ç–∞–±–ª–∏—Ü—ã —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏.
  
  
#         1.1.3) –ù–∞—Ö–æ–¥–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–≤–µ–∫—Ç–æ—Ä–∞ –ú–ê–†–ì–ò–ù–ê–õ–¨–ù–´–• —á–∞—Å—Ç–æ—Ç):
                 marg.rows <- vector()                                # —Å–æ–∑–¥–∞–µ–º –ø—É—Å—Ç–æ–π –≤–µ–∫—Ç–æ—Ä
                 marg.rows <- apply(relat.x.tbl, MARGIN = 1, FUN = sum)# —Å—É–º–º—ã –ø–æ —Å—Ç—Ä–æ–∫–∞–º
                 marg.cols <- apply(relat.x.tbl, MARGIN = 2, FUN = sum)# —Å—É–º–º—ã –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º
  
#                -/–ü–û–Ø–°–ù–ï–ù–ò–ï/-:
#                –ß—Ç–æ –º—ã –Ω–∞—à–ª–∏? –ú–ê–†–ì–ò–ù–ê–õ–¨–ù–´–ï –ß–ê–°–¢–û–¢–´ - marg.rows –∏ marg.cols, —Å–ª–æ–≤–æ –ú–ê–†–ì–ò–ù–û - –∑–∞–ø–∏—Å–∫–∏ –Ω–∞ –ø–æ–ª—è—Ö 
  
#                          |   –í–ö–æ–Ω—Ç–∞–∫—Ç–µ  | –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏ |   –§–µ–π—Å–±—É–∫    |
#                -----------------------------------------------------------------------
#                mail.ru   |              |               |              |  marg.rows[1]
#                -----------------------------------------------------------------------
#                yandex.ru |              |               |              |  marg.rows[2]
#                -----------------------------------------------------------------------
#                gmail.com |              |               |              |  marg.rows[3]
#                -----------------------------------------------------------------------
#                          | marg.cols[1] |  marg.cols[4] | marg.cols[3] |      1
  
  
#         1.1.4) –ü–æ –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω—ã–º —á–∞—Å—Ç–æ—Ç–∞–º –≤—ã—á–∏—Å–ª—è–µ–º –û–¢–ù–û–°–ò–¢–ï–õ–¨–ù–´–ï —á–∞—Å—Ç–æ—Ç—ã –¥–ª—è "–†–ê–°–ü–†–ï–î–ï–õ–ï–ù–ò–Ø –ù–ï–ó–ê–í–ò–°–ò–ú–´–• –ü–†–ò–ó–ù–ê–ö–û–í":
#                (—ç—Ç–æ –ø–æ–ø–∞—Ä–Ω—ã–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω—ã—Ö –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç –æ–¥–Ω–æ–π –∏ –¥—Ä—É–≥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö).
                 model.prob <- marg.rows %o% marg.cols # (–µ—â–µ –æ–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è - –≤–Ω–µ—à–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–µ–∫—Ç–æ—Ä–æ–≤)
                 
#                -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:   
#                –û–ø–µ—Ä–∞—Ü–∏—è " %o% " –ø–æ–ø–∞—Ä–Ω–æ –ø–µ—Ä–µ–º–Ω–æ–∂–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –æ–¥–Ω–æ–≥–æ –≤–µ–∫—Ç–æ—Ä–∞ 
#                –Ω–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥—Ä—É–≥–æ–≥–æ (—Ç–∞–∫–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤–Ω–µ—à–Ω–∏–º).
  
#                -/–ü–û–Ø–°–ù–ï–ù–ò–ï/-:                 
#                –ü—Ä–∏–º–µ—Ä —Ç–æ–≥–æ, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –ø–µ—Ä–µ–º–Ω–æ–∂–µ–Ω–∏–µ: 
  
#                          |          –í–ö–æ–Ω—Ç–∞–∫—Ç–µ          |        –û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏        |           –§–µ–π—Å–±—É–∫           |
#                -------------------------------------------------------------------------------------------------------------------
#                mail.ru   | marg.rows[1] * marg.cols[1] | marg.rows[1] * marg.cols[2] | marg.rows[1] * marg.cols[3] |  marg.rows[1]
#                -------------------------------------------------------------------------------------------------------------------
#                yandex.ru | marg.rows[2] * marg.cols[1] | marg.rows[2] * marg.cols[2] | marg.rows[2] * marg.cols[3] |  marg.rows[2]
#                -------------------------------------------------------------------------------------------------------------------
#                gmail.com | marg.rows[3] * marg.cols[1] | marg.rows[3] * marg.cols[2] | marg.rows[3] * marg.cols[3] |  marg.rows[3]
#                -------------------------------------------------------------------------------------------------------------------
#                          |          marg.cols[1]       |          marg.cols[4]       |          marg.cols[3]       |      1
  
  
#         1.1.5) –ü–µ—Ä–µ–≤–æ–¥–∏–º –æ–∂–∏–¥–∞–µ–º—ã–µ –û–¢–ù–û–°–ò–¢–ï–õ–¨–ù–´–ï —á–∞—Å—Ç–æ—Ç—ã –≤ –ê–ë–°–û–õ–Æ–¢–ù–´–ï, —É–º–Ω–æ–∂–∞—è model.prob 
#                –Ω–∞ –æ–±—ä—ë–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∫ model.freq
                 model.freq <- model.prob * sum(x)

                 cat("[–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ] –æ–∂–∏–¥–∞–µ–º—ã–µ —á–∞—Å—Ç–æ—Ç—ã –¥–ª—è –º–æ–¥–µ–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤:"); cat("\n")
                 cat("-------------------------------------------------------"); cat("\n")
                 print(model.freq)
                 cat("-------------------------------------------------------"); cat("\n"); cat("\n")
                 
  
  
#    1.2) œá2 –ü–∏—Ä—Å–æ–Ω–∞ (–∫–≤–∞–¥—Ä–∞—Ç—ã —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –æ—Å—Ç–∞—Ç–∫–æ–≤):
  
#         –°—Ä–∞–≤–Ω–∏–º –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ "—ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ" –∏ "—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–µ" —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è [–∞–±—Å–æ–ª—é—Ç–Ω—ã—Ö] —á–∞—Å—Ç–æ—Ç,
#    
#         –§–æ—Ä–º—É–ª–∞ œá2 –ü–∏—Ä—Å–æ–Ω–∞:   |            
#                               |  –≥–¥–µ:
#              k  (O·µ¢ - E·µ¢)¬≤    |  ‚Ä¢ O·µ¢ - —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏ –Ω–∞–±–ª—é–¥–∞–µ–º–∞—è  (Observed) —á–∞—Å—Ç–æ—Ç–∞;
#         œá2 = Œ£  ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî    |  ‚Ä¢ E·µ¢ - [—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏] –æ–∂–∏–¥–∞–µ–º–∞—è (Expected) —á–∞—Å—Ç–æ—Ç–∞;
#             i=1     E·µ¢        |  ‚Ä¢ —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É "Observed" –∏ "Expected" –Ω–∞–∑—ã–≤–∞—é—Ç –æ—Å—Ç–∞—Ç–∫–æ–º (residual).
          
          
          Pirs.X2 <- sum(((x - model.freq)**2)/model.freq)
  
  
#    1.3) V –ö—Ä–∞–º–µ—Ä–∞:
  
#         –£ œá2 –ü–∏—Ä—Å–æ–Ω–∞ —Ç–∞–∫ –∂–µ, –∫–∞–∫ —É OR, –µ—Å—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏: –æ–Ω –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω—è—Ç—å—Å—è 
#         –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö [0 : –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ—Å—Ç–∏], –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ–±—ä—ë–º–∞ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π 
#         –∏ –æ—Ç —á–∏—Å–ª–∞ –≥—Ä–∞–¥–∞—Ü–∏–π –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. 
  
#         –≠—Ç–∏ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞ —É—Å—Ç—Ä–∞–Ω—è—é—Ç, –Ω–æ—Ä–º–∏—Ä—É—è œá2 –Ω–∞ N –∏ –≤–Ω–æ—Å—è –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ø–æ–ø—Ä–∞–≤–∫–∏ ‚Äî —Ç–∞–∫ 
#         –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤—ã–µ –º–µ—Ä—ã —Å–≤—è–∑–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç V –ö—Ä–∞–º–µ—Ä–∞ (Cram√©r‚Äôs V):
  
#         V –ö—Ä–∞–º–µ—Ä–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è:
#          ‚Ä¢ –û–¢ "0" - –ø—Ä–∏ –ø–æ–ª–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ 
#          ‚Ä¢ –î–û "1" - –ø—Ä–∏ –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–≤—è–∑–∏.
  
#         –§–æ—Ä–º—É–ª–∞ V –ö—Ä–∞–º–µ—Ä–∞: 
#         
#                                         |  –≥–¥–µ:
#                    x¬≤                   |  ‚Ä¢ l ‚Äî –º–µ–Ω—å—à–µ–µ –∏–∑ –ì–†–ê–î–ê–¶–ò–ô (–∫–æ–ª–∏—á–µ—Å—Ç–≤ —Å—Ç—Ä–æ–∫ r –∏ —Å—Ç–æ–ª–±—Ü–æ–≤) c –≤ —Ç–∞–±–ª–∏—Ü–µ —Å–æ–ø—Ä—è–∂—ë–Ω–Ω–æ—Å—Ç–∏;
#         Vc = ‚àö(‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî); l = min(r,c)  |  —Ç.–µ. –∏–∑ (—Ç–∞–±–ª–∏—Ü—ã 3 X 2) l=2, (—Ç–∞–±–ª–∏—Ü—ã 5 X 3) l=3 –∏ —Ç.–ø.
#                 N(l-1)                  | 
  
          Cram.V <- sqrt(Pirs.X2/(sum(x)*(min(c(nrow(model.freq), (ncol(model.freq))))-1)))

# 2) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:

#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è

#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).

     if  (abs(Cram.V) <  0.10)                         {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
     if ((abs(Cram.V) >= 0.10) & (abs(Cram.V) < 0.30)) {power.com <- "—Å–ª–∞–±–∞—è"     }
     if ((abs(Cram.V) >= 0.30) & (abs(Cram.V) < 0.50)) {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
     if  (abs(Cram.V) >= 0.50)                         {power.com <- "—Ç–µ—Å–Ω–∞—è"     }


     cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
         '–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":"          ,"\n")
     cat("-------------------------------------------------------"             ,"\n")
     cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œá2 –ü–∏—Ä—Å–æ–Ω–∞:", round(Pirs.X2, 6)                        ,"\n")
     cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç V  –ö—Ä–∞–º–µ—Ä–∞:", round(Cram.V , 6)                        ,"\n")
     cat("-------------------------------------------------------"             ,"\n")

     cat("‚Ä¢ –í—ã–≤–æ–¥: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0;0m', "—Å–≤—è–∑—å", 
         '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
         "—Å",
         '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m');                cat("\n")
     cat("-------------------------------------------------------"             ,"\n")
}
  

Kendall.T <- function(x, full.print=FALSE){
  
  # full.print - –ø–µ—á–∞—Ç–∞–µ—Ç –≤—Å–µ –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–æ –ø–æ–¥—Å—á–µ—Ç—É Q
  
# 2) –ù–∞–π–¥–µ–º —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π Q;
  
#    2.1) –î–ª—è —É–¥–æ–±—Å—Ç–≤–∞ –ø–æ–¥—Å—á—ë—Ç–∞ —Å–Ω–∞—á–∞–ª–∞ —É–ø–æ—Ä—è–¥–æ—á–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—é –ø–µ—Ä–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π, 
#         –∏ –¥–∞–ª–µ–µ –±—É–¥–µ–º –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –≤—Ç–æ—Ä—É—é
          i <- order(x[ , 1]); i# –≤–µ–∫—Ç–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ —Å—Ç—Ä–æ–∫, —É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã—Ö –ø–æ 1-–º—É —Å—Ç–æ–ª–±—Ü—É
  
#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#         ---------------
#         –§—É–Ω–∫—Ü–∏—è "order()" –≤—ã–¥–∞—ë—Ç –Ω–æ–º–µ—Ä–∞ –≤—Å–µ—Ö —Å—Ç—Ä–æ–∫ —Ç–∞–±–ª–∏—Ü—ã experts 
#         –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–æ–ª–±—Ü–∞, —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –≤ —Ñ–∏–ª—å—Ç—Ä–µ
  
#         -/–ü–†–ò–ú–ï–† order()/-:
#         -------------------
#         –ö–æ–º–∞–Ω–¥–∞ x[ , 1] –≤—ã–≤–µ–¥–µ—Ç –≤–µ–∫—Ç–æ—Ä tour.1, –Ω–æ —É –Ω–µ–≥–æ –µ—Å—Ç—å –ø–æ—Ä—è–¥–æ–∫, –æ–ø—Ä–µ–¥–µ–ª—è–µ–º—ã–π –∏–Ω–¥–µ–∫—Å–∞–º–∏:  
#         –∏–Ω–¥–µ–∫—Å : 1 2 3 4 5 6 7 8
#         tour.1 : 7 5 3 4 6 1 2 8
  
#         –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è x[ , 1] —É—Å–ª–æ–≤–Ω–æ –¥–ª—è —Å–µ–±—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –≤ –æ—Å—Ç–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ, 
#         —Ç–æ –∏–Ω–¥–µ–∫—Å—ã –±—É–¥—É—Ç —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:
#         –∏–Ω–¥–µ–∫—Å : 6 7 3 4 2 5 1 8
#         tour.1 : 1 2 3 4 5 6 7 8
  
#         –ö–æ–º–∞–Ω–¥–∞ order(x[ , 1]) –∫–∞–∫ —Ä–∞–∑ –∏ –≤—ã–≤–µ–¥–µ—Ç —ç—Ç–∏ –∏–Ω–¥–µ–∫—Å—ã:
#         i <- order(x[ , 1]) - —ç—Ç–æ: 6 7 3 4 2 5 1 8
  
#    2.2) –û—Ç—Å–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–∞–±–ª–∏—Ü—É —Ç–∞–∫, —á—Ç–æ–±—ã –≤–µ–∫—Ç–æ—Ä –Ω–æ–º–µ—Ä–æ–≤ i –∑–∞–¥–∞–ª –Ω–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ —Å–ª–µ–¥–æ–≤–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ x
          x <- x[i, ]; x # —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –≤ –Ω–æ–≤–æ–º –ø–æ—Ä—è–¥–∫–µ
  
#    2.3) –ù–∞–ø–∏—à–µ–º —Ü–∏–∫–ª –¥–ª—è –ø–æ–¥—Å—á–µ—Ç–∞ –∏–Ω–≤–µ—Ä—Å–∏–π:    
  
#         –ü—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ —Å—Ç–æ–ª–±—Ü–æ–≤ –µ—ë –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã 
#         —Ç–∞–∫–∂–µ –≤—ã—Å—Ç—Ä–æ–∏—Ç—å—Å—è –≤ –ø–æ—Ä—è–¥–∫–µ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏—è, —Ç.–µ. –ø—Ä–∏ –ø–æ–ø–∞—Ä–Ω–æ–º —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ —Å—Ç—Ä–æ–∫
#         –∑–Ω–∞—á–µ–Ω–∏–µ –í–ï–†–•–ù–ï–ô —Å—Ç—Ä–æ–∫–∏ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –ú–ï–ù–¨–®–ò–ú, —á–µ–º –ù–ò–ñ–ù–ò–ï–ô —Å—Ç—Ä–æ–∫–∏.
  
#         –ï—Å–ª–∏, –Ω–∞–æ–±–æ—Ä–æ—Ç, –º–µ–Ω—å—à–∏–º –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∏–∂–Ω–µ–π —Å—Ç—Ä–æ–∫–∏, 
#         —Ç–æ –º—ã –ø–æ–ª—É—á–∞–µ–º –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ ‚Äî –∏–Ω–≤–µ—Ä—Å–∏—é.    
  
#         –ö–æ–¥ –Ω–∏–∂–µ –Ω–∞–ø–∏—Å–∏–Ω —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ –≤ –∫–æ–Ω—Å–æ–ª–µ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–≤–æ—é —Ä–∞–±–æ—Ç—É:
  
          if (full.print==TRUE){
                                                                cat("–¢–∞–±–ª–∏—Ü–∞ x: ", "\n\n"); t(x)
          Q <- numeric(1); P <- numeric(1)
         
          for (i in 1:(nrow(x) - 1)) {                           
                                                                cat('\033[1m', i, "—Ü–∏–∫–ª:", '\033[0;0m', "\n");                                         cat("--------------------------------------------","\n")
#         —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä                                                         
          x.i  <- x[i:nrow(x), 2];                              cat("–∑–Ω–∞—á–µ–Ω–∏—è –≤—Ç–æ—Ä–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:", x.i,  "\n");                                        cat("--------------------------------------------","\n")       
      
#         –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –º–µ–Ω—å—à–∏–µ –∏ –±–æ–ª—å—à–µ –ø–µ—Ä–≤–æ–≥–æ                                                          
          inversionsQ   <- x.i[x.i < x.i[1]];                   cat("inversions   Q            :","–º–µ–Ω—å—à–µ", x.i[1], "—Ç–æ–ª—å–∫–æ:", inversionsQ   ,"\n");  cat("--------------------------------------------","\n")     
          coincidencesP <- x.i[x.i > x.i[1]];                   cat("coincidences P            :","–±–æ–ª—å—à–µ", x.i[1], "—Ç–æ–ª—å–∫–æ:", coincidencesP ,"\n");  cat("--------------------------------------------","\n")     
         
#         –æ–±—ä—ë–º —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —Ç.–µ. —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π                                                          
          Q1 <- Q + length(inversionsQ);                        cat("—á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π   Q        :", Q1, "(",Q,"+",length(inversionsQ)  ,")","\n");     cat("--------------------------------------------","\n");
          P1 <- P + length(coincidencesP);                      cat("—á–∏—Å–ª–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π P        :", P1, "(",P,"+",length(coincidencesP),")","\n");     cat("--------------------------------------------","\n"); cat("\n");
          Q <- Q1; P<-P1
          }
         
         }else{
         Q <- numeric(1)                                            
         for (i in 1:(nrow(x) - 1)) {                           
         x.i  <- x[i:nrow(x), 2]           # —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–æ–ª–±–µ—Ü –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –≤–µ–∫—Ç–æ—Ä                
         inversions <- x.i[x.i < x.i[1]]   # –∏–∑–≤–ª–µ–∫–∞–µ–º —Ç–æ–ª—å–∫–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –º–µ–Ω—å—à–∏–µ –ø–µ—Ä–≤–æ–≥–æ                         
         Q <- Q + length(inversions)       # –æ–±—ä—ë–º —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, —Ç.–µ. —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π     
         }
}
  
  
  
# 3) –ù–∞–π–¥–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
# 
#    –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ö–µ–Ω–¥–∞–ª–ª–∞ Íöå (—Ç–∞—É –ö–µ–Ω–¥–∞–ª–ª–∞, Kendall‚Äôs tau) 
#    ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏ –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ø–∞—Ä–∞—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, 
#    –Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ –æ–±—â–µ–µ —á–∏—Å–ª–æ —Ç–∞–∫–∏—Ö –ø–∞—Ä:          
#         
#    –§–æ—Ä–º—É–ª–∞ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞:
#
#        P - Q    |    –≥–¥–µ:      
#   ùõï = ‚Äî‚Äî‚Äî‚Äî‚Äî    |    ‚Ä¢ P ‚Äî —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è: –ø—Ä–∏ –ø–µ—Ä–µ—Ö–æ–¥–µ –æ—Ç –æ–¥–Ω–æ–≥–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∫ –¥—Ä—É–≥–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—è –æ–±–µ–∏—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω—è—é—Ç—Å—è –≤ –æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å—Ç–æ—Ä–æ–Ω—É;
#        P + Q    |    ‚Ä¢ Q ‚Äî –Ω–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∏–ª–∏ –∏–Ω–≤–µ—Ä—Å–∏–∏. 
#
#          
#    –§–æ—Ä–º—É–ª–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö  | –§–æ—Ä–º—É–ª–∞ (P) –≤—ã–≤–µ–¥–µ–Ω–∞ –∏–∑:
#    –∏–∑–º–µ–Ω–µ–Ω–∏–π P:           |
#                           |  
#        N*(N-1)            |           N*(N-1)
#    P = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî - Q        |   P + Q = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî
#           2               |              2
  
  
     P <- (nrow(x)*(nrow(x)-1))/2 - Q
     T.Kendall <- (P-Q)/(P+Q)
  
#    Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ —Ç–∞–∫–∂–µ –º–µ–Ω—è–µ—Ç—Å—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö  [‚Äì1 : 1] –∏ —Ä–∞–≤–µ–Ω 0 –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. 
#    –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç Q –Æ–ª–∞, –∑–Ω–∞–∫ Íöå-–ö–µ–Ω–¥–∞–ª–ª–∞ –∏–º–µ–µ—Ç —á–µ—Ç–∫—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—é: –æ–Ω —É–∫–∞–∑—ã–≤–∞–µ—Ç –ù–ê–ü–†–ê–í–õ–ï–ù–ò–ï —Å–≤—è–∑–∏. 
#    –¢–∞–∫, 
#         ‚Ä¢ (+) –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ø—Ä—è–º–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:     –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –æ–¥–Ω–æ–π –¥—Ä—É–≥–∞—è —Ç–∞–∫–∂–µ —Ä–∞—Å—Ç—ë—Ç; 
#         ‚Ä¢ (-) –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–π –∑–Ω–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –æ–±—Ä–∞—Ç–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ: —Ä–æ—Å—Ç—É –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Å–Ω–∏–∂–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π –¥—Ä—É–≥–æ–π.  
  
  
# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:
  
#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è
  
#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).
  
     if  (abs(T.Kendall) <  0.10)                            {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
     if ((abs(T.Kendall) >= 0.10) & (abs(T.Kendall) < 0.30)) {power.com <- "—Å–ª–∞–±–∞—è"     }
     if ((abs(T.Kendall) >= 0.30) & (abs(T.Kendall) < 0.50)) {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
     if  (abs(T.Kendall) >= 0.50)                            {power.com <- "—Ç–µ—Å–Ω–∞—è"     }
  
  
     # –Ω–∞–±–ª—é–¥–µ–Ω–∏—è - —Ç–æ —á—Ç–æ –ø–æ —Å—Ç—Ä–æ–∫–∞–º, –ø—Ä–∏–º:   index tour.1 tour.2
     #                                           3     3      3
     # –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - —Å—Ç–æ–ª–±—Ü—ã.
  
     cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
         '–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":"                            ,"\n")
     cat("-------------------------------------------------------------"                         ,"\n")
     cat("‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Íöå –ö–µ–Ω–¥–∞–ª–ª–∞:", T.Kendall                    ,"\n")
     cat("‚Ä¢ Q - —á–∏—Å–ª–æ –∏–Ω–≤–µ—Ä—Å–∏–π    :", Q                            ,"\n")
     cat("‚Ä¢ P - —á–∏—Å–ª–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π  :", P                            ,"\n")
     cat("-------------------------------------------------------------"                         ,"\n")
     
     if (T.Kendall>0){
     cat("‚Ä¢ –í—ã–≤–æ–¥: 1) Íöå –ö–µ–Ω–¥–∞–ª–ª–∞", '\033[1m',  "–ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω,",'\033[0;0m', "–∑–Ω–∞—á–∏—Ç, —Å–≤—è–∑—å –º–µ–∂–¥—É", "\n")  
     cat("            –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è)", '\033[1m',  "–ø—Ä—è–º–∞—è,",'\033[0;0m',"—Ç.–µ. –≤ ",     "\n") 
     cat("            –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö —á–∞—â–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, —á–µ–º —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è\n")}
     
     if (T.Kendall<0){
     cat("‚Ä¢ –í—ã–≤–æ–¥: 1) Íöå –ö–µ–Ω–¥–∞–ª–ª–∞", '\033[1m',  "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω,",'\033[0;0m', "–∑–Ω–∞—á–∏—Ç, —Å–≤—è–∑—å –º–µ–∂–¥—É", "\n")   
     cat("            –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ (–∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è)", '\033[1m',  "–æ–±—Ä–∞—Ç–Ω–∞—è",'\033[0;0m',"—Ç.–µ. –≤ ",    "\n")
     cat("            –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö —á–∞—â–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è, —á–µ–º —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è\n")}
     cat("\n")
     cat("         2)",paste0("Íöå –ö–µ–Ω–¥–∞–ª–ª–∞ = ", round(T.Kendall, 7), ", –∑–Ω–∞—á–∏—Ç, —á—Ç–æ, –±–µ—Ä—è –Ω–∞—É–≥–∞–¥"),"\n")
     cat("            –¥–≤–µ –ø–∞—Ä—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π, –º—ã –æ–±–Ω–∞—Ä—É–∂–∏–º –≤ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö: \n")
     cat("            ‚Ä¢ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ  –≤", paste0(round((0.5+(T.Kendall/2))*100,1), "%"), "—Å–ª—É—á–∞–µ–≤,   \n")
     cat("            ‚Ä¢ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –≤", paste0(round((0.5-(T.Kendall/2))*100,1), "%"), "—Å–ª—É—á–∞–µ–≤.   \n")
     cat("\n")
     cat("         3) –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0;0m', "—Å–≤—è–∑—å", 
         '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
         "—Å",
         '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m');          cat("\n")
     cat("-------------------------------------------------------------" ,"\n")

     # a.	–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –ª–∏—à—å —Å–∞–º–æ –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏, –æ–ø–∏—Å–∞—Ç—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –¢.–µ. Q–Æ–ª–∞>0.10 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏—à—å —Ç–æ, —á—Ç–æ –µ—Å—Ç—å —Å–ª–∞–±–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
     # b.	–ê –≤–æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–Ω–≥–æ–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
     
}


Pearson.P <- function(x, transposition = FALSE){
  
  # transposition - –º–µ–Ω—è–µ—Ç —Å—Ç–æ–ª–±—Ü—ã –º–µ—Å—Ç–∞–º–∏
  
  x[[1]]<-as.numeric(x[[1]]); x[[2]]<-as.numeric(x[[2]]);
  
  if (isTRUE(transposition)){a = 2; b = 1} else {a = 1; b = 2}
  
# 1) –ü–æ—Å—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è:
     par(mfrow = c(1,1))
     plot(x,
          main = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è
                  –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö                  ",
          xlab = names(x[a]), 
          ylab = names(x[b]))
       
#    –í–´–ë–†–û–°–´ —Ö–æ—Ä–æ—à–æ –≤–∏–¥–Ω—ã –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –≤ –≤–∏–¥–µ —Ç–æ—á–µ–∫:
#    –∞) –¥–∞–ª–µ–∫–æ –æ—Ç—Å—Ç–æ—è—â–∏—Ö –æ—Ç –æ–±—â–µ–≥–æ –æ–±–ª–∞–∫–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è;
#    –±) –ª–µ–∂–∞—â–∏—Ö —Ç–∞–∫–∂–µ –¥–∞–ª–µ–∫–æ –æ—Ç –ª–∏–Ω–∏–∏ –∏–¥–µ–∞–ª—å–Ω–æ–π –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.
#    
#           –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è      
#           _____________________     
#       260|  *                 *|    
#          | * <-–≤—ã–±—Ä–æ—Å—ã     * * |       
#    A  240|*            *   *   |       
#    n     |            *  *  *  |     
#    x  220|          *  * *     |    
#    i     |     *  *  *  *      |         
#    e  200|      *   *  *       |       
#    t     |   *   *             |     
#    y  180|    * *              |     
#          |  *                  |
#       160|                     |     
#           ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ      
#          70   85   100  115  130  
#
#                  IQ
#     
#    œÅ –ü–∏—Ä—Å–æ–Ω–∞ - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅ –ü–∏—Ä—Å–æ–Ω–∞
#   
#    –ò–¥–µ–∞–ª—å–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç. –∫–æ—Ä-—Ü–∏—è.      –ò–¥–µ–∞–ª—å–Ω–∞—è –æ—Ç—Ä–∏—Ü. –∫–æ—Ä-—Ü–∏—è.        –ù–µ—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
#           œÅ –ü–∏—Ä—Å–æ–Ω–∞ = 1                   œÅ –ü–∏—Ä—Å–æ–Ω–∞ = -1                  œÅ –ü–∏—Ä—Å–æ–Ω–∞ = 0
#     _________________________       _________________________       _________________________            
#    |                        *|     |*                        |     |                         |             
#    |                      *  |     |  *                      |     |    *       *     *      |            
#    |                    *    |     |    *                    |     |       *             *   |              
#    |                  *      |     |      *                  |     |  *       *     *    *   |          
#    |                *        |     |        *                |     |      *                  |            
#    |              *          |     |          *              |     |  *        *    *     *  |            
#    |            *            |     |            *            |     |    *        *           |          
#    |          *              |     |              *          |     |          *       *      |        
#    |        *                |     |                *        |     |     *       *      *    |            
#    |      *                  |     |                  *      |     |  *    *        *        |             
#    |    *                    |     |                    *    |     |          *           *  |            
#    |  *                      |     |                      *  |     |  *     *   *      *     |          
#    |*                        |     |                        *|     |                         | 
#     ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ             



# 2) –£–¥–∞–ª–µ–Ω–∏–µ –≤—ã–±—Ä–æ—Å–æ–≤:

#    2.1) –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ò–ù–î–ï–ö–°–´ —Ç–æ—á–µ–∫ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ –ø–æ –≥—Ä–∞—Ñ–∏–∫—É:

#         –ü–æ—Å–∫–æ–ª—å–∫—É –Ω–∞—à–∏ –º–µ—Ä—ã —Å–≤—è–∑–∏ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã –∫ –≤—ã–±—Ä–æ—Å–∞–º, 
#         –º—ã —Ä–µ—à–∞–µ–º –æ–ø–∏—Å–∞—Ç—å –≤—ã–±—Ä–æ—Å—ã –æ—Ç–¥–µ–ª—å–Ω–æ –∏ —É–¥–∞–ª–∏—Ç—å –∏–∑ 
#         –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –∫–∞–∫ –Ω–µ –≤–ø–∏—Å—ã–≤–∞—é—â–∏–µ—Å—è –≤ –æ–±—â—É—é –∫–∞—Ä—Ç–∏–Ω—É.

#         –î–ª—è –û–ü–ò–°–ê–ù–ò–Ø –∏ –£–î–ê–õ–ï–ù–ò–Ø –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –Ω–∞–º –Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å –∏—Ö –∏–Ω–¥–µ–∫—Å—ã (–Ω–æ–º–µ—Ä–∞ —Å—Ç—Ä–æ–∫).
         
          cat('\033[0;31;1m', "\n", "–í—ã–±–µ—Ä–µ—Ç–µ —Ç–æ—á–∫–∏ –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ ESC!",'\033[0;0m',"\n")
        
          identify <- identify(x)  # –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ —Ç–æ—á–µ–∫
         
          cat("\n", "–ò–Ω–¥–µ–∫—Å—ã –≤—ã–±—Ä–æ—Å–æ–≤:", '\033[0;31;1m', identify, '\033[0;0m', "\n")
          cat("\n", "–í—ã–±—Ä–æ—Å—ã:", "\n"); print(x[identify, ]);cat("\n")
          
#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:   
#         –ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã "identify()" –ø–æ—è–≤–∏—Ç—Å—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å      P.s: –º–æ–∂–Ω–æ —ç—Ç–æ—Ç –∫—Ä–∞–π –ø—Ä–æ—Å—Ç–æ –∑–∞–∫–ª–∏–∫–∞—Ç—å –¥–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è: 
#         "—â–µ–ª—á–∫–æ–º" –æ—Ç–º–µ—á–∞—Ç—å –ø—Ä—è–º–æ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –∏–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ —Ç–æ—á–∫–∏.       "–±–ª–∏–∂–∞–π—à–∞—è —Ç–æ—á–∫–∞ —É–∂–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞", –∞ –Ω–µ —Ç–æ—á–µ—á–Ω–æ –≤—ã—Ü–µ–ª–∏–≤–∞—Ç—å
#         –î–ª—è –û–¢–ú–ï–ù–´ - –Ω–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "Esc".
#         
#                 –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è      
#                 _____________________     
#             260|  *30               *|    
#                | *17  <- –∏–Ω–¥–µ–∫—Å—ã, –∞ –Ω–µ "x" –∏–ª–∏ "y" ! 
#          A  240|*5                   |     
#          n     |            *  *  *  |     
#          x  220|          *  * *     |    
#          i     |     *  *  *  *      |         
#          e  200|      *   *  *       |       
#          t     |   *   *             |     
#          y  180|    * *              |     
#                |  *                  |
#             160|                     |     
#                 ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ      
#                70   85   100  115  130
#         
#                          IQ 
#         
#         –†–µ–∑—É–ª—å—Ç–∞—Ç –≤ Console:
#         [1]  5 17 30
          
    
#    2.2) –û—á–∏—Å—Ç–∏–º —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö –æ—Ç —ç—Ç–∏—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π (–≤—ã–±—Ä–æ—Å–æ–≤):
          if (length(identify)==0){x.clean <- x}else{
          x.clean <- x[-identify, ]}

#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:             
#         –í–µ–∫—Ç–æ—Ä —Å–æ –∑–Ω–∞–∫–æ–º ‚Äú–º–∏–Ω—É—Å‚Äù —Å–æ—Å—Ç–∞–≤–ª—è–µ–º –∏–∑ –∏–Ω–¥–µ–∫—Å–æ–≤ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π-–≤—ã–±—Ä–æ—Å–æ–≤,
#         –ø–æ–¥–ª–µ–∂–∞—â–∏—Ö –∏—Å–∫–ª—é—á–µ–Ω–∏—é ‚Äî –∏—Ö —Ñ–∏–ª—å—Ç—Ä [] –æ—Ç–±—Ä–∞—Å—ã–≤–∞–µ—Ç.
#         –ò–Ω–¥–µ–∫—Å —Å—Ç–æ–ª–±—Ü–∞, j –Ω–µ —É–∫–∞–∑–∞–Ω (–ø–æ—Å–ª–µ –∑–∞–ø—è—Ç–æ–π –ø—É—Å—Ç–æ) ‚Äî –±–µ—Ä—É—Ç—Å—è –æ–±–∞ —Å—Ç–æ–ª–±—Ü–∞ —Ç–∞–±–ª–∏—Ü—ã.
#         –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –Ω–æ–≤–æ–π —Ç–∞–±–ª–∏—Ü–µ x.clean

#                –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è      
#                _____________________     
#            260|                    *|    
#               |   <- –≤—ã–±—Ä–æ—Å—ã –±—ã–ª–∏ –æ—á–∏—â–µ–Ω—ã!    
#         A  240|                     |     
#         n     |            *  *  *  |     
#         x  220|          *  * *     |    
#         i     |     *  *  *  *      |         
#         e  200|      *   *  *       |       
#         t     |   *   *             |     
#         y  180|    * *              |     
#               |  *                  |
#            160|                     |     
#                ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ      
#               70   85   100  115  130   
#         
#                         IQ 

#    2.3) –£–±–µ–¥–∏–º—Å—è, —á—Ç–æ –≤—ã–±—Ä–æ—Å—ã –∏—Å—á–µ–∑–ª–∏:
          par(mfrow = c(1, 3))
               
          plot(x = x[[a]],
               y = x[[b]],
               main = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è
            –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö            ",
               xlab = names(x[a]), 
               ylab = names(x[b]),
     
               points(x[identify, 1], y = x[identify, 2], pch = 19, col='red', cex=1)
          )
          
          plot(x = x.clean[[a]],
               y = x.clean[[b]],
               main = "–î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è, 
                       –æ—á–∏—â–µ–Ω–Ω–∞—è –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤                       ",
               xlab = names(x.clean[a]), 
               ylab = names(x.clean[b]))
    
          
#    2.4) –ü–µ—Ä–µ–¥ —Ä–∞—Å—á–µ—Ç–∞–º–∏ –ø–æ—Å–º–æ—Ç—Ä–∏–º —Å–≤–æ–¥–∫—É –ø–æ —Ç–∞–±–ª–∏—Ü–µ –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –µ—ë:                 
#         summary(x.clean)

#         -/–ü–†–ò–ú–ï–†/-: 
#         IQ           Anxiety     
#         Min.   : 73.0   Min.   :156.0  
#         1st Qu.: 90.5   1st Qu.:191.0  
#         Median :101.0   Median :202.0  
#         Mean   :101.6   Mean   :202.8  
#         3rd Qu.:108.0   3rd Qu.:211.5  
#         Max.   :133.0   Max.   :253.0
#         -----------------------------
#         NA's   :2       NA's   :2   
#         -----------------------------

#    2.5) –î–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫ (–∏–∑–±–∞–≤–∏–º—Å—è –æ—Ç NA):               
          x.clean <- na.omit(x.clean); # summary(x.clean)  

#         -/–í–ê–ñ–ù–û/-:
#         –ù–ï –ü–†–ò–ú–ï–ù–Ø–¢–¨ —Ñ—É–Ω–∫—Ü–∏—é na.omit() –î–û –æ—á–∏—Å—Ç–∫–∏ –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤, –∏–Ω–∞—á–µ –∏–Ω–¥–µ–∫—Å—ã —Å–¥–≤–∏–Ω—É—Ç—å—Å—è!          


# 3) –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤ –¥–∞–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã –ø—Ä–∏ –ø–æ–º–æ—â–∏:
#    ‚Ä¢ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏ Cov;          
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ œÅ (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅ –ü–∏—Ä—Å–æ–Ω–∞);
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ œÅs (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅs –°–ø–∏—Ä–º–µ–Ω–∞).
#
#
#    -/–û–ë–©–ê–Ø –¢–ï–û–†–ò–Ø/-
#    –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è, –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å ‚Äî –≤–∑–∞–∏–º–æ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –¥–≤—É—Ö –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω. 
#    –°—É—Ç—å –µ–µ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ–µ 
#    –∏–∑–º–µ–Ω–µ–Ω–∏–µ (—É–º–µ–Ω—å—à–µ–Ω–∏—é –∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏—é) –¥—Ä—É–≥–æ–π(-–∏—Ö) –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π(-—ã—Ö).   
#     
#    –£ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –µ—Å—Ç—å —Ç—Ä–∏ –≤–∞–∂–Ω—ã—Ö —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:
#    ‚Ä¢	—Ç–∏–ø, –∏–ª–∏ —Ñ–æ—Ä–º–∞ (–ª–∏–Ω–µ–π–Ω–∞—è/–≤–∞—Ä–∏–∞–Ω—Ç—ã –Ω–µ–ª–∏–Ω–µ–π–Ω–æ–π);
#    ‚Ä¢	–≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å (—Ç–µ—Å–Ω–æ—Ç–∞, —Å–∏–ª–∞)
#    ‚Ä¢	—É –ª–∏–Ω–µ–π–Ω–æ–π –∏ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π ‚Äî –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∏ (–ø—Ä—è–º–∞—è/–æ–±—Ä–∞—Ç–Ω–∞—è, –∏–ª–∏ +/‚Äì).
#         
#
#    3.1) –ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è Cov (–º–µ—Ä–∞ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–π –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ (–õ–ò–ù–ï–ô–ù–û–ô —Å–≤—è–∑–∏) –¥–≤—É—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω):
#
#         –ú—ã –±—É–¥–µ–º –≤—ã—è—Å–Ω—è—Ç—å, –∫–∞–∫–∞—è –∏–∑ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç: 
#         ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ  - –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è (+) (–ø—Ä–∏ —Ä–æ—Å—Ç–µ –æ–¥–Ω–æ–π –≤—Ç–æ—Ä–∞—è —Ç–æ–∂–µ —É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç—Å—è); 
#         ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è —Ä–∞–∑–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ - –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è (-) (–µ—Å–ª–∏ –æ–¥–Ω–∞ —Ä–∞—Å—Ç—ë—Ç, –≤—Ç–æ—Ä–∞—è —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è).
#
#         –î–ª—è —Å–æ–ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π —Ä–∞–∑–¥–µ–ª–∏–º –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –Ω–∞ –¥–≤–µ –≥—Ä—É–ø–ø—ã: 
#         ‚Ä¢ –≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ;
#         ‚Ä¢ –Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ.   
#         
#           –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è      –≠—Ç–æ —É–¥–æ–±–Ω–æ —Å–¥–µ–ª–∞—Ç—å, –¶–ï–ù–¢–†–ò–†–û–í–ê–í –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ, –≥–¥–µ: 
#           _____________________      ‚Ä¢ –≤ –≥—Ä—É–ø–ø—É "–≤—ã—à–µ —Å—Ä–µ–¥–Ω–µ–≥–æ" ‚Äî –≤–æ–π–¥—É—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π; 
#          |"2"*      |      *"1"|     ‚Ä¢ –≤ –≥—Ä—É–ø–ø—É "–Ω–∏–∂–µ —Å—Ä–µ–¥–Ω–µ–≥–æ" ‚Äî –≤–æ–π–¥—É—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.           
#         6| *        |   *  *   |    
#          |*         |* *  *    |     –ï—Å–ª–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ, —Ç–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –≤ –¥–≤—É—Ö –≥—Ä—É–ø–ø–∞—Ö –æ–∫–∞–∂–µ—Ç—Å—è –ø—Ä–∏–º–µ—Ä–Ω–æ –ü–û–†–û–í–ù–£.        
#         3|          |*  *      |     
#          |      * * |  * *     |     –ö–æ–º–±–∏–Ω–∏—Ä—É—è –∑–Ω–∞–∫–∏ –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –≤—Å–µ–≥–æ –º—ã –ø–æ–ª—É—á–∏–º —á–µ—Ç—ã—Ä–µ –≥—Ä—É–ø–ø—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π,         
#         0|------*-- |-*--*-----|     –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –∫–≤–∞–¥—Ä–∞–Ω—Ç–∞—Ö (—á–µ—Ç–≤–µ—Ä—Ç—è—Ö) —Å–∏—Å—Ç–µ–º—ã –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç:          
#          |     *  * |  *       |       
#        -3|   * * *  |          |     –ù–∞–±–ª—é–¥–µ–Ω–∏—è 1-–≥–æ –∏ 3-–≥–æ –∫–≤–∞–¥—Ä–∞–Ω—Ç–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é –ø—Ä—è–º–æ–π —Å–≤—è–∑–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:      
#          |  * * *   |          |     ‚Ä¢ –æ–±–µ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –≤ –æ–¥–Ω—É —Å—Ç–æ—Ä–æ–Ω—É (–æ–±–µ –≤ –±–æ–ª—å—à—É—é –ª–∏–±–æ –≤ –º–µ–Ω—å—à—É—é).        
#        -6|  *       |          |
#          |"3"       |       "4"|     –ù–∞–±–ª—é–¥–µ–Ω–∏—è 2-–≥–æ –∏ 4-–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –æ–±—Ä–∞—Ç–Ω—É—é —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é:   
#           ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ      ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã.
#          -20  -10   0   10   20
#         
#         –ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è –æ—Ç—Ä–∞–∂–∞–µ—Ç –∫–∞–∫ —á–∞—Å—Ç–æ—Ç—É, —Ç–∞–∫ –∏ –≤–µ–ª–∏—á–∏–Ω—É –ø—Ä–æ—è–≤–ª–µ–Ω–∏–π –∫–∞–∂–¥–æ–π —Ç–µ–Ω–¥–µ–Ω—Ü–∏–∏.

#         –ó–Ω–∞–∫ –∏ –≤–µ–ª–∏—á–∏–Ω–∞ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏ —É–∫–∞–∑—ã–≤–∞—é—Ç –Ω–∞:
#         ----------------------------------------
#         ‚Ä¢ –ø—Ä–µ–æ–±–ª–∞–¥–∞—é—â—É—é —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é;
#         ‚Ä¢ –Ω–∞ —Å—Ç–µ–ø–µ–Ω—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç–∏;
#         ‚Ä¢ —Å–∏–ª—É.

#         –§–æ—Ä–º—É–ª–∞:                           |   -/–ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—ã–º–∏ —Å–ª–æ–≤–∞–º–∏/- 
#                    N                       |   -------------------------------    
#                    Œ£  (X·µ¢ - Œº‚Çì)(y·µ¢ - Œº·µß)   |   –ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è ‚Äî —ç—Ç–æ –º–µ—Ä–∞ —Ç–æ–≥–æ, –∫–∞–∫ –¥–≤–µ —Å–ª—É—á–∞–π–Ω—ã–µ –≤–µ–ª–∏—á–∏–Ω—ã –∏–∑–º–µ–Ω—è—Ç—Å—è –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º.
#                   i=1                      |   –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è ‚Äî —ç—Ç–æ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –¥–≤—É–º—è —Ç–µ–Ω–¥–µ–Ω—Ü–∏—è–º–∏: –ø—Ä—è–º—ã–º –∏ –æ–±—Ä–∞—Ç–Ω—ã–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.
#         Cov x,y = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî   |   ‚Ä¢ –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è - –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É–≤–µ–ª–∏—á–∏–≤–∞—é—Ç—Å—è –∏–ª–∏ —É–º–µ–Ω—å—à–∞—é—Ç—Å—è.
#                             N              |   ‚Ä¢ –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è - –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Ä–∞—Å—Ç—ë—Ç, –≤—Ç–æ—Ä–∞—è —É–º–µ–Ω—å—à–∞–µ—Ç—Å—è.
#                                            |   ‚Ä¢ –ù—É–ª–µ–≤–∞—è       –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è - –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∏.
#          
#         –ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è –º–æ–∂–µ—Ç –∏–∑–º–µ—Ä—è—Ç—å –¥–≤–∏–∂–µ–Ω–∏—è –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –Ω–æ –Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å—Ç–µ–ø–µ–Ω—å, 
#         –≤ –∫–æ—Ç–æ—Ä–æ–π —ç—Ç–∏ –¥–≤–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É.
  
  
          Cov_x.y <- function(x.table)
          {
            x.table <- na.omit(x.table)
            Œ£ <- sum(                                # —Å–ª–æ–∂–∏–≤ –≤—Å–µ —ç—Ç–∏ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è, –º—ã –ø–æ–ª—É—á–∏–º —Ä–∞–∑–Ω–æ—Å—Ç—å –¥–≤—É—Ö —Å—É–º–º:
              (x.table[[1]]-mean(x.table[[1]])) *    # (–∞) –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –≤ –æ–¥–Ω–æ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏;
                (x.table[[2]]-mean(x.table[[2]]))    # (–±) –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–π –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –≤ –ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω—ã—Ö.
            ) 
            N <- nrow(x.table)  # –ù–æ—Ä–º–∏—Ä—É–µ–º —ç—Ç—É —Ä–∞–∑–Ω–æ—Å—Ç—å –Ω–∞ –æ–±—ä—ë–º –Ω–∞–±–ª—é–¥–µ–Ω–∏–π N - –Ω–∞–π–¥—ë–º —Å—Ä–µ–¥–Ω–µ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ –∫–∞–∂–¥–æ–º—É –Ω–∞–±–ª—é–¥–µ–Ω–∏—é (–∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è)
            return(Œ£/N)
          }
          Cov_x.y(x.clean)
          Cov_x.y(x)
  
#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:  
#         –ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ñ–æ—Ä–º—É–ª–∞ –ö–û–í–ê–†–ò–ê–¶–ò–ò –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ñ–æ—Ä–º—É–ª—É –î–ò–°–ü–ï–†–°–ò–ò.
#         –ï—Å–ª–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –Ω–µ—Ç, —Ç–æ –Ω–∏ –æ–¥–Ω–∞ –∏–∑ —Ç–µ–Ω–¥–µ–Ω—Ü–∏–π –Ω–µ –ø—Ä–µ–æ–±–ª–∞–¥–∞–µ—Ç (x·µ¢=y·µ¢), => (Cov = œÉ2).
#         –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—é –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ —Å–æ–≤–º–µ—Å—Ç–Ω—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é –¥–≤—É—Ö —Å–ª—É—á–∞–π–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω, 
#         –∞ –¥–∏—Å–ø–µ—Ä—Å–∏—é ‚Äî –∫–∞–∫ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞–µ—Ç—Å—è –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è –≤–µ–ª–∏—á–∏–Ω—ã —Å–∞–º–æ–π —Å —Å–æ–±–æ–π.


#    3.2) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œÅ (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅ –ü–∏—Ä—Å–æ–Ω–∞):         

#         –£ "–∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏" –µ—Å—Ç—å –ü–†–û–ë–õ–ï–ú–ê - –æ–Ω–∞ –∑–∞–≤–∏—Å–∏ –æ—Ç –º–∞—Å—à—Ç–∞–±–∞ –∫–∞–∂–¥–æ–π –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

#         -/–ü–†–ò–ú–ï–†/-: 
#         ‚Ä¢ –µ—Å–ª–∏ –≤–æ–∑—å–º–µ–º   x –≤ [–º–º] - –æ–¥–Ω–æ   –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏;
#         ‚Ä¢ –µ—Å–ª–∏ –ø–µ—Ä–µ–≤–µ–¥–µ–º x –≤ [–º]  - –¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏.

#         –ö—Ä–æ–º–µ —Ç–æ–≥–æ, –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ –Ω–µ–ª—å–∑—è —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Å–∏–ª—É —Å–≤—è–∑–∏ –ø–∞—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, 
#         –∏–º–µ—é—â–∏—Ö —Ä–∞–∑–Ω—ã–µ –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è.

#         –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ, –ø–æ—ç—Ç–æ–º—É –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ —Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏ –µ—â—ë –ø—Ä–æ–≤–æ–¥–∏–º –ù–û–†–ú–ò–†–û–í–ê–ù–ò–ï, 
#         —Ç.–µ. —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑—É–µ–º –æ–±–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ. –¢.–µ. –ø—Ä–æ—Å—Ç–æ –¥–µ–ª–∏–º –µ—â–µ –∏ –Ω–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ã–Ω–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è x –∏ y.
#
#                  N  (X·µ¢ - Œº‚Çì) (y·µ¢ - Œº·µß)    N                       |   -/–ö—Ä–∞—Ç–∫–æ –æ "œÅ –ü–∏—Ä—Å–æ–Ω–∞"/- 
#                  Œ£  ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî    Œ£  (X·µ¢ - Œº‚Çì)(y·µ¢ - Œº·µß)   |   -------------------------------
#                 i=1    œÉx        œÉy       i=1                      |   –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ = "1"  (–ø–æ–ª–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è);
#         P x,y = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî   |   –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ  –∑–Ω–∞—á–µ–Ω–∏–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ = "‚àí1" (–ø–æ–ª–Ω–∞—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è);
#                            N                     N œÉx œÉy           |   —Å—Ä–µ–¥–Ω–µ–µ      –∑–Ω–∞—á–µ–Ω–∏–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ = "0"  (–æ—Ç—Å—É—Ç—Å–≤–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏).

          P.Pearson <- function(x.table)
          {
            x.table <- na.omit(x.table)
            sd_x    <- sqrt(sum((x.table[[1]] - mean(x.table[[1]]))^2)/nrow(x.table))
            sd_y    <- sqrt(sum((x.table[[2]] - mean(x.table[[2]]))^2)/nrow(x.table))
            Œ£       <- sum((x.table[[1]]-mean(x.table[[1]]))*(x.table[[2]]-mean(x.table[[2]])))
            N.œÉx.œÉy <- nrow(x.table)*sd_x*sd_y
            return(Œ£/N.œÉx.œÉy)
          }

          P.Pearson(x.clean)
          P.Pearson(x)


#         –†–µ–∑—é–º–µ –ø–æ –∫–æ–≤–∞—Ä–∏–∞—Ü–∏–∏ –∏ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞:
#         ---------------------------------------------------
#         –ö–æ–≤–∞—Ä–∏–∞—Ü–∏—è –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞ –æ–ø–∏—Å—ã–≤–∞—é—Ç –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å, –∏–ª–∏ —Ç–µ—Å–Ω–æ—Ç—É –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏,
#         —Ç.–µ. —Ç–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –∏–º–µ–µ—Ç —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é –∏–∑–º–µ–Ω—è—Ç—å—Å—è –ø—Ä—è–º–æ –∏–ª–∏ –æ–±—Ä–∞—Ç–Ω–æ –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥—Ä—É–≥–æ–π.

#         –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏, –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ –æ–ø–∏—Å—ã–≤–∞–µ—Ç, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–∫–∏ –¥–∞–Ω–Ω—ã—Ö 
#         –±–ª–∏–∑–∫–æ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –∫ –≤–æ–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø—Ä—è–º–æ–π, –∫–æ—Ç–æ—Ä—É—é –º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –Ω–∏—Ö –ø—Ä–æ–≤–µ—Å—Ç–∏. 

#         –ï—Å–ª–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è, –≤–æ–∫—Ä—É–≥ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Ç–æ—á–∫–∏, –Ω–µ –ø—Ä—è–º–∞—è, 
#         –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –±—ã—Ç—å –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–º–∏ –º–µ—Ä–∞–º–∏ —Å–≤—è–∑–∏.



#    3.2) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œÅs (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅs –°–ø–∏—Ä–º–µ–Ω–∞).

#         3.2.1) –ü–æ –¥–∏–∞–≥—Ä–∞–º–º–µ –≤–∏–¥–Ω–æ, —á—Ç–æ –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è, –≤–æ–∫—Ä—É–≥ –∫–æ—Ç–æ—Ä–æ–π —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã —Ç–æ—á–∫–∏, –Ω–µ –ø—Ä—è–º–∞—è. 
#                –ó–Ω–∞—á–∏—Ç –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è –∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–µ—Ä–µ—Å—Ç–∞—é—Ç –±—ã—Ç—å –∞–¥–µ–∫–≤–∞—Ç–Ω—ã–º–∏ –º–µ—Ä–∞–º–∏ —Å–≤—è–∑–∏.

#                –¢–∞–∫–∞—è –Ω–µ–ª–∏–Ω–µ–π–Ω–∞—è —Å–≤—è–∑—å –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è - –ú–û–ù–û–¢–û–ù–ù–û–ô.
#            
#                –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –º–æ–Ω–æ—Ç–æ–Ω–Ω–∞—è —Å–≤—è–∑—å         
#                 _______________________      
#                |*                      |     –§—É–Ω–∫—Ü–∏—è - –ú–û–ù–û–¢–û–ù–ù–ê–Ø, –µ—Å–ª–∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π       
#                |*                      |     –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è —Å –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–µ–º (—É–±—ã–≤–∞–Ω–∏–µ–º) –¥—Ä—É–≥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.   
#                |*                      |     
#                |*                      |     –ú–æ–Ω–æ—Ç–æ–Ω–Ω–∞—è —Å–≤—è–∑—å –º–æ–∂–µ—Ç –±—ã—Ç—å:
#                |  *                    |     ----------------------------        
#                |  *                    |     ‚Ä¢ –ª–∏–±–æ –Ω–µ—É–±—ã–≤–∞—é—â–µ–π;
#                |    *                  |     ‚Ä¢ –ª–∏–±–æ –Ω–µ–≤–æ–∑—Ä–∞—Å—Ç–∞—é—â–µ–π.               
#                |    *                  |         
#                |      *                |     –ù–µ—Å–º–æ—Ç—Ä—è —Ç–∞–∫—É—é –ø–æ–ª–Ω—É—é —Å–≤—è–∑—å, –Ω–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–∞–∑–±—Ä–æ—Å–∞ —Ç–æ—á–µ–∫ –≤–æ–∫—Ä—É–≥ –≤–æ–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ª–∏–Ω–∏–∏,
#                |        * *            |     –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∏—Ö –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –≤–Ω–æ–≤—å –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ –º–æ–¥—É–ª—é –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ –µ–¥–∏–Ω–∏—Ü—ã.         
#                |            * *        |             
#                |                * * * *|     –ü—Ä–∏ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ —á–∞—Å—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–º–µ—é—Ç –≤—ã—Ä–∞–∂–µ–Ω–Ω—É—é –∞—Å–∏–º–º–µ—Ç—Ä–∏—é, –ø—Ä–∏—á—ë–º –µ—ë –∑–Ω–∞–∫–∏ —Ä–∞–∑–ª–∏—á–∞—é—Ç—Å—è.      
#                 ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ    

#                –ö–æ—ç—Ñ—Ñ—Ü–∏—Ü–µ–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü–∏–∏ "–ü–∏—Ä—Å–æ–Ω–∞ p" –º–æ–∂–µ—Ç –≤—ã–π—Ç–∏ –∑–¥–µ—Å—å —Å–∏–ª—å–Ω–æ –∑–∞–Ω–∏–∂–µ–Ω–Ω—ã–º, —Ö–æ—Ç—è —Ç–æ—á–∫–∏ –ø–æ—á—Ç–∏ –∏–¥—É—Ç —Ä–æ–≤–Ω–æ –ø–æ –ª–∏–Ω–∏–∏.
#                –≠—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç –æ —Ç–æ–º, —á—Ç–æ –∑–¥–µ—Å—å –¥–∞–Ω–Ω–∞—è –º–µ—Ä–∞ –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è.

#                
#         3.2.2) –î–ª—è —Ç–æ–≥–æ, —á—Ç–æ–±—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä–µ–ª—è—Ü–∏–∏, –Ω—É–∂–Ω–æ –í–´–ü–†–Ø–ú–ò–¢–¨ –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ.
#                –¢.–µ. –Ω—É–∂–Ω–æ –∏—Å–∫—É—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã–ø—Ä—è–º–ª—è–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ, —á—Ç–æ–±—ã –æ–Ω–∞ –Ω–∞–ª–µ–∑–∞–ª–∞ –Ω–∞ –æ–¥–Ω—É –ø—Ä—è–º—É—é –∏ —Å—á–∏—Ç–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏.                  
#
#                –ü—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –∞—Å–∏–º–º–µ—Ç—Ä–∏–∏ ‚Äî –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –≤ —Ä–∞–Ω–≥–∏: 
#                —Ç–∞–∫ –º—ã –ø–æ–ª—É—á–∏–º –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≤–∏–¥–∞ ‚Äú1, 2, 3, 4 ‚Ä¶,‚Äù 
#                –≥–¥–µ –∫–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –±—É–¥–µ—Ç –≤—Å—Ç—Ä–µ—á–∞—Ç—å—Å—è –ª–∏—à—å –æ–¥–Ω–∞–∂–¥—ã, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ä–∞–Ω–≥–æ–≤.
#
          
                 x.clean.rang <- data.frame(a = rank(x.clean[[a]]),
                                            b = rank(x.clean[[b]]))
                 
#                –°—Ä–∞–∑—É –¥–µ–ª–∞–µ–º —Ä–∞–Ω–≥–∏ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã–±—Ä–æ—Å–∞–º–∏                           
                 x.rang       <- data.frame(a = rank(x[[a]]),
                                            b = rank(x[[b]]))
                 
                 names(x.clean.rang) <- c(names(x.clean[a]), names(x.clean[b]))
                 names(x.rang)       <- c(names(x.clean[a]), names(x.clean[b]))
                 
#         3.2.3) –ó–∞—Ç–µ–º –≤—ã—á–∏—Å–ª–∏–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–æ —Ç–æ–π –∂–µ —Ñ–æ—Ä–º—É–ª–µ –ü–∏—Ä—Å–æ–Ω–∞ –¥–ª—è —ç—Ç–∏—Ö —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö 
#                ‚Äî –æ–Ω –±—É–¥–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è —É–∂–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–º —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –°–ø–∏—Ä–º–µ–Ω–∞ œÅs (Spearman‚Äôs rank correlation coefficient). 

                 P.Pearson(x.clean.rang)  # –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –°–ø–∏—Ä–º–µ–Ω–∞ œÅs –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
                 
                 P.Pearson(x.rang)        # –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –°–ø–∏—Ä–º–µ–Ω–∞ œÅs –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Å –≤—ã–±—Ä–æ—Å–∞–º–∏


#                -/–ü–†–ò–ú–ï–† –†–ï–ó–£–õ–¨–¢–ê–¢–ê/-:
#                                                                                            
#                            –ú–æ–Ω–æ—Ç–æ–Ω–Ω–∞—è —Å–≤—è–∑—å                    –†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ           
#                   700  _______________________           35  ________________________    
#                       |*                      |             | *                      |   –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –°–ø–∏—Ä–º–µ–Ω–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ     
#                       |**                     |       –≤  30 |   *  *                 |   —Å –∫–æ—Å–≤–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ñ–æ—Ä–º–∞–ª—å–Ω–æ —è–≤–ª—è—é—Ç—Å—è –ø–æ—Ä—è–¥–∫–æ–≤—ã–º–∏, 
#                –≤  500 |*                      |       —Ä     |  * *  * *              |   –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –º—ã —Å—á–∏—Ç–∞–µ–º, —á—Ç–æ –ø–æ—Å–ª–µ –ø–µ—Ä–µ–≤–æ–¥–∞ –∏—Ö —à–∫–∞–ª—ã –≤ —Ä–∞–Ω–≥–æ–≤—É—é 
#                —Ä      |*                      |       –µ  25 |     *  *               |   —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É —Ç–∞–∫–∏–º–∏ —Ä–∞–Ω–≥–∞–º–∏ –∏–º–µ—é—Ç –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–π —Å–º—ã—Å–ª –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤. 
#                –µ      |**                     |       –º     |    *   *  *            |   
#                –º  300 | **                    | --->  —è  20 |       *  *             |   –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ œÅs –æ–±—ã—á–Ω–æ –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω–µ–µ œÑ –ö–µ–Ω–¥–∞–ª–ª–∞, 
#                —è      |  *                    |       ,     |           *  *         |   –ø–æ—Å–∫–æ–ª—å–∫—É —É—á–∏—Ç—ã–≤–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, 
#                ,      |   *                   |       —Ä  15 |               *        |   –Ω–æ –∏ –ø–ª–µ—á–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –æ—Ç —Ü–µ–Ω—Ç—Ä–∞, –∏–∑–º–µ—Ä–µ–Ω–Ω–æ–µ –≤ —Ä–∞–Ω–≥–∞—Ö. 
#                –º  100 |     *                 |       –∞     |               * *      |   œÑ –ö–µ–Ω–¥–∞–ª–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –ø—Ä–∏ —Å—Ç—Ä–æ–≥–æ –ø–æ—Ä—è–¥–∫–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö.
#                –∏      |        *              |       –Ω  10 |                   *    |   
#                –Ω      |           *           |       –≥     |                     *  |   –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å œÅs –º–æ–∂–µ–º –∫–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–ª—É—á–∏–ª–∏ –±—ã,        
#                     0 |                      *|       –∏   5 |                       *|   –µ—Å–ª–∏ –±—ã –≤—ã–ø—Ä—è–º–∏–ª–∏ –∫—Ä–∏–≤—É—é –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ –≤–º–µ—Å—Ç–µ —Å —Ä–∞—Å—Å–µ—è–Ω–Ω—ã–º–∏ –≤–æ–∫—Ä—É–≥ –Ω–µ—ë —Ç–æ—á–∫–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.           
#                        ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ               ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ  
#                       30  35  40  45  50  55  60          0   5   10  15  20  25  30 35
#                                 –ø—Ä–æ–±—ã, %                            –ø—Ä–æ–±—ã, —Ä–∞–Ω–≥–∏
#                
#                -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-:
#                –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ œÅs –æ—â—É—Ç–∏–º–æ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–µ—Å–Ω–æ–π —Å–≤—è–∑–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, –∫–æ–≥–¥–∞ –µ—ë –∫—Ä–∏–≤–æ–ª–∏–Ω–µ–π–Ω–æ—Å—Ç—å —Ö–æ—Ä–æ—à–æ –≤—ã—Ä–∞–∂–µ–Ω–∞. 
#                –ü–æ –º–µ—Ä–µ —É–≤–µ–ª–∏—á–µ–Ω–∏—è —Ä–∞–∑–±—Ä–æ—Å–∞ —Ç–æ—á–µ–∫ –≤–æ–æ–±—Ä–∞–∂–∞–µ–º–∞—è –æ–ø—Ç–∏–º–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è, –≤–æ–∫—Ä—É–≥ –∫–æ—Ç–æ—Ä–æ–π –æ–Ω–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã, —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≤—Å—ë –º–µ–Ω–µ–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π, 
#                –∏ —Ä–∞–∑–Ω–∏—Ü–∞ –º–µ–∂–¥—É –ª–∏–Ω–µ–π–Ω–æ–π –∏ –º–æ–Ω–æ—Ç–æ–Ω–Ω–æ–π —Ñ–æ—Ä–º–∞–º–∏ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ø–µ—Ä–µ—Å—Ç–∞—ë—Ç –±—ã—Ç—å –∑–∞–º–µ—Ç–Ω–æ–π. 
#                –ü—Ä–∏ œÅ < 0.5 –≤–µ–ª–∏—á–∏–Ω–∞ —ç—Ç–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –Ω–µ—Ä–µ–¥–∫–æ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –¥–∞–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –±–æ–ª—å—à–µ, —á–µ–º œÅs.       




# 1) –ü–æ—Å—Ç—Ä–æ–∏–º –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞—Å—Å–µ—è–Ω–∏—è —Ä–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö 
     plot(x = x.clean.rang[[a]],
          y = x.clean.rang[[b]],
          main = "–†–∞–Ω–∂–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã",
          xlab = names(x.clean.rang[a]), 
          ylab = names(x.clean.rang[b]))
     
     par(mfrow = c(1,1))


# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:

#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è

#    –í —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–æ—á–Ω—ã–µ, –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —É—Å–ª–æ–≤–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ —Ä–∞–∑–º–µ—Ä–∞ —ç—Ñ—Ñ–µ–∫—Ç–∞, –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–Ω—ã–µ –î–∂–µ–π–∫–æ–±–æ–º –ö–æ—ç–Ω–æ–º (Cohen, 1988).

     if  (abs(P.Pearson(x.clean)) <  0.10)                                           {power1.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
     if ((abs(P.Pearson(x.clean)) >= 0.10) & (abs(P.Pearson(x.clean)) < 0.30))           {power1.com <- "—Å–ª–∞–±–∞—è"     }
     if ((abs(P.Pearson(x.clean)) >= 0.30) & (abs(P.Pearson(x.clean)) < 0.50))           {power1.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
     if  (abs(P.Pearson(x.clean)) >= 0.50)                                           {power1.com <- "—Ç–µ—Å–Ω–∞—è"     }
     
     if  (abs(P.Pearson(x.clean.rang)) <  0.10)                                      {power2.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
     if ((abs(P.Pearson(x.clean.rang)) >= 0.10) & (abs(P.Pearson(x.clean.rang)) < 0.30)) {power2.com <- "—Å–ª–∞–±–∞—è"     }
     if ((abs(P.Pearson(x.clean.rang)) >= 0.30) & (abs(P.Pearson(x.clean.rang)) < 0.50)) {power2.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
     if  (abs(P.Pearson(x.clean.rang)) >= 0.50)                                      {power2.com <- "—Ç–µ—Å–Ω–∞—è"     }


# –Ω–∞–±–ª—é–¥–µ–Ω–∏—è - —Ç–æ —á—Ç–æ –ø–æ —Å—Ç—Ä–æ–∫–∞–º, –ø—Ä–∏–º:   index tour.1 tour.2
#                                           3     3      3
# –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ - —Å—Ç–æ–ª–±—Ü—ã.

cat('–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:', '\033[1m', names(as.data.frame(x)[a]), '\033[0;0m',
    '–∏', '\033[1m', names(as.data.frame(x)[b]), '\033[0;0m', ":"                            ,"\n")

cat("-------------------------------------------------------------"                         ,"\n")
cat("a) \033[34m–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ –æ—á–∏—â–µ–Ω–Ω—ã–º –¥–∞–Ω–Ω—ã–º:\033[0m"                                                  ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                  ,"\n")
cat("   ‚Ä¢ –º–µ—Ä–∞ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ –¥–≤—É—Ö –≤–µ–ª–∏—á–∏–Ω –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è Cov:", Cov_x.y(x.clean)               ,"\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅ  –ü–∏—Ä—Å–æ–Ω–∞     :", P.Pearson  (x.clean)               ,"\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅs –°–ø–∏—Ä–º–µ–Ω–∞    :", P.Pearson  (x.clean.rang)          ,"\n")
cat("-------------------------------------------------------------"                         ,"\n")
cat("–±) \033[34m–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø–æ –¥–∞–Ω–Ω—ã–º —Å –≤—ã–±—Ä–æ—Å–∞–º–∏:\033[0m"                                                ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                ,"\n")
cat("   ‚Ä¢ –º–µ—Ä–∞ –ª–∏–Ω–µ–π–Ω–æ–π —Å–≤—è–∑–∏ –¥–≤—É—Ö –≤–µ–ª–∏—á–∏–Ω –∫–æ–≤–∞—Ä–∏–∞—Ü–∏—è Cov:", Cov_x.y(x)                     ,"\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅ  –ü–∏—Ä—Å–æ–Ω–∞     :", P.Pearson  (x)                     ,"\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ œÅs –°–ø–∏—Ä–º–µ–Ω–∞    :", P.Pearson  (x.rang)                ,"\n")
cat("-------------------------------------------------------------"                         ,"\n")

  cat("‚Ä¢ –í—ã–≤–æ–¥: 1) \033[34m–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –õ–ò–ù–ï–ô–ù–ê:\033[0m"                                                    ,"\n") 
  cat("            ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                         ,"\n")
if (P.Pearson(x.clean)>0){
  cat("             1.1) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œÅ  –ü–∏—Ä—Å–æ–Ω–∞", '\033[1m',  "–ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω,",'\033[0;0m', "—Ç.–µ.",  "\n")  
  cat("                  –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è", '\033[1m',  "–æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ.",'\033[0;0m', "\n")}

if (P.Pearson(x.clean)<0){
  cat("             1.1) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œÅ  –ü–∏—Ä—Å–æ–Ω–∞", '\033[1m',  "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω,",'\033[0;0m', "—Ç.–µ.",  "\n")  
  cat("                  –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è", '\033[1m',  "—Ä–∞–∑–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ.",'\033[0;0m', "\n")}
  cat("\n")
  cat("             1.2) –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power1.com ,'\033[0;0m', "—Å–≤—è–∑—å –º–µ–∂–¥—É", 
      '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
      "–∏",
      '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m');          cat("\n")
  cat("-------------------------------------------------------------" ,"\n")
  
  
  
  
    cat("‚Ä¢        2) \033[34m–ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ù–ï–õ–ò–ù–ï–ô–ù–ê–Ø –ú–û–ù–û–¢–û–ù–ù–ê–Ø:\033[0m"                         ,"\n")
    cat("            ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                         ,"\n")
if (P.Pearson(x.clean.rang)>0){
    cat("             1.2) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œÅs  –°–ø–∏—Ä–º–µ–Ω–∞", '\033[1m',  "–ø–æ–ª–æ–∂–∏—Ç–µ–ª–µ–Ω,",'\033[0;0m', "—Ç.–µ.",  "\n")  
    cat("                  –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è", '\033[1m',  "–æ–¥–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ.",'\033[0;0m', "\n")}
  
if (P.Pearson(x.clean.rang)<0){
    cat("             1.2) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç œÅs  –°–ø–∏—Ä–º–µ–Ω–∞", '\033[1m',  "–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª–µ–Ω,",'\033[0;0m', "—Ç.–µ.",  "\n")  
    cat("                  –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω—è—é—Ç—Å—è", '\033[1m',  "—Ä–∞–∑–Ω–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ.",'\033[0;0m', "\n")}
    cat("\n")
    cat("             2.2) –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power2.com ,'\033[0;0m', "—Å–≤—è–∑—å –º–µ–∂–¥—É", 
        '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[23m',
        "–∏",
        '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[23m');          cat("\n")
    cat("-------------------------------------------------------------" ,"\n")
    
  cat("\n")

  


# a.	–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å, –∫–∞–∫–∞—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–º–∏ –º–µ—Ç–æ–¥–∞–º–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ. –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –ø–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—è–≤–∏—Ç—å –ª–∏—à—å —Å–∞–º–æ –Ω–∞–ª–∏—á–∏–µ —Å–≤—è–∑–∏, –æ–ø–∏—Å–∞—Ç—å –µ—ë –≤—ã—Ä–∞–∂–µ–Ω–Ω–æ—Å—Ç—å –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏. –¢.–µ. Q–Æ–ª–∞>0.10 –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–∏—à—å —Ç–æ, —á—Ç–æ –µ—Å—Ç—å —Å–ª–∞–±–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.
# b.	–ê –≤–æ—Ç —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –º–µ—Ç–æ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–Ω–≥–æ–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –≤–ª–∏—è–Ω–∏–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–π —Å–≤—è–∑–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏.









}



Anova.disp <- function(x, main.plot="–î–∏–∞–≥—Ä–∞–º–º–∞", xlab.plot = names(x)[1], ylab.plot = names(x)[2]){
  
  x <- na.omit(x)
  
  if ((is.character(x[[1]])) | (is.character(x[[2]]))) {
  if (!is.character(x[[1]])){
    x <- x[c(2,1)]
    }}
  
  else if ((is.factor(x[[1]])) | (is.factor(x[[2]]))) {
  if (!is.factor(x[[1]])){
    x <- x[c(2,1)]
  } 
  }
  
  
# 1) –ó–∞–¥–∞—á–∞: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑:
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Ppb (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–æ—á–µ—á–Ω–æ-–±–∏—Å–µ—Ä–∏–∞–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Ppb);
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œ∑2  (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2).
#
#    -/–û–ë–©–ê–Ø –¢–ï–û–†–ò–Ø/-
#    –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–æ–≥—É—Ç —Å–≤—è–∑—ã–≤–∞—Ç—å –Ω–µ —Ç–æ–ª—å–∫–æ –ø–∞—Ä—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —á—å–∏ —à–∫–∞–ª—ã
#    –∏–º–µ—é—Ç –û–î–ò–ù–ê–ö–û–í–£–Æ –º–æ—â–Ω–æ—Å—Ç—å, –Ω–æ –∏ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –¥–≤—É—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö, —á—å—è –º–æ—â–Ω–æ—Å—Ç—å —à–∫–∞–ª –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç
#   
#    –ú–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–¥–∞—á–∞ –ü–†–ï–î–°–ö–ê–ó–´–í–ê–¢–¨ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–π –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö 
#    –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –≤—Ç–æ—Ä–æ–π. –î–ª—è —ç—Ç–æ–≥–æ –≤ —Å—Ç–∞—Ç. –∞–Ω–∞–ª–∏–∑–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ 
#    –¥–æ–ø–æ–ª–Ω—è—è –¥–∞–Ω–Ω—ã–µ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π, –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–ª—É—á–∞—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. 
#       
#    –ï—Å—Ç—å –¥–≤–∞ —Ç–∞–∫–∏—Ö –±–∞–∑–æ–≤—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞: 
#    ‚Ä¢ –º–æ–¥–µ–ª—å –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞; 
#    ‚Ä¢ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å.
#            
#    –ú–æ–¥–µ–ª–∏ ¬´–¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ¬ª –∏ ¬´—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ¬ª –∞–Ω–∞–ª–∏–∑–∞ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ
#    –ø—Ä–∏–Ω—Ü–∏–ø–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–æ—Ç–∫–ª–∏–∫–∞) –Ω–∞ –¥–≤–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ:            
#    ‚Ä¢ —ç—Ñ—Ñ–µ–∫—Ç, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —Ñ–∞–∫—Ç–æ—Ä–æ–º (–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º), 
#    ‚Ä¢ –∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏. –û–±–µ —ç—Ç–∏ –º–æ–¥–µ–ª–∏ ‚Äî —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–∏ —Ç.–Ω. –æ–±—â–µ–π –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏    
#
#  
#    1) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–æ—á–µ—á–Ω–æ-–±–∏—Å–µ—Ä–∏–∞–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Ppb  
#       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ
#       –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ Ppb –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ p –ü–∏—Ä—Å–æ–Ω–∞ 
#       –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –æ–¥–Ω–∞ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–π —à–∫–∞–ª–µ 
#       –∏–ª–∏ –≤ —à–∫–∞–ª–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–π, –∞ –¥—Ä—É–≥–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è - –≤ –±–∏–Ω–∞—Ä–Ω–æ–π —à–∫–∞–ª–µ.
#        
#       –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –æ–Ω –Ω–µ —Ç–∞–∫ —É–¥–æ–±–µ–Ω –≤ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏, –∫–∞–∫ œÅ, –ø–æ—Å–∫–æ–ª—å–∫—É –µ–≥–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è 
#       –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–µ–Ω—å—à–µ 0.9 –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–Ω–∏–∂–∞–µ—Ç—Å—è  –ø–æ –º–µ—Ä–µ 
#       —Ç–æ–≥–æ, –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –±–∏–Ω–∞—Ä–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π —É–¥–∞–ª—è–µ—Ç—Å—è –æ—Ç —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–≥–æ.

#       –ü–µ—Ä–µ–≤–µ–¥–µ–º –Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Ñ–∞–∫—Ç–æ—Ä—ã, —Ç.–∫.
#       –Ω–µ —Å–º–æ–∂–µ–º –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Å–∏–º–≤–æ–ª—å–Ω—ã–º —Ç–∏–ø–æ–º:
        x[[1]] <- factor(x[[1]])

#       1.1) –î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏, –ø–µ—Ä–µ–≤–µ–¥–µ–º —Ñ–∞–∫—Ç–æ—Ä–Ω—ã–π —Ç–∏–ø –≤ —á–∏—Å–ª–æ–≤–æ–π:
#            –¢.–∫. –ø–æ –∑–∞–¥–∞–Ω–∏—é –Ω—É–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–ª–∏—á–∏–µ —Ä–∞–∑–ª–∏—á–∏–µ 
        
#                 –º–µ–∂–¥—É –≤–∞—Ä–∏–∞–Ω—Ç–∞–º–∏ A –∏ B, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –¥–≤–µ –≥—Ä–∞–¥–∞—Ü–∏–∏   
#                 –≤ –Ω—É–ª–∏ –∏ –µ–¥–∏–Ω–∏—Ü—ã, –∞ —Ç—Ä–µ—Ç—å—é (–µ—Å–ª–∏ –µ—Å—Ç—å) –≥—Ä–∞–¥–∞—Ü–∏—é –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ –∞–Ω–∞–ª–∏–∑–∞. 
#     
#                 –î–ª—è —ç—Ç–æ–≥–æ —Å–æ–∑–¥–∞–¥–∏–º –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∫–æ–ø–∏—é —Ç–∞–±–ª–∏—Ü—ã –¥–∞–Ω–Ω—ã—Ö,
#                 —Ç.–∫. –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —Å —Ç—Ä–µ–º —É—Ä–æ–≤–Ω—è–º–∏ –º–æ–∂–µ—Ç –µ—â–µ –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è:         
                  x_Ppb <- x
                  # length(levels(x[[1]]))
                  # if (length(levels(x[[1]]))>2){
                  # a <- c(0:(length(levels(x[[1]]))-1))
                  # for (i in 3:length(levels(x[[1]]))){a[i]<-NA}
                  # levels(x_Ppb[[1]]) <- a
                  # }else {levels(x_Ppb[[1]]) <- c(0,1)}
             
#       1.2) –ú—ã –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞–ª–∏ –≤ —Ü–∏—Ñ—Ä—ã —Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–µ –¥–≤–µ (–ø–æ –∞–ª—Ñ–∞–≤–∏—Ç—É) –≥—Ä–∞–¥–∞—Ü–∏–∏, 
#            –∞ —Ç—Ä–µ—Ç—å—é –≥—Ä–∞–¥–∞—Ü–∏—é –ø–µ—Ä–µ–≤–µ–ª–∏ –≤ NA - –≤ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è. 
#            –û–¥–Ω–∞–∫–æ –ø—Ä–∏ —ç—Ç–æ–º –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –Ω–æ–º–∏–Ω–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Ñ–∞–∫—Ç–æ—Ä–∞. 
#            –î–ª—è –µ—ë –ø–µ—Ä–µ–≤–æ–¥–∞ –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ—É–Ω–∫—Ü–∏—é as.numeric():

             x_Ppb[[1]] <- as.numeric(x_Ppb[[1]])  # –ø–µ—Ä–µ–≤–æ–¥ —Ñ–∞–∫—Ç–æ—Ä–∞ –≤ —á–∏—Å–ª–æ–≤–æ–π —Ñ–æ—Ä–º–∞—Ç

#       1.3) –¢.–∫. –º—ã –∏—Å–∫–ª—é—á–∏–ª–∏ —Ç—Ä–µ—Ç—å—é –≥—Ä–∞–¥–∞—Ü–∏—é, –Ω—É–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–µ–π –¥–∞–Ω–Ω—ã–µ:
             colSums(is.na(x_Ppb)) # –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
             x_Ppb <- na.omit(x_Ppb)
             
#       1.4) –¢.–∫. –≤—ã—à–µ –ø–∏—Å–∞–ª–æ—Å—å, —á—Ç–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ Ppb - —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ p –ü–∏—Ä—Å–æ–Ω–∞,
#            —Ç–æ–ª—å–∫–æ —Å –∫–æ–≥–¥–∞ –æ–¥–Ω–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –≤ –±–∏–Ω–∞—Ä–Ω–æ–π, –¥—Ä—É–≥–∞—è –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–π/–æ—Ç–Ω–æ—à–µ–Ω–∏–π, —Ç–æ
#            –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ–±—ã—á–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø–æ–∏—Å–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ü–∏—Ä—Å–æ–Ω–∞:                 

#                     N  (X·µ¢ - Œº‚Çì) (y·µ¢ - Œº·µß)    N                       |   -/–ö—Ä–∞—Ç–∫–æ –æ "œÅ –ü–∏—Ä—Å–æ–Ω–∞"/- 
#                     Œ£  ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî    Œ£  (X·µ¢ - Œº‚Çì)(y·µ¢ - Œº·µß)   |   -------------------------------
#                    i=1    œÉx        œÉy       i=1                      |   –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ = "1"  (–ø–æ–ª–Ω–∞—è –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è);
#            P x,y = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî   |   –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ  –∑–Ω–∞—á–µ–Ω–∏–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ = "‚àí1" (–ø–æ–ª–Ω–∞—è –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è –ª–∏–Ω–µ–π–Ω–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è);
#                               N                     N œÉx œÉy           |   —Å—Ä–µ–¥–Ω–µ–µ      –∑–Ω–∞—á–µ–Ω–∏–µ œÅ –ü–∏—Ä—Å–æ–Ω–∞ = "0"  (–æ—Ç—Å—É—Ç—Å–≤–∏–µ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏).
             P.Pearson <- function(x.table)
             {
               x.table <- na.omit(x.table)
               sd_x    <- sqrt(sum((x.table[[1]] - mean(x.table[[1]]))^2)/nrow(x.table))
               sd_y    <- sqrt(sum((x.table[[2]] - mean(x.table[[2]]))^2)/nrow(x.table))
               Œ£       <- sum((x.table[[1]]-mean(x.table[[1]]))*(x.table[[2]]-mean(x.table[[2]])))
               N.œÉx.œÉy <- nrow(x.table)*sd_x*sd_y
               return(Œ£/N.œÉx.œÉy)
             }

#            –û—Ç–≤–µ—Ç:
             Ppb <- P.Pearson(x_Ppb)

#    2) –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2  (–¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑) (ANOVA)
#       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ          
#       –î–ª—è –æ–ø–∏—Å–∞–Ω–∏—è —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑–ª–∏—á–∞–µ—Ç—Å—è –∑–Ω–∞—á–µ–Ω–∏—è –Ω–µ —Å –¥–≤—É—Ö –≥—Ä–∞–¥–∞—Ü–∏–π, –∞ –°–û –í–°–ï–• 
#       —Ç—Ä—ë—Ö –≥—Ä–∞–¥–∞—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2.
#    
#       –°—É—Ç—å –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –≤ —Ç–æ–º, —á—Ç–æ —Ö–æ—Ç–∏–º "—Å—Ä–∞–≤–Ω–∏—Ç—å —Ä–∞–∑–±—Ä–æ—Å —Å—Ä–µ–¥–Ω–∏—Ö", —Ç.–µ. –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ 2, 
#       –Ω–∞—Å –º–æ–≥—É—Ç –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ä–∞–∑–±—Ä–æ—Å—ã –≥—Ä—É–ø–ø–æ–≤—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö (–æ—Ç–º–µ—á–µ–Ω–Ω—ã–µ —Å—Ç—Ä–µ–ª–∫–∞–º–∏ ‚Üë‚Üì) 
#       –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—â–µ–≥–æ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–±—Ä–æ—Å–∞ (–ª–∏–Ω–∏—è –ø–æ —Ü–µ–Ω—Ç—Ä—É).
#       
#                 –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–∑–º–∞—Ö–æ–≤ 1                 –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞–∑–º–∞—Ö–æ–≤ 2     
#               ________________________             ________________________                   
#         10.0 |                        |      10.0 |                        |                         
#              |                        |           |                        |                        
#              |           *            |           |           *‚Üë           |                         
#          7.5 |                        |       7.5 |            ‚Üì           |                         
#              |           *      *     |           |          ‚Üë*      *‚Üë    |                         
#              |                        |           |          ‚Üì        ‚Üì    |                        
#       Y    5 |           *      *     |     Y   5 |‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî-*‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî*‚Äî‚Äî‚Äî‚Äî‚Äî|                         
#              |     *                  |           |     *‚Üë            ‚Üë    |                         
#              |                  *     |           |      ‚Üì           *‚Üì    |                         
#          2.5 |     *                  |       2.5 |     *                  |                              
#              |                        |           |                        |                                 
#              |     *                  |           |     *                  |                       
#            0 |                        |         0 |                        |                                 
#               ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ             ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ                          
#                    A     B      C                        A     B      C                                  
#                                                                                                          
#                          X                                     X   
#             
#       –ú–µ—Ä–∞ —Å–≤—è–∑–∏ (—ç—Ç—Ç–∞): –≤ –¥–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—É–ª–µ –¥–∏—Å–ø–µ—Ä—Å–∏—è —ç—Ñ—Ñ–µ–∫—Ç–∞ –¥–µ–ª–∏—Ç—å—Å—è –Ω–∞ –æ–±—â—É—é –¥–∏—Å–ø–µ—Ä—Å–∏—é,
#       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ  —Ç.–µ. —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –ù–ï —Ä–∞–∑–±—Ä–æ—Å —Å—Ä–µ–¥–Ω–∏—Ö —Å —Ä–∞–∑–±—Ä–æ—Å–æ–º –≤–Ω—É—Ç—Ä–∏ –∫–∞–∂–¥–æ–π –≥—Ä—É–ø–ø—ã,
#                          –∞ –ø—Ä–æ—Å—Ç–æ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º —Ä–∞–∑–±—Ä–æ—Å —Å—Ä–µ–¥–Ω–∏—Ö —Å –û–ë–©–ò–ú —Ä–∞–∑–±—Ä–æ—Å–æ–º (–æ–±—â–µ–π –¥–∏—Å–ø–µ—Ä—Å–∏–µ–π).                
#             k                                                   
#             Œ£  n_j(Œº_j - Œº_total)¬≤                     | –≥–¥–µ:         
#            j=1                          SS_effect      | ‚Ä¢ k   - —á–∏—Å–ª–æ –≥—Ä—É–ø–ø; 
#       Œ∑¬≤ = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî  =  ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî     | ‚Ä¢ n_j - —á–∏—Å–ª–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –≤ j-—Ç–æ–π –≥—Ä—É–ø–ø–µ;
#             N                           SS_total       | ‚Ä¢ Œº_j - –≥—Ä—É–ø–ø–æ–≤–æ–µ —Å—Ä–µ–¥–Ω–µ–µ;
#             Œ£    (X_i - Œº_total)¬≤                      | ‚Ä¢ Œº_total - –æ–±—â–µ–µ —Å—Ä–µ–¥–Ω–µ–µ;
#            i=1                                         | ‚Ä¢ X_i - –≤—Å–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ –≤—Å–µ–º –≥—Ä—É–ø–ø–∞–º;

#       2.1) –î–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2 
#            –Ω–∞—á–Ω—ë–º —Å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è ¬´–≥—Ä—É–ø–ø–æ–≤—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö¬ª.

#            –ü–µ—Ä–µ–∫–æ–¥–∏—Ä—É–µ–º –≤—Å–µ 3 –≥—Ä–∞–¥–∞—Ü–∏–∏ (–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û):
             x_Œ∑2 <- x
             # levels(x_Œ∑2[[1]]) <- c(0, 1, 2)

#            -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-
#            –ü–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è, —Ç.–∫. —É—Ä–æ–≤–Ω–∏,
#            –Ω–∞–ø—Ä–∏–º–µ—Ä, "A","B","C" –∏ —Ç–∞–∫ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É—é—Ç —á–∏—Å–ª–æ–≤—ã–º 
#            –∑–Ω–∞—á–µ–Ω–∏—è–º "1","2","3" –∏ –º–æ–∂–Ω–æ —Å –Ω–∏–º–∏ –≤—Å–µ –ø–æ—Å—á–∏—Ç–∞—Ç—å. 

#            –û—á–∏—Å—Ç–∏–º –¥–∞–Ω–Ω—ã–µ –æ—Ç ¬´NA¬ª:
             x_Œ∑2 <- na.omit(x_Œ∑2)
             
#            –°—Ä–µ–¥–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º:        
             x_Œ∑2.grp.mean <- tapply(x_Œ∑2[[2]], x_Œ∑2[[1]], FUN = mean) 
             cat("–°—Ä–µ–¥–Ω–∏–µ –ø–æ –≥—Ä—É–ø–ø–∞–º:\n"); print(x_Œ∑2.grp.mean); cat("\n")
             
#       2.2) –î–∞–ª–µ–µ –Ω–∞–π–¥—ë–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è ¬´–≥—Ä—É–ø–ø–æ–≤—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö¬ª –æ—Ç ¬´–æ–±—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ¬ª:
             x_Œ∑2.grp.dev <- (x_Œ∑2.grp.mean  -  mean(x_Œ∑2.grp.mean))
             cat("–û—Ç–∫–ª–æ–Ω–µ–Ω–∏—è ¬´–≥—Ä—É–ø–ø–æ–≤—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö¬ª –æ—Ç ¬´–æ–±—â–µ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ¬ª:\n"); print(x_Œ∑2.grp.dev); cat("\n")
             
#       2.3) –¢–µ–ø–µ—Ä—å –Ω–∞–º –Ω—É–∂–Ω–æ —Å–ª–æ–∂–∏—Ç—å –∫–≤–∞–¥—Ä–∞—Ç—ã —ç—Ç–∏—Ö –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π, –ø–æ—Å—á–∏—Ç–∞–≤ 
#            –∫–≤–∞–¥—Ä–∞—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –≥—Ä—É–ø–ø–æ–≤–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ —Å—Ç–æ–ª—å–∫–æ —Ä–∞–∑, 
#            —Å–∫–æ–ª—å–∫–æ –≤ –¥–∞–Ω–Ω–æ–π –≥—Ä—É–ø–ø–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π. –î—Ä—É–≥–∏–º–∏ —Å–ª–æ–≤–∞–º–∏, –ø–µ—Ä–µ–¥ 
#            —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∫–∞–∂–¥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ grp.dev, –≤–æ–∑–≤–µ–¥—ë–Ω–Ω–æ–µ –≤ –∫–≤–∞–¥—Ä–∞—Ç, 
#            –Ω—É–∂–Ω–æ —É–º–Ω–æ–∂–∏—Ç—å –Ω–∞ —á–∞—Å—Ç–æ—Ç—É —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–≥–æ —É—Ä–æ–≤–Ω—è —Ñ–∞–∫—Ç–æ—Ä–∞.

             SS_effect <- sum((x_Œ∑2.grp.dev^2)*table(x_Œ∑2[[1]]))

#            –í—ã—á–∏—Å–ª–∏–º –æ–±—â—É—é —Å—É–º–º—É –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π:
             SS_total <- sum((x_Œ∑2[[2]] - mean(x_Œ∑2.grp.mean))^2)

#            –ù–∞–π–¥–µ–º —á–∞—Å—Ç–Ω–æ–µ –¥–≤—É—Ö —Å—É–º–º:
             Œ∑2 <- SS_effect/SS_total
             
#            -/–û–ü–¶–ò–û–ù–ê–õ–¨–ù–û/-
#            –ú–æ–∂–µ–º –Ω–∞–π—Ç–∏ —Å–ª—É—á–π–Ω—É—é —Å–æ—Å—Ç–∞–≤–ª—è—é—â—É—é, –ø–æ–¥—Ä–æ–±–Ω–µ–µ https://online.stat.psu.edu/stat415/lesson/13/13.2
             SS_residual <- SS_total - SS_effect


# 3) –ü–æ—Å—Ç—Ä–æ–∏–º –ø–æ —Ç–∞–±–ª–∏—Ü–µ –¥–∞–Ω–Ω—ã—Ö –¥–∏–∞–≥—Ä–∞–º–º—É —Ä–∞–∑–º–∞—Ö–æ–≤.
     plot(x,
          main = main.plot,
          xlab = xlab.plot,
          ylab = ylab.plot,
          col = "papayawhip",)
     points(x_Œ∑2.grp.mean,  # - –Ω–∞–Ω–æ—Å–∏–º —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
            pch = 16,       # - —Å–∏–º–≤–æ–ª —Ç–æ—á–∫–µ –≤ –≤–∏–¥–µ —Å–ø–ª–æ—à–Ω–æ–≥–æ –∫—Ä—É–∂–∫–∞
            cex = 2)        # - —Ä–∞–∑–º–µ—Ä
     
     
     
     
# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:

#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è 


 if  (abs(Ppb) <  0.02)                         {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
 if ((abs(Ppb) >= 0.02) & (abs(Ppb) < 0.13))    {power.com <- "—Å–ª–∞–±–∞—è"     }
 if ((abs(Ppb) >= 0.13) & (abs(Ppb) < 0.26))    {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
 if  (abs(Ppb) >= 0.26)                         {power.com <- "—Ç–µ—Å–Ω–∞—è"     }
 
     
 if  (abs(Œ∑2) <  0.02)                         {power1.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
 if ((abs(Œ∑2) >= 0.02) & (abs(Œ∑2) < 0.13))     {power1.com <- "—Å–ª–∞–±–∞—è"     }
 if ((abs(Œ∑2) >= 0.13) & (abs(Œ∑2) < 0.26))     {power1.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  } 
 if  (abs(Œ∑2) >= 0.26)                         {power1.com <- "—Ç–µ—Å–Ω–∞—è"     }


cat('\n–°–∏–ª–∞ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏:', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m',
    '–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m', ":"                ,"\n")

#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Ppb (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–æ—á–µ—á–Ω–æ-–±–∏—Å–µ—Ä–∏–∞–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Ppb);
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œ∑2  (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2).
cat("---------------------------------------------------------------"           ,"\n")
cat("a) \033[34m–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã:\033[0m"                                           ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                           ,"\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–æ—á–µ—á–Ω–æ-–±–∏—Å–µ—Ä–∏–∞–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Ppb:", Ppb                ,"\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏      Œ∑2 :", Œ∑2                 ,"\n")
cat("---------------------------------------------------------------"           ,"\n")
cat("–±) \033[34m–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\033[0m"                                  ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                  ,"\n")
cat("   ‚Ä¢ –æ–±—â–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤       SS_total           :", SS_total           ,"\n")
cat("   ‚Ä¢ –º–µ–∂–≥—Ä—É–ø–ø–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤  SS_effect          :", SS_effect          ,"\n")
cat("   ‚Ä¢ —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤    SS_residual        :", SS_residual        ,"\n")
cat("---------------------------------------------------------------"           ,"\n")
cat("–≤) \033[34m–î–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:\033[0m"                ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                ,"\n")
M <- lm(x[[2]] ~ x[[1]], data = x);
M <- anova(M); M <- t(M); M <- as.data.frame(M);
M[[3]] <- c(sum(c(M[1,1],c(M[1,2]))), sum(c(M[2,1],c(M[2,2]))), NA, NA, NA) 
names(M) <- c("Factor", "Error", "Total"); M <- t(M)
print(M)
cat("\n   –≥–¥–µ:\n")
cat("   ‚Ä¢ DF - —Å—Ç–µ–ø–µ–Ω—å —Å–≤–æ–±–æ–¥—ã;           \n")
cat("   ‚Ä¢ SS - —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤;           \n")
cat("   ‚Ä¢ MS - —Å—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤:   \n")
cat("   ‚Ä¢ F  - F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞;              \n")
cat("   ‚Ä¢ P  - P-–∑–Ω–∞—á–µ–Ω–∏–µ.              \n\n")

cat("---------------------------------------------------------------"           ,"\n")
cat("‚Ä¢ –í—ã–≤–æ–¥: 1) (Ppb) –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0m', "—Å–≤—è–∑—å", 
    '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[0m',
    "—Å",          
    '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[0m'                            ,"\n")
                 
                   
cat("‚Ä¢           (Œ∑2)  –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power1.com ,'\033[0m', "—Å–≤—è–∑—å", 
    '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[0m',
    "—Å",
    '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[0m'                            ,"\n")

cat("---------------------------------------------------------------"           ,"\n")
}



Anova.regr <- function(x, CL=90, inverse=FALSE, main.plot="–î–∏–∞–≥—Ä–∞–º–º–∞", xlab.plot = names(x)[1], ylab.plot = names(x)[2])
{
  # inverse - –º–µ–Ω—è–µ—Ç —Å—Ç–æ–ª–±—Ü—ã –º–µ—Å—Ç–∞–º–∏
  
  if (inverse==TRUE){x <- data.frame(x[2], x[1])}
  

  
  
# –†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å:
# ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ       
# 1) –ó–∞–¥–∞—á–∞: –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã—Ö —Å–∏–ª—å–Ω–æ —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑:
#    ‚Ä¢ –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ Œ≤1;
#    ‚Ä¢ –í–≤–µ–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ Œ≤0;
#    ‚Ä¢ –û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ö–æ—Ä–æ—à–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
#      –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –¥—Ä—É–≥–æ–π, —á–µ—Ä–µ–∑ R2.  
#
#    -/–û–ë–©–ê–Ø –¢–ï–û–†–ò–Ø/-         
#    –í —Ä–∞–º–∫–∞—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å 
#    –ü–†–ï–î–°–ö–ê–ó–´–í–ê–¢–¨ –∑–Ω–∞—á–µ–Ω–∏—è –æ–¥–Ω–æ–π –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ –∑–Ω–∞—á–µ–Ω–∏—è–º –¥—Ä—É–≥–æ–π, –ø–æ—ç—Ç–æ–º—É:
#    ‚Ä¢ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é-‚Äú—Ñ–∞–∫—Ç–æ—Ä‚Äù    - –ø—Ä–∏–Ω—è—Ç–æ –Ω–∞–∑—ã–≤–∞—Ç—å ¬´–ü–†–ï–î–ò–ö–¢–û–†¬ª (predictor), 
#    ‚Ä¢ ‚Äú–∑–∞–≤–∏—Å–∏–º—É—é‚Äù –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é - –ø—Ä–∏–Ω—è—Ç–æ –Ω–∞–∑—ã–≤–∞—Ç—å ¬´–û–¢–ö–õ–ò–ö¬ª (response variable).

#    ‚Ä¢ –ü—Ä–∏ –î–í–£–ú–ï–†–ù–´–• –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—å –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–ø—Ä–æ—Å—Ç–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π¬ª, –≤ –Ω–µ–π:
#      o  –æ–¥–∏–Ω –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä - ‚Äú—Ñ–∞–∫—Ç–æ—Ä‚Äù;         ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ
#      o  –æ–¥–∏–Ω –æ—Ç–∫–ª–∏–∫    - ‚Äú–∑–∞–≤–∏—Å–∏–º–∞—è‚Äù –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è.

#    ‚Ä¢ –ü—Ä–∏ –ú–ù–û–ì–û–ú–ï–†–ù–´–• –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª—å –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π¬ª, –≤ –Ω–µ–π:
#      o  –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ–º–µ–Ω—ã—Ö –ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–≤;     ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ

#    -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-
#    –í –æ—Ç–ª–∏—á–∏–∏ –æ—Ç –∑–∞–¥–∞–Ω–∏—è —Å –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º, –∑–¥–µ—Å—å
#    –æ–±–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç—Ä–∏—á–µ—Å–∫–∏–µ, –Ω–æ –º–µ—Ä–∞ —Å–≤—è–∑–∏ –ø–æ –ø—Ä–µ–∂–Ω–µ–º—É
#    –±—É–¥–µ—Ç —Å–ª—É–∂–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç  Œ∑2 ‚Äî —Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π 
#    –ø—Ä–∏–Ω—Ü–∏–ø–∏–∞–ª—å–Ω–æ –Ω–∏—á–µ–≥–æ –Ω–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è, —Ç–æ–ª—å–∫–æ –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –Ω–∞–∑—ã–≤–∞—Ç—å—Å—è 
#    —É–∂–µ –Ω–µ –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–º, –∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–º –∞–Ω–∞–ª–∏–∑–æ–º.                   
     
#    2) –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ R¬≤:
#       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ   
#       –ú–æ–¥–µ–ª–∏ ¬´–¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ¬ª –∏ ¬´—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ¬ª –∞–Ω–∞–ª–∏–∑–∞ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ
#       –ø—Ä–∏–Ω—Ü–∏–ø–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏—è –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (–æ—Ç–∫–ª–∏–∫–∞) –Ω–∞ –¥–≤–µ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏–µ:            
#       ‚Ä¢ —ç—Ñ—Ñ–µ–∫—Ç, —Å–≤—è–∑–∞–Ω–Ω—ã–π —Å —Ñ–∞–∫—Ç–æ—Ä–æ–º (–ø—Ä–µ–¥–∏–∫—Ç–æ—Ä–æ–º), 
#       ‚Ä¢ –∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã–µ –æ—Å—Ç–∞—Ç–∫–∏. –û–±–µ —ç—Ç–∏ –º–æ–¥–µ–ª–∏ ‚Äî —Ä–∞–∑–Ω–æ–≤–∏–¥–Ω–æ—Å—Ç–∏ —Ç.–Ω. –æ–±—â–µ–π –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏    
#           
#       –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –º–µ—Ä—ã —Å–≤—è–∑–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤ –º–æ–¥–µ–ª–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –º—ã 
#       –º–æ–∂–µ–º –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–µ–º, —á—Ç–æ –≤ –ª–∏–Ω–µ–π–Ω–æ–π –º–æ–¥–µ–ª–∏ –æ–±—â–∞—è –¥–∏—Å–ø–µ—Ä—Å–∏—è 
#       –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π-–æ—Ç–∫–ª–∏–∫–∞ —Ä–∞–≤–Ω–∞ —Å—É–º–º–µ –¥–∏—Å–ø–µ—Ä—Å–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∞ –∏ –æ—Å—Ç–∞—Ç–∫–æ–≤:
#       œÉ¬≤_total = œÉ¬≤_effect + œÉ¬≤_residual
#       –°–æ–æ—Ç–≤–µ—Å—Ç–≤–µ–Ω–Ω–æ, –º—ã –º–æ–∂–µ–º –≤—ã—á–∏—Å–ª–∏—Ç—å Œ∑2 –¥–≤—É–º—è —Å–ø–æ—Å–æ–±–∞–º–∏:
#       
#               SS_effect        SS_residual
#       Œ∑2  =   ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî  = 1 - ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî   
#               SS__total         SS__total
#                                 
#       -/–í–ê–ñ–ù–û/-
#       ‚Ä¢ –î–ª—è ¬´–¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω–æ–≥–æ¬ª —Å–ø–æ—Å–æ–±–∞ - —Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ SS_effect, —Ç.–∫. –µ—Å—Ç—å —Ñ–∞–∫—Ç–æ—Ä—ã (–µ—Å—Ç—å –≥—Ä—É–ø–ø—ã)
#       ‚Ä¢ –î–ª—è ¬´—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–≥–æ¬ª —Å–ø–æ—Å–æ–±–∞ - —Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ SS_residual - —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤
#       –¢.–∫. –≤ ¬´—Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–º¬ª –∞–Ω–∞–ª–∏–∑–µ –≥—Ä—É–ø–ø –ù–ï–¢, –≤ –Ω–µ–º –º–µ—Ä–∞ —Å–≤—è–∑–∏ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è
#       –ù–ï ¬´–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2¬ª, - –∞ ¬´–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ R¬≤¬ª
#                SS_residual
#       R¬≤ = 1 - ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî   
#                 SS__total  
#       -/–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ/-          
#       –í —Å–ª—É—á–∞–µ –õ–ò–ù–ï–ô–ù–û–ô —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∫–æ—ç—Ñ. R¬≤ –º–æ–∂–Ω–æ –≤—ã—á–∏–ª—Å—Ç—å –µ—â–µ R¬≤=p¬≤, –≥–¥–µ p - –∫–æ—ç—Ñ. –ª–∏–Ω–µ–π–Ω. –∫–æ—Ä. –ü–∏—Ä—Å–æ–Ω–∞.     

#       2.1) –ß–µ—Ä–µ–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–∞–π–¥–µ–º —Å—É–º–º—ã –∫–≤–∞–¥—Ä–∞—Ç–æ–≤:
               M <- lm(x[[1]] ~ x[[2]], data = x);
               M <- anova(M); M <- t(M); M <- as.data.frame(M);
               M[[3]] <- c(sum(c(M[1,1],c(M[1,2]))), sum(c(M[2,1],c(M[2,2]))), NA, NA, NA) 
               names(M) <- c("Factor", "Error", "Total"); M <- t(M)
               
#       2.2) –ü–æ–ª—É—á–∏–º —Å–ª–µ–¥—É—é—â–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
               SS_effect    <- M[4]
               SS_residual <- M[5]
               SS_total    <- M[6]
               R2 <- 1 - (SS_residual/SS_total);  R2
               
#       2.3) –ö–∞–∫ –≤—ã—à–µ –±—ã–ª–æ —Å–∫–∞–∑–∞–Ω–æ, R2 –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ç–∞–∫–∂–µ —á–µ—Ä–µ–∑ –ª–∏–Ω.–∫–æ—ç—Ñ—Ñ.–∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ p –ü–∏—Ä—Å–æ–Ω–∞:               
               P.Pearson <- function(x.table)
               {
                 x.table <- na.omit(x.table)
                 sd_x    <- sqrt(sum((x.table[[1]] - mean(x.table[[1]]))^2)/nrow(x.table))
                 sd_y    <- sqrt(sum((x.table[[2]] - mean(x.table[[2]]))^2)/nrow(x.table))
                 Œ£       <- sum((x.table[[1]]-mean(x.table[[1]]))*(x.table[[2]]-mean(x.table[[2]])))
                 N.œÉx.œÉy <- nrow(x.table)*sd_x*sd_y
                 return(Œ£/N.œÉx.œÉy)
               }
#              –ü–æ–ª—É—á–∏–ª–∏ —Ç–æ—Ç –∂–µ —Å–∞–º—ã–π –æ—Ç–≤–µ—Ç:
               P <- P.Pearson(x); P 
               R2 <- P^2; R2

#    3) –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
#       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ     
#       –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —á–µ—Ä–µ–∑ –æ–±–ª–∞–∫–æ —Ä–∞—Å—Å–µ—è–Ω–∏—è. 
#       –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–±: –ª–∏–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã–µ 
#       (–º–æ–¥–µ–ª—å ‚Äú–ø–æ–¥–≥–æ–Ω—è–µ—Ç—Å—è‚Äù) —Ç–∞–∫, —á—Ç–æ–±—ã –æ—Å—Ç–∞—Ç–∫–∏ (–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π-–æ—Ç–∫–ª–∏–∫–∞)
#       –æ—Ç —ç—Ç–æ–π –ª–∏–Ω–∏–∏, –æ–∫–∞–∑–∞–ª–∏—Å—å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏. 
#       –¢–æ—á–Ω–µ–µ, –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∫–≤–∞–¥—Ä–∞—Ç—ã –æ—Å—Ç–∞—Ç–∫–æ–≤ (—Å—É–º–º–∞ —ç—Ç–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤) ‚Äî 
#       —Ç–∞–∫–æ–π —Å–ø–æ—Å–æ–± –ø–æ–¥–≥–æ–Ω–∫–∏ –º–æ–¥–µ–ª–∏ –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–º–µ—Ç–æ–¥–æ–º –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤¬ª.
#                                              ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ               
#       –ü–æ —Å—É—Ç–∏ –¥–µ–ª–∞, –ø–æ—Å—Ç—Ä–æ–∏—Ç—å, –∏–ª–∏ –ø–æ–¥–æ–≥–Ω–∞—Ç—å —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—É—é –º–æ–¥–µ–ª—å: 
#       –Ω–∞–π—Ç–∏ –µ—ë –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã, Œ≤1 –∏ Œ≤0 –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. 
#              
#                      | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œ≤1 –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞ –ª–∏–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.
#              œÉ_Y     | p - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞.      
#       Œ≤1 = p ‚Äî‚Äî‚Äî     |              
#              œÉ_X     |   
#                            | –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œ≤0 ‚Äî —Å–≤–æ–±–æ–¥–Ω—ã–π —á–ª–µ–Ω, –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, –∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç 
#                            | –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∑–Ω–∞—á–µ–Ω–∏–µ Yi –ø—Ä–∏ Xi = 0, —Ç.–µ —Ç–æ—á–∫—É "–æ—Å–∏ y" 
#       Œ≤0 = Œº_Y - (Œ≤1*Œº_X)  | –≤ –º–µ—Å—Ç–µ –µ—ë –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è (intercept) –ª–∏–Ω–∏–µ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏           
#                            | –≤–µ–ª–∏—á–∏–Ω—É —Å–¥–≤–∏–≥–∞ –≤—Å–µ–π –ª–∏–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –ø–æ –æ—Å–∏ y –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π                    
#                            | –ø—Ä—è–º–æ–π, –ø—Ä–æ—Ö–æ–¥—è—â–µ–π —á–µ—Ä–µ–∑ –Ω–∞—á–∞–ª–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç. 
#       
#               
#       3.1) –ù–∞–π–¥–µ–º —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è:
             œÉ_X <- sqrt(sum((x[[1]] - mean(x[[1]]))^2)/length(x[[1]]))
             œÉ_Y <- sqrt(sum((x[[2]] - mean(x[[2]]))^2)/length(x[[2]])) 
              
#       3.2) –û–ø—Ä–µ–¥–µ–ª–∏–º —É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞ –ª–∏–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:
             Œ≤1  <- P*(œÉ_Y/œÉ_X) 

#       3.3) –û–ø—Ä–µ–¥–µ–ª–∏–º –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É, –≤–µ–ª–∏—á–∏–Ω—É —Å–¥–≤–∏–≥–∞ –≤—Å–µ–π –ª–∏–Ω–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ 
#            –ø–æ –æ—Å–∏ y –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –ø—Ä—è–º–æ–π:
             Œº_X <- mean(x[[1]])
             Œº_Y <- mean(x[[2]])
             
             Œ≤0 = Œº_Y - (Œ≤1*Œº_X)

#    4) –ì—Ä–∞—Ñ–∏–∫:
#       ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ    
#       4.1) –ü–æ—Å—Ç—Ä–æ–∏–º –≥—Ä–∞—Ñ–∏–∫:
             plot(x,           
                  main = main.plot,
                  xlab = xlab.plot,
                  ylab = ylab.plot,) 
             
#       4.2) –ù–∞–Ω–µ—Å–µ–º –ª–∏–Ω–∏—é —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ x_Y –Ω–∞ x_X:               
             abline(Œ≤0, Œ≤1, col = "steel blue")
             
#       4.3) –ù–∞–Ω–µ—Å–µ–º –ª–∏–Ω–∏—é —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ x_Y –Ω–∞ x_X:               
             Œ≤1.yx  <- P*(œÉ_X/œÉ_Y) #???
             Œ≤1.inverse <- 1/Œ≤1.yx  # –∑–∞–º–µ–Ω–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–∞ –æ–±—Ä–∞—Ç–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É
             Œ≤0.inverse <- Œº_Y - (Œ≤1.inverse*Œº_X)  # –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ —á–ª–µ–Ω–∞
             abline(Œ≤0.inverse, Œ≤1.inverse, col = 'maroon', lty = 'dotted')  # –ø—É–Ω–∫—Ç–∏—Ä
             
#       4.4) –ù–∞–Ω–µ—Å–µ–º –ª–∏–Ω–∏—é —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ x_Y –Ω–∞ x_X:    
             Œ≤1.inverse <- 1/Œ≤1  
             Œ≤0.inverse <- Œº_Y - (Œ≤1.inverse*Œº_X)
             abline(Œ≤0.inverse, Œ≤1.inverse, col = 'green3', lty = 'dotted')  # –ø—É–Ω–∫—Ç–∏—Ä
             
             
             
#       4.5) –ì—Ä–∞—Ñ–∏–∫ —Å –¥–æ–≤–µ—Ä–∏—Ç–ª—å–Ω–æ–π –ø–æ–ª–æ—Å–æ–π: 
             library(ggplot2)

             theme_set(theme_bw(base_size = 14))  # —á—ë—Ä–Ω–æ-–±–µ–ª–æ–µ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ, –±–∞–∑–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞
             theme_update(plot.title = element_text(face = 'bold', hjust = 0.5))  # –∂–∏—Ä–Ω—ã–π —à—Ä–∏—Ñ—Ç –∑–∞–≥–æ–ª–æ–≤–∫–∞, –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ –ø–æ —Ü–µ–Ω—Ç—Ä—É
             
             x.gg <-ggplot(x) +
               aes(y = x[[2]], x = x[[1]]) +
               geom_point(col = 'blue', cex = 1.5) +
               geom_smooth(method = 'lm', col = 'red', level = CL/100, fill = 'pink')+
               labs(title = main.plot, 
                    y = ylab.plot, x = xlab.plot)
             print(x.gg)
             
             
             
             
             
             
# 4) –ò–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏—è:
#    ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ
#    –¢–∞–±–ª–∏—Ü–∞ –†–ê–ó–ú–ï–†–ê –≠–§–§–ï–ö–¢–ê:
#    ------------------------
#    –º–æ–¥—É–ª—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞	—Å–≤—è–∑—å
#    <    0.10	–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞
#    ‚â•    0.10	—Å–ª–∞–±–∞—è
#    ‚â•    0.30	—É–º–µ—Ä–µ–Ω–Ω–∞—è
#    ‚â•    0.50	—Ç–µ—Å–Ω–∞—è 
if  (abs(R2) <  0.02)                        {power.com <- "–Ω–µ –≤—ã—Ä–∞–∂–µ–Ω–∞"}
if ((abs(R2) >= 0.02) & (abs(R2) < 0.13))    {power.com <- "—Å–ª–∞–±–∞—è"     }
if ((abs(R2) >= 0.13) & (abs(R2) < 0.26))    {power.com <- "—É–º–µ—Ä–µ–Ω–Ω–∞—è"  }
if  (abs(R2) >= 0.26)                        {power.com <- "—Ç–µ—Å–Ω–∞—è"     }

cat('\n–ú–æ–¥–µ–ª—å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏', '\033[1m', names(as.data.frame(x)[2]), '\033[0;0m',
    '¬´–ù–ê¬ª', '\033[1m', names(as.data.frame(x)[1]), '\033[0;0m:'                                                   ,"\n")

#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Ppb (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ç–æ—á–µ—á–Ω–æ-–±–∏—Å–µ—Ä–∏–∞–ª—å–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Ppb);
#    ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Œ∑2  (–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –≤–Ω—É—Ç—Ä–∏–≥—Ä—É–ø–ø–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ Œ∑2).
cat("----------------------------------------------------------"                                                    ,"\n")
cat("a) \033[34m–û—Ü–µ–Ω–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:\033[0m"                                                     ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                                     ,"\n")
cat("   ‚Ä¢ –∑–Ω–∞—á–µ–Ω–∏–µ Œ≤0, (–∏–Ω—Ç–µ—Ä—Ü–µ–ø—Ç)                :", Œ≤0                                                            ,"\n")
cat("   ‚Ä¢ –∑–Ω–∞—á–µ–Ω–∏–µ Œ≤1, (—É–≥–æ–ª –Ω–∞–∫–ª–æ–Ω–∞)             :", Œ≤1                                                            ,"\n\n")
cat("   ‚Ä¢ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ R¬≤             :", R2                                                            ,"\n")
cat("   ‚Ä¢ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤             :", summary(lm(x[[2]] ~ x[[1]], data = x))[["sigma"]]             ,"\n")
cat("----------------------------------------------------------"                                                    ,"\n")
cat("–±) \033[34m–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è –æ—Ü–µ–Ω–æ–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏:\033[0m"                                      ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                      ,"\n")
cat("   ‚Ä¢ –∑–Ω–∞—á–µ–Ω–∏–µ SEb0,                          :", summary(lm(x[[2]] ~ x[[1]], data = x))[["coefficients"]][1,2] ,"\n")
cat("   ‚Ä¢ –∑–Ω–∞—á–µ–Ω–∏–µ SEb1,                          :", summary(lm(x[[2]] ~ x[[1]], data = x))[["coefficients"]][2,2] ,"\n")
cat("----------------------------------------------------------"                                                    ,"\n")
cat("–≤) \033[34m–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã CI –ø—Ä–∏:","\033[0m"                                      ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                      ,"\n")
for (i in 1:length(CL)){
cat(paste0("–ü—Ä–∏ CI=", CL[i],"%:"), "\n")
print(confint(lm(x[[2]] ~ x[[1]], data = x), level = CL[i]/100))
cat("\n")
}
cat("   –≥–¥–µ:\n")
cat("   ‚Ä¢ Intercept - b0;\n")
cat("   ‚Ä¢ x[[n]]    - b1;\n\n")
cat("----------------------------------------------------------"                                                    ,"\n")
cat("–≥) \033[34m–§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏:\033[0m"                                                    ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                                    ,"\n")
print(summary(lm(x[[2]] ~ x[[1]], data = x)))
cat("\n   –≥–¥–µ:\n")
cat("   ‚Ä¢ Estimate Std -  b0 –∏ b1;\n")
cat("   ‚Ä¢ Std. Error   - SEb0 –∏ SEb1;\n")
cat("   ‚Ä¢ Residual standard error - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫—É –æ—Å—Ç–∞—Ç–∫–æ–≤.\n")
cat("   ‚Ä¢ Multiple R-squared      - –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ R¬≤;\n\n")
cat("----------------------------------------------------------"                                                    ,"\n")
cat("–¥) \033[34m–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:\033[0m"                                                                      ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                                                      ,"\n")
cat("   ‚Ä¢ –æ–±—â–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤       SS_total    :", SS_total                                                      ,"\n")
cat("   ‚Ä¢ –º–µ–∂–≥—Ä—É–ø–ø–∞—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤  SS_effect   :", SS_effect                                                     ,"\n")
cat("   ‚Ä¢ —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ –æ—Å—Ç–∞—Ç–∫–æ–≤    SS_residual :", SS_residual                                                   ,"\n")
cat("----------------------------------------------------------"                                                    ,"\n")
cat("–µ) \033[34m–†–µ–≥—Ä–µ—Å—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏:\033[0m"                                                    ,"\n")
cat("   ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ"                                                                    ,"\n")
print(M)
cat("\n   –≥–¥–µ:\n")
cat("   ‚Ä¢ DF - —Å—Ç–µ–ø–µ–Ω—å —Å–≤–æ–±–æ–¥—ã;\n")
cat("   ‚Ä¢ SS - —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤;\n")
cat("   ‚Ä¢ MS - —Å—Ä–µ–¥–Ω—è—è —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤:\n")
cat("   ‚Ä¢ F  - F-—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞;\n")
cat("   ‚Ä¢ P  - P-–∑–Ω–∞—á–µ–Ω–∏–µ.\n\n")

cat("----------------------------------------------------------"           ,"\n")
cat("‚Ä¢ –í—ã–≤–æ–¥: –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∞ ", '\033[1m', power.com ,'\033[0m', "—Å–≤—è–∑—å", 
    '\x1B[3m', names(as.data.frame(x)[2]), '\x1B[0m',
    "—Å",
    '\x1B[3m', names(as.data.frame(x)[1]), '\x1B[0m'                            ,"\n")
cat("-----------------------------------------------------------"          ,"\n")

}









Static_output <- function(x, CL_n=95, CL_n_group=NULL, p_SEP=NULL, p_SEP.onli=NULL, CI_coeff=FALSE){
  
  # CL_n - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–æ–≤–µ—Ä–∏—è
  # CL_n_group - –∫–æ—ç—Ñ. –¥–æ–≤–µ—Ä–∏—è –¥–ª—è –≥—Ä—É–ø–ø (–µ—Å–ª–∏ –æ–∏–¥–Ω –∏–∑ —Å—Ç–æ–ª—Ü–æ–≤ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–ª–æ–≤–∞ –∏ –µ–≥–æ –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ä—Ç—å –Ω–∞ –≥—Ä—É–ø–ø—ã)
  # p_SEP - –¥–æ–ª—è %, —Å—á–∏—Ç–∞–µ—Ç –Ω–µ –±–æ–ª–µ–µ —ç—Ç–æ–≥–æ —á–∏—Å–ª–∞
  # CI_coeff - –µ—Å–ª–∏ –Ω—É–∂–Ω—ã –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å—ã–Ω–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø—Ä–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞—Ö –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
  
  if (!is.null(p_SEP.onli)){
    cat("\n")
    
    p <- p_SEP.onli[1]
    n <- p_SEP.onli[2]
    
    œÉ2 <- p*(1-p)
    SEp <- sqrt(œÉ2/n);  SEp
    cat("SEp:", (SEp),    "- c—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–æ–ª–∏;","\n")
    
    for (i in 1:length(CL_n)){
      CL <- CL_n/100
      a <- 1-CL[i]
      z <- qnorm(0.5*a)
      z <- (0-z)
      MOE <- z * SEp;  MOE
      cat("MOE:", (MOE),    "- c—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–æ–ª–∏ –ø—Ä–∏ CL:", CL_n[i],     "\n")
    }
    cat("\n")
    break
  }

  
  x <- na.omit(x)
  
  if (length(as.data.frame(x)) > 1) {
  
  if ((is.character(x[[1]])) | (is.character(x[[2]]))) {
  if (!is.character(x[[2]])){
    x <- x[c(2,1)]
  }
  }
  else  if ((is.factor(x[[1]])) | (is.factor(x[[2]]))) {
    if (!is.factor(x[[2]])){
      x <- x[c(2,1)]
    }
  } 
    
    
  }


# 1) -/–¢–ï–û–†–ò–Ø/-
#    ------------------ 
#    –°–¢–ê–¢–ò–ß–ï–°–ö–ò–ô –í–´–í–û–î:
#    ------------------    
#    ¬´–ù–ê–î–Å–ñ–ù–û–°–¢–¨¬ª, –∏–ª–∏ ¬´–¢–û–ß–ù–û–°–¢–¨¬ª —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–æ–≥–æ, 
#    –Ω–∞—Å–∫–æ–ª—å–∫–æ –≤—ã–±–æ—Ä–∫–∞ —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–∞, —Ç–æ –µ—Å—Ç—å –∞–¥–µ–∫–≤–∞—Ç–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –≥–µ–Ω–µ—Ä–∞–ª—å–Ω—É—é —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å.     
#                                               ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø        
#    –ù–∞–≤–µ—Ä–Ω—è–∫–∞ —ç—Ç–æ–≥–æ –∑–Ω–∞—Ç—å –ù–ï –º–æ–∂–µ–º, –Ω–æ —Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –æ–∂–∏–¥–∞–µ–º–∞—è —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞, 
#    –µ—Å–ª–∏ –≤—Å–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –∏–º–µ—é—Ç –†–ê–í–ù–£–Æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø–æ–ø–∞—Å—Ç—å –≤ –≤—ã–±–æ—Ä–∫—É
#    ‚Äî —Ç–∞–∫–∞—è –≤—ã–±–æ—Ä–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–ª—É—á–∞–π–Ω–æ–π (random sample). 
#                               ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø   
#    –¢.–µ.
#    
#    ‚Ä¢ –í–µ—Å—å —á–∞—Å—Ç–æ—Ç–Ω—ã–π —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –¥–æ–ø—É—â–µ–Ω–∏–∏ –æ —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –≤—ã–±–æ—Ä–∫–∏.
#                     ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø                ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø   
#    ‚Ä¢ –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å –≤—ã–≤–æ–¥–∞ –∑–∞–≤–∏—Å–∏—Ç –∏ –æ—Ç –æ–±—ä—ë–º–∞ –≤—ã–±–æ—Ä–∫–∏.
#      ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø                     ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#    
#    ----------------------------           
#    –®–∫–æ–ª—ã —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –≤—ã–≤–æ–¥–∞     
#    ---------------------------- 
#    ‚Ä¢ ¬´—á–∞—Å—Ç–æ—Ç–Ω—ã–π¬ª, –∏–ª–∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–º, –∏–ª–∏ –æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ 
#       –∫–∞–∫ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ–π —á–∞—Å—Ç–æ—Ç—ã —Å–æ–±—ã—Ç–∏—è –ø—Ä–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–º —á–∏—Å–ª–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π.   
#        
#    ‚Ä¢ ¬´–ë–∞–π–µ—Å–æ–≤—Å–∫–∏–π¬ª –ø–æ–¥—Ö–æ–¥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—É–±—ä–µ–∫—Ç–∏–≤–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å ‚Äî
#       —ç—Ç–æ —Å—Ç–µ–ø–µ–Ω—å –Ω–∞—à–µ–π —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –≤ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–º –Ω–∞–º –∏—Å—Ö–æ–¥–µ —Å–æ–±—ã—Ç–∏—è, –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ –ª–∏–±–æ —É–∂–µ –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–µ–≥–æ. 
#    
#    –í –î–ê–ù–ù–û–ú –ó–ê–î–ê–ß–ï ¬´–ß–ê–°–¢–û–¢–ù–´–ô –ü–û–î–•–û–î¬ª! 
# 
#    
# 2) –ù–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –≤—ã–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—É —Å–æ –≤—Å–µ–º–∏ –æ—Ç–≤–µ—Ç–∞–º–∏:  
     x.Stat <- function(vectot, var=NULL){
       a<-1
#     
#    –í —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–º –≤—ã–≤–æ–¥–µ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º –∏–∑–º–µ–Ω—á–∏–≤–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø—Ä–∏ —á–∞—Å—Ç–æ—Ç–Ω–æ–º –ø–æ–¥—Ö–æ–¥–µ 
#    –∏–º–µ—è –¥–µ–ª–æ —Å –¥–≤—É–º—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è–º–∏ –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π: 
#    - c —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –∏ –≤—ã–±–æ—Ä–∫–∏.
#        ‚Ä¢ –°–≤–æ–¥–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏; 
#        ‚Ä¢ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–µ –≤—ã–±–æ—Ä–æ—á–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞–º–∏.
#    
#    ‚Ä¢ –ì–µ–Ω–µ—Ä–∞–ª—å–Ω–∞—è —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç—å (population) - –º–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—Å–µ—Ö –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∏–∑—É—á–∞–µ–º–æ–≥–æ —è–≤–ª–µ–Ω–∏—è 
#    ‚Ä¢ –í—ã–±–æ—Ä–∫–∞ (sample) - –∏–º–µ—é—â–∏–µ—Å—è —É –Ω–∞—Å –¥–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è, –≤—ã–±–æ—Ä–æ—á–Ω–æ –ø–æ–ª—É—á–µ–Ω–Ω—ã–µ –∏–∑ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏.
#    
#    
#          ‚Ä¢ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã - —Ç–æ, —á—Ç–æ —Ö–æ—Ç–∏–º –æ—Ü–µ–Ω–∏—Ç—å (–Ω–µ –º–æ–∂–µ–º –∏—Ö –≤—ã—á–∏–ª—Å–∏—Ç—å, –Ω–æ –≤ —Ä–∞–π–æ–Ω–µ –∫–∞–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç—å);
#          ‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ - —Ç–æ, —á—Ç–æ –º–æ–∂–µ–º –≤—ã—á–∏—Å–ª–∏—Ç—å;                    
#    
#    2.2) –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ (–°–≤–æ–¥–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏):  
#    
          Œº  <- mean(vectot[[a]]); Œº
#    
#         ‚Ä¢ –ù–µ—Å–º–µ—â—ë–Ω–Ω–æ—Å—Ç—å (unbiasedness) –æ—Ü–µ–Ω–∫–∏ ‚Äî —ç—Ç–æ —Å–≤–æ–π—Å—Ç–≤–æ –µ—ë –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è 
#             (—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ) —Å–æ–≤–ø–∞–¥–∞—Ç—å —Å –∏—Å—Ç–∏–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.
#           
#           –í—ã–±–æ—Ä–æ—á–Ω–∞—è –¥–æ–ª—è –≥—Ä–∞–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π ‚Äî —ç—Ç–æ –Ω–µ—Å–º–µ—â—ë–Ω–Ω–æ–µ (unbiased) —Å—Ä–µ–¥—Å—Ç–≤–æ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è –µ—ë –¥–æ–ª–∏ –≤ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏. 
#           –ù–µ—Å–º–µ—â—ë–Ω–Ω—ã–º–∏ –æ—Ü–µ–Ω–∫–∞–º–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–ª—É–∂–∞—Ç —Ç–∞–∫–∂–µ –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ –∏ –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –¥—Ä—É–≥–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.
#                        
            œÉ2 <- sum((vectot[[a]] - mean(vectot[[a]]))^2)/length(vectot[[a]]); œÉ2
            œÉ  <- sqrt(œÉ2); œÉ
            
            

#    2.3) –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
#         
#         –ù–∞—Å –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –∏ –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, 
#         –Ω–æ –º–æ–∂–µ–º –Ω–∞–π—Ç–∏ —Ç–æ–ª—å–∫–æ –∏—Ö –ø—Ä–∏–±–ª–∏–∑–∏—Ç–µ–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è.
#         (–ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ–º (estimation)).
#                   
          x  <- sum(vectot[[a]])/(length(vectot[[a]])); vectot
          s2 <- var(vectot[[a]]); s2
          s  <- sd(vectot[[a]]); s
#              
#    2.4) –§—É–Ω–∫—Ü–∏—è R
          if (Œº == x ) {R.Œº.x   <-"—Å–æ–≤–ø–∞–¥–∞—é—Ç"}
          if (œÉ2== s2) {R.œÉ2.s2 <-"—Å–æ–≤–ø–∞–¥–∞—é—Ç"} 
          if (œÉ == s ) {R.œÉ.s   <-"—Å–æ–≤–ø–∞–¥–∞—é—Ç"} 
          
          if (Œº  < x ) {R.Œº.x   <-"–≤—ã–±–æ—Ä–æ—á–Ω–æ–µ"} 
          if (œÉ2 < s2) {R.œÉ2.s2 <-"–≤—ã–±–æ—Ä–æ—á–Ω–æ–µ"} 
          if (œÉ  < s ) {R.œÉ.s   <-"–≤—ã–±–æ—Ä–æ—á–Ω–æ–µ"} 
          
          if (Œº  > x ) {R.Œº.x   <-"–≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–µ"} 
          if (œÉ2 > s2) {R.œÉ2.s2 <-"–≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–µ"} 
          if (œÉ  > s ) {R.œÉ.s   <-"–≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–µ"}                  
          
          x.DF <- data.frame("1" = c("Œº :", "œÉ¬≤:", "œÉ :"),
                             "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞"= c(Œº, œÉ2, œÉ),
                             "1" = c("x :", "s¬≤:", "s :"),
                             "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"    = c(x, s2, s),
                             "–§—É–Ω–∫—Ü–∏—è R"     = c(R.Œº.x, R.œÉ2.s2, R.œÉ.s))
          names(x.DF) <- c("", "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞", "    ", "—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞", "   –§—É–Ω–∫—Ü–∏—è R")
          
          if (is.null(var)) {return(x.DF)}
          if (var=="Œº")     {return(Œº)}
          if (var=="œÉ2")    {return(œÉ2)}
          if (var=="œÉ")     {return(œÉ)}
          if (var=="x")     {return(x)}
          if (var=="s2")    {return(s2)}
          if (var=="s")     {return(s)}}

#     –û—Ç–≤–µ—Ç:
      cat("–î–ª—è –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π:", names(x[1]), "\n"); print(x.Stat(x)); cat("\n")

# 3) –û—Ü–µ–Ω–∏—Ç–µ –ø–æ —ç—Ç–æ–π –≤—ã–±–æ—Ä–∫–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏:  

#    –ü—Ä–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–º –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏–∏ –≤—ã—è—Å–Ω–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –¢–û–ß–ù–ê.
#    –¢–æ—á–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ –µ—ë –†–ê–°–•–û–ñ–î–ï–ù–ò–ï —Å –∏—Å—Ç–∏–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.        
#    –û–Ω–æ –Ω–∞–º –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ, –ø–æ—ç—Ç–æ–º—É –≤—ã—è—Å–Ω–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–∞ –Ω–∞—à–∞ –≤—ã–±–æ—Ä–æ—á–Ω–∞—è –æ—Ü–µ–Ω–∫–∞, –º—ã –Ω–µ –º–æ–∂–µ–º, 
#    –Ω–æ –∑–∞—Ç–æ –º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ä–∞—Å—Ö–æ–¥—è—Ç—Å—è —Ç–∞–∫–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω—ã–µ –æ—Ü–µ–Ω–∫–∏ –≤ —Ü–µ–ª–æ–º, –∫–∞–∫–æ–≤ –∏—Ö —Ä–∞–∑–±—Ä–æ—Å.          
#                              ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø              
#       –í –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ä—ã —Ä–∞–∑–±—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è ¬´—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ¬ª. 
#       –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –µ–≥–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –∏–∑–≤–ª–µ—á—å –∏–∑ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–µ —á–∏—Å–ª–æ 
#       —Å–ª—É—á–∞–π–Ω—ã—Ö –≤—ã–±–æ—Ä–æ–∫ –∏ –ø–æ –∫–∞–∂–¥–æ–π –∏–∑ –Ω–∏—Ö –æ—Ü–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, —Ç.–µ. –Ω–∞–π—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. 
#       –¢–∞–∫ –º—ã –ø–æ–ª—É—á–∏–º –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–Ω–∞—á–µ–Ω–∏–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏, –∫–æ—Ç–æ—Ä–æ–µ –∏–º–µ–µ—Ç —Å–≤–æ—ë —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ ‚Äî –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ (sampling distribution).        
#                                                                                        ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø                 
#    –ï—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —è–≤–ª—è–µ—Ç—Å—è –Ω–µ—Å–º–µ—â—ë–Ω–Ω—ã–º —Å—Ä–µ–¥—Å—Ç–≤–æ–º –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è, —Ç–æ 
#    ‚Ä¢ —Ü–µ–Ω—Ç—Ä –µ—ë –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏ –µ—Å—Ç—å –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, 
#    ‚Ä¢ –∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ—Ü–µ–Ω–∫–∏ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç—Å—è –∫–∞–∫ –≤–µ–ª–∏—á–∏–Ω–∞ –µ—ë –Ω–µ—Ç–æ—á–Ω–æ—Å—Ç–∏, –æ—à–∏–±–∫–∏.
#      
#    –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–æ–π SE.
#    
#    –§–æ—Ä–º—É–ª—ã SE –æ–ø–∏—Å—ã–≤–∞–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –æ—Ü–µ–Ω–∏—Ç—å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä –ø–æ –≤—ã–±–æ—Ä–æ—á–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é (–ø–æ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ).
#    
#    3.1) C—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ SEM:
#         ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#         –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ, SEM ‚Äî —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –Ω–∞ –∫–æ—Ç–æ—Ä—É—é –æ—Ü–µ–Ω–∫–∞ –ø–æ—Å—Ä–µ–¥—Å—Ç–≤–æ–º –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ 
#         –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –æ—Ç –∑–Ω–∞—á–µ–Ω–∏—è —Å—Ä–µ–¥–Ω–µ–≥–æ –¥–∞–Ω–Ω–æ–π –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 2/3 –≤—ã–±–æ—Ä–æ–∫ —Ç–∞–∫–æ–≥–æ –∂–µ –æ–±—ä—ë–º–∞.
#    
#         –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ —Å—Ä–µ–¥–Ω–µ–≥–æ, SEM - —ç—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤–µ–ª–∏—á–∏–Ω–∞, –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –∫–æ—Ç–æ—Ä–æ–π –æ—Ç–∫–ª–æ–Ω—è–µ—Ç—Å—è –æ—Ç –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ 2/3 –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö.
#         —Ç.–µ. –±–µ—Ä–µ–º –º–Ω–æ–≥–æ –≤—ã–±–æ—Ä–æ–∫ –∏ —Å—á–∏—Ç–∞–µ–º –º–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–∏—Ö –∏ —Å–º–æ—Ç—Ä–∏–º –∫–∞–∫ —Å—Ä–µ–¥–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è.
#         –ò, –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è, 2/3 —Å—Ä–µ–¥–Ω–∏—Ö –±—É–¥—É—Ç –ª–µ–∂–∞—Ç—å –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –æ—Ç "-" –¥–æ "+" 1 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –æ—Ç –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ.
#    
#         –¢.–µ. SEM - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–≥–æ, –∫–æ—Ç–æ—Ä–æ–µ –ø—Ä–∏–Ω—è—Ç–æ –Ω–∞–∑—ã–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–æ–π, 
#         –ø–æ—Ç–æ–º—É —á—Ç–æ, –∫–æ–≥–¥–∞ –æ—Ü–µ–Ω–∏–≤–∞–µ–º, –∏–Ω—Ç–µ–ø—Ä–µ—Ç–∏—Ä—É–µ–º –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –Ω–∞—à–µ–π –æ—Ü–µ–Ω–∫–∏ –∫–∞–∫ –µ—ë –æ—à–∏–±–∫—É. –ß–µ–º –±–æ–ª—å—à–µ –æ–∫—Ç–ª–æ–Ω—è–µ—Ç—Å—è, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –æ—à–∏–±–∞–µ–º—Å—è.                     
#    
#         –¢.–µ. –µ—Å–ª–∏ –±—É–¥–µ–º —Ç–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –æ—Ü–µ–Ω–∏–≤–∞—Ç—å, —Ç–æ –≤ 2/3 —Å–ª—É—á–∞–µ–≤ –Ω–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç +- 1 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–µ–Ω–∏–µ –æ—Ç –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è.                          
                                  
          n  <- length(x[[1]])
          œÉ  <- x.Stat(x, "œÉ")
          s  <- x.Stat(x, "s")
          SEM_œÉ <- œÉ/sqrt(n);  SEM_œÉ
            
#         –§–æ—Ä–º—É–ª–∞ –¥–∞–µ—Ç —Ç–æ—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–∏, –Ω–æ 
#         –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: œÉ ‚Äî —ç—Ç–æ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ.

#         –ú—ã –Ω–µ –º–æ–∂–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —ç—Ç–æ–π —Ñ–æ—Ä–º—É–ª–æ–π, —Ç.–∫.–°–ò–ì–ú–ê –Ω–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ - —ç—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä. –ú—ã –Ω–µ –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–≤–∞—Ç—å –∏—Ö –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏–π.
#         ‚Ä¢ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã - —Ç–æ, —á—Ç–æ —Ö–æ—Ç–∏–º –æ—Ü–µ–Ω–∏—Ç—å (–Ω–µ –º–æ–∂–µ–º –∏—Ö –≤—ã—á–∏–ª—Å–∏—Ç—å, –Ω–æ –≤ —Ä–∞–π–æ–Ω–µ –∫–∞–∫–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —É–∫–∞–∑–∞—Ç—å);
#         ‚Ä¢ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ - —Ç–æ, —á—Ç–æ –º–æ–∂–µ–º –≤—ã—á–∏—Å–ª–∏—Ç—å;    


#         –í–º–µ—Å—Ç–æ –Ω–µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –Ω–µ—Å–º–µ—â—ë–Ω–Ω—É—é –æ—Ü–µ–Ω–∫—É 
#         ‚Äî –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∫–∏:
          SEM_s <- s/sqrt(n);  
          cat("SEM:", round(SEM_s, 6),  "- —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ;",          "\n")

          
#         -/–ü–†–ò–ú–ï–ß–ê–ù–ò–ï/-   
#         –ü–æ—Å–∫–æ–ª—å–∫—É –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é —Ñ–æ—Ä–º—É–ª—É –≤—Ö–æ–¥–∏—Ç –Ω–µ œÉ, –∞ –µ—ë –æ—Ü–µ–Ω–∫–∞, —Ç–æ –∏ 
#         –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ–º–∞—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ ‚Äî —ç—Ç–æ –Ω–µ –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, 
#         –∞ –µ–≥–æ –æ—Ü–µ–Ω–∫–∞, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. –ì–ª—è–¥—è –Ω–∞ —Ñ–æ—Ä–º—É–ª—É, –º—ã —Ç–∞–∫–∂–µ –∑–∞–º–µ—á–∞–µ–º, —á—Ç–æ 
#         —á–µ–º –º–µ–Ω—å—à–µ —Ä–∞–∑–±—Ä–æ—Å –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –±–æ–ª—å—à–µ –æ–±—ä—ë–º –≤—ã–±–æ—Ä–∫–∏, —Ç–µ–º –º–µ–Ω—å—à–µ SEM, 
#         —Ç.–µ. –≤—ã—à–µ —Ç–æ—á–Ω–æ—Å—Ç—å –æ—Ü–µ–Ω–∫–∏ —Å—Ä–µ–¥–Ω–µ–≥–æ.
          

#    3.2) –î–æ–ª—è var1, —á—å—è var2 –Ω–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç "p_SEP"%:
#         ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø  
#         p - –¥–æ–ª—è (proportion) 
          
          if (!is.null(p_SEP)){
          p <- pnorm(p_SEP+1, mean = mean(x[[1]]), sd = x.Stat(x, "œÉ"))

#    3.3) –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫—É —Ç–∞–∫–æ–π –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–æ–ª–∏ SEp:
#         ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#         –ü—Ä–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏–∏ –¥–æ–ª–∏ p (proportion) –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –±–∏–Ω–∞—Ä–Ω—ã–µ, 
#         –ø–æ –ø—Ä–∏–∑–Ω–∞–∫—É –Ω–∞–ª–∏—á–∏—è –ª–∏–±–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è ‚Äú—É—Å–ø–µ—Ö–∞,‚Äù —Ç.–µ. –æ–¥–Ω–æ–π –∏–∑ –≥—Ä–∞–¥–∞—Ü–∏–π. 
#         –í —Ç–∞–∫–æ–º —Å–ª—É—á–∞–µ –¥–æ–ª—é –º–æ–∂–Ω–æ —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –Ω—É–ª–µ–π –∏ –µ–¥–∏–Ω–∏—Ü, 
#         –∏, –µ—Å–ª–∏ –≤—ã–±–æ—Ä–∫–∞ –Ω–µ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–∞—è, —Ç–æ –µ–≥–æ –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –±–ª–∏–∑–∫–∏–º –∫ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É.
#         
#         SS = pn √ó (1-p)¬≤ + (1-p)n √ó (0-p)¬≤
#          
#              pn(1-p)¬≤ + (1-p)np¬≤   pn(1-p)((1-p)+p)
#         œÉ¬≤ = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî = ‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî‚Äî = p(1-p)
#                       n                   n
          SS <- (p*n) * (1-p)^2 + ((1-p)*n * (0-p)^2)
          œÉ2 <- p*(1-p)

          SEp <- sqrt(œÉ2/n);  SEp
          
          cat("SEp:", round(SEp, 6),    "- c—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–æ–ª–∏;",               "\n")
#                
#         –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ—Ç—Å—è SEp –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ SEM, –∫–∞–∫ –Ω–∞–∏–±–æ–ª—å—à–µ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω–æ–π 
#         –¥–æ–ª–∏ –æ—Ç –¥–æ–ª–∏ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ 2/3 –≤—ã–±–æ—Ä–æ–∫ —Ç–∞–∫–æ–≥–æ –∂–µ –æ–±—ä—ë–º–∞.
#          
#          
#         –ö–∞–∫ –∏–Ω—Ç–µ–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É? –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞, 
#         –µ—Å—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç–∏–º –æ—Ü–µ–Ω–∏—Ç—å –∏ —É –Ω–µ–≥–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—à–∏–±–∫–∏,
#         —ç—Ç–æ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞.
#          
#         –£ –Ω–∞—Å –µ—Å—Ç—å –Ω–∞—à–∏ –¥–∞–Ω–Ω—ã–µ, –ø–æ –∫–æ—Ç–æ—Ä—ã–º –ø–æ—Å—á–∏—Ç–∞–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É - —è–≤–ª—è—é—Ç—Å—è –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏, 
#         –æ–Ω–∏ –Ω–∏–∫—É–¥–∞ —Å–ª—É—á–∞–π–Ω–æ –∏–∑–µ–Ω—è—Ç—Å—è –Ω–µ –º–æ–≥—É—Ç. –ö–∞–∫ –º–æ–∂–µ–º –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å —Å–µ–±–µ, —á—Ç–æ —Ç–∞–º –º–æ–∂–µ—Ç —Å–ª—É—á–∞–π–Ω–æ –º–µ–Ω—è—Ç—å—Å—è?
#         –ú—ã –±—É–¥–µ–º –Ω–∞–±–∏—Ä–∞—Ç—å –º–Ω–æ–≥–æ –≤—ã–±–æ—Ä–æ–∫ –∏–∑ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ –∏ –ø–æ –∫–∞–∂–¥–æ–π –≤—ã–±–æ—Ä–∫–µ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.  


# 4) –ù–∞–π–¥–∏—Ç–µ –¥–ª—è —Ç–∞–∫–æ–π –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–æ–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å MOE —Å CL = CL_n%:
#                      ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#    –ü—Ä–∏ –∏–Ω—Ç–µ–ø—Ä–µ—Ç–∞—Ü–∏–∏ SEM –≥–æ–≤–æ—Ä–∏–ª–∏, —á—Ç–æ –µ—Å–ª–∏ –±—É–¥–µ–º —Ç–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –æ—Ü–µ–Ω–∏–≤–∞—Ç—å, —Ç–æ –≤ 2/3 —Å–ª—É—á–∞–µ–≤ –Ω–∞—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç +- 1 —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–µ–Ω–∏–µ –æ—Ç –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–≥–æ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è. 2/3 –≤—ã–±–æ—Ä–æ—á–Ω—ã—Ö —Å—Ä–µ–¥–Ω–∏—Ö –ø–æ–ø–∞–¥–∞–µ—Ç.                          
#    –≠—Ç–æ –Ω–µ –æ—á–µ–Ω—å —É–¥–æ–±–Ω–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ, –ø–æ—ç—Ç–æ–º—É –≤–æ–∑—å–º–µ–º –¥—Ä—É–≥–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª. –≠—Ç–æ —É–∂–µ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞, –∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å.
#    –û–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞ –ø–æ —Å–º—ã—Å–ª—É, —Ç–æ–∂–µ –µ—Å—Ç—å –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∑–∞ –ø—Ä–µ–¥–µ–ª—ã—Ö –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ –≤—ã—Ö–æ–¥—è—Ç –æ–ø—Ä–µ–¥–µ–ª–Ω–Ω–æ–µ —á–∏—Å–ª–æ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π,
#    —Ç–æ–ª—å–∫–æ –Ω–µ 68%, –∞ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å –ª—é–±—É—é –¥–æ–ª—é (–æ–±—ã—á–Ω–æ 90-95%)

#    MOE = (o - z) √ó SE    
          for (i in 1:length(CL)){
#    4.1) –ù–∞—Ö–æ–¥–∏–º –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è CL –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å ‚ç∫: ‚ç∫=1-CL
          CL <- CL_n/100
          a <- 1-CL[i]

#    4.2) –ù–∞—Ö–æ–¥–∏–º –∫–≤–∞–Ω—Ç–∏–ª—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è 0.5‚ç∫ –∏ –æ—Ç–Ω–∏–º–µ–º –æ—Ç 0,
#         —Ç.–µ. –º–µ–Ω—è–µ–º –∑–Ω–∞–∫ –Ω–∞ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π     
          z <- qnorm(0.5*a)
          z <- (0-z)
#    4.3) –ü–µ—Ä–µ–≤–æ–¥–∏–º –Ω–∞–π–¥–µ–Ω–Ω—É—é –≤–µ–ª–∏—á–∏–Ω—É –≤ –∑–Ω–∞—á–µ–Ω–∏–µ –∏—Å—Ö–æ–¥–Ω–æ–π —à–∫–∞–ª—ã, —É–º–Ω–æ–∂–∏–º –µ—ë –Ω–∞ SE.
#         –ü—Ä–æ—É—á–µ–Ω–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç - –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å —Å —É—Ä–æ–≤–Ω–µ–º –¥–æ–≤–µ—Ä–∏–º–µ–º ‚ç∫.
          MOE <- z * SEp;  MOE
          cat("MOE:", round(MOE, 6),    "- c—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–æ—á–Ω–æ–π –¥–æ–ª–∏ –ø—Ä–∏ CL:", CL[i],     "\n")
          }
          cat("\n")
          }
          
                  
# 5) –ù–∞–π–¥–∏—Ç–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ MOE —Å CL = –°L_n%:
#            ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø          
#    –ü–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –¥–ª—è —Å—Ä–µ–¥–Ω–µ–≥–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–≤–∞–Ω—Ç–∏–ª–µ–π —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —É—Å–ª–æ–≤–∏–∏, —á—Ç–æ –Ω–∞–º –∏–∑–≤–µ—Å—Ç–Ω–æ –∏—Å—Ç–∏—á–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ S–ï–ú. 

#    –î–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –ú–û–ï –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–≤–∞–Ω—Ç–∏–ª–∏ —É–∂–µ –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —ç—Ç–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è t-–°—Ç—å—é–¥–µ–Ω—Ç–∞, –ø–æ—Ö–æ–∂–µ–≥–æ –ø–æ —Ñ–æ—Ä–º–µ –Ω–æ —Å –±–æ–ª–µ–µ
#    —Ç–æ–ª—Å—Ç—ã–º–∏ —Ö–≤–æ—Å—Ç–∞–º–∏ ‚Äî —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ, –∫–≤–∞–Ω—Ç–∏–ª—å a/2 –≤ –Ω—ë–º —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω –¥–∞–ª—å—à–µ –æ—Ç —Ü–µ–Ω—Ç—Ä–∞. –ü—Ä–æ–ø–æ—Ä—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ–Ω—è—é—Ç—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –µ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ ‚Äî —á–∏—Å–ª–∞
#    —Å—Ç–µ–ø–µ–Ω–µ–π —Å–≤–æ–±–æ–¥—ã df = n - 1: —á–µ–º –±–æ–ª—å—à–µ –≤—ã–±–æ—Ä–∫–∞, —Ç–µ–º –æ–Ω–æ –±–æ–ª—å—à–µ, –∏ —Ç–µ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–ª–∏–∂–µ –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É (—Ö–≤–æ—Å—Ç—ã —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è —Ç–æ–Ω—å—à–µ)
       
#    –ü–æ—Ä—è–¥–æ–∫ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ú–û–ï –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ, –Ω–æ –Ω–∞ 2-–º —à–∞–≥–µ –≤–º–µ—Å—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–∞–∫–∂–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ t-–°—Ç—å—é–¥–µ–Ω—Ç–∞ —Å–æ —Å—Ç–µ–ø–µ–Ω—è–º–∏ —Å–≤–æ–±–æ–¥—ã df = n - 1.     
     CL <- CL_n/100
     
     for (i in 1:length(CL)){
     a <- 1-CL[i]
     z <- qt(0.5*a, n-1)
     z <- (0-z)
     MOE_sem <- z * SEM_s 
     cat("MOE:", round(MOE_sem, 6),"- —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Å—Ä–µ–¥–Ω–µ–≥–æ;","\n")
     }
     cat("\n")
     
# 6) –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª CI
#    ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#    –û–¥–Ω–∞ –∏–∑ –∏–¥–µ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–≥–æ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è —Å–æ—Å—Ç–æ–∏—Ç –≤ —Ç–æ–º, —á—Ç–æ–±—ã –ø—Ä–∏–≤—è–∑–∞—Ç—å –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å 
#    –Ω–µ –∫ –∏—Å—Ç–∏–Ω–Ω–æ–º—É –∑–Ω–∞—á–µ–Ω–∏—é –ø–∞—Ä–∞–º–µ—Ç—Ä–∞, –∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –Ω–∞–º–∏ —Ç–æ—á–µ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–µ —ç—Ç–æ–≥–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞.
#    
#    –í —Å–ª—É—á–∞–µ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ–≥–æ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —ç—Ç–æ –ª–µ–≥–∫–æ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å, 
#    –æ—Ç–ª–æ–∂–∏–≤ –ø–æ MOE –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –æ—Ç –∏–º–µ—é—â–µ–π—Å—è —Ç–æ—á–µ—á–Ω–æ–π –æ—Ü–µ–Ω–∫–∏.
#    –≠—Ç–æ –≥—Ä–∞–Ω–∏—Ü—ã –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ - –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª CI (confidence interval).
#                            ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#    –§–æ—Ä–º—É–ª–∞ –¥–ª—è 95%:
# 
#    Œº - (1.96*SEM) ‚â§ x ‚â§ Œº + (1.96*SEM), –≥–¥–µ x - –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ
#
#     
#    –ü—Ä–∏–º–µ—Ä –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ:
#                _
#              _ | _
#             _  |  _
#            _   |   _
#           _ |  |  | _ 
#          ‚Äî  |  |  |  ‚Äî
#     ___‚Äî‚Äæ|  |  |  |  |‚Äæ‚Äî___
#    ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ‚Äæ      
#        -2  -1  0  1  2     œÉ
#     
#   –î–∏–∞–ø–æ–∑–æ–Ω: –æ—Ç -1 –¥–æ 1 - 68,26%
#             –æ—Ç -2 –¥–æ 2 - 95,44%
#   
#   –¢.–µ. —É—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è - –∫–∞–∫–æ–π –ø—Ä–æ—Ü–µ–Ω—Ç –ø–æ–ø–∞–¥–∞–µ—Ç –≤ —ç—Ç–∏ –≥—Ä–∞–Ω–∏—Ü—ã.
#
#   –í "—Ñ–æ—Ä–º—É–ª–µ" Œº - (1.96*SEM) ‚â§ x ‚â§ Œº + (1.96*SEM):
#   
#     1.96: 95.00%  –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–≤–µ—Ä–∞–ª;
#     1.00: 68.26%  –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–≤–µ—Ä–∞–ª –∏ —Ç.–¥. 
#    
#   –ü–æ—Å—á–∏—Ç–∞–µ–º:
    Œº  <- x.Stat(x, "Œº")
    X  <- x.Stat(x, "x")
    
#   –ü—Ä–∏–º–µ—Ä —Ä–∞—Å—á–µ—Ç–∞:    
#   (Œº - (MOE_sem),"‚â§",X ,"‚â§", Œº + (MOE_sem)
    
    for (i in 1:length(CL)){
      a <- 1-CL[i]
      z <- qt(0.5*a, n-1)
      z <- (0-z)
      MOE_sem <- z * SEM_s 
      cat("–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª CI –ø—Ä–∏ CL=", paste0(CL_n,"%:"), Œº - (MOE_sem),"‚â§",X ,"‚â§", Œº + (MOE_sem), "\n")
    }
    cat("\n")
    
#    –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞:
#    ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø
#    –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª CI —Å —É—Ä–æ–≤–Ω–µ–º –¥–æ–≤–µ—Ä–∏—è CL ‚Äî —Å—Ä–µ–¥—Å—Ç–≤–æ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ –≤–∏–¥–µ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –∑–Ω–∞—á–µ–Ω–∏–π, 
#    –∫–æ—Ç–æ—Ä—ã–π —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é, —Ä–∞–≤–Ω–æ–π CL, –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∏—Å—Ç–∏–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ, –Ω–∞–∫—Ä–æ–µ—Ç (cover) –µ–≥–æ.
# 

     if (CI_coeff==TRUE){
# 7) –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª CI –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
#    ¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø¬Ø 
#     7.1) –í—ã–±–æ—Ä–æ—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞ –∞—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω–æ –ø—Ä–∏ –ª—é–±—ã—Ö –µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è—Ö, –æ—Ç–ª–∏—á–Ω—ã—Ö –æ—Ç –Ω—É–ª—è. 
#          –ï—Å–ª–∏ –ø—Ä–∏–Ω—è—Ç—å –¥–æ–ø—É—â–µ–Ω–∏–µ –æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–≤—É–º–µ—Ä–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è (–æ–±–ª–∞–∫–æ —Ä–∞—Å—Å–µ–∏–≤–∞–Ω–∏—è –∏–º–µ–µ—Ç —Ñ–æ—Ä–º—É —ç–ª–ª–∏–ø—Å–∞), 
#          —Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ r –º–æ–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ç–∞–∫, 
#          —á—Ç–æ–±—ã –µ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –±–ª–∏–∑–∫–∏–º –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É:
           z_œÅ  <- atanh(cor(x, method = "pearson") [2]) 
           z_rs <- atanh(cor(x, method = "spearman")[2])

#          –≠—Ç–æ —Ç.–Ω. z-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§–∏—à–µ—Ä–∞, —Å–æ—Å—Ç–æ—è—â–µ–µ –≤ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏–∏ –∞—Ä–µ–∞—Ç–∞–Ω–≥–µ–Ω—Å–∞ (–æ–±—Ä–∞—Ç–Ω–æ–≥–æ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–æ–≥–æ —Ç–∞–Ω–≥–µ–Ω—Å–∞) r.

#     7.2) –î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ –Ω–∞–º —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞–π—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞, —Ç–∞–∫–∂–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–Ω—É—é –≤ z-–∑–Ω–∞—á–µ–Ω–∏–µ. 
#          –î–ª—è —ç—Ç–æ–≥–æ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–µ—Ä–≤—ã–π —ç—Ç–∞–ø –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–∏ SEr, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∫–∞–∫ SEz, —Ç.–µ. –∏–º–µ–Ω–Ω–æ –≤ –µ–¥–∏–Ω–∏—Ü–∞—Ö Z-—à–∫–∞–ª—ã.
           
           cat("–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:\n")
           
#          7.2.1) –ü–∏—Ä—Å–æ–Ω–∞:
           
#                 –§–æ—Ä–º—É–ª–∞:         –í—ã–±–æ—Ä–æ—á–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞ –¥–∞–ª–µ–∫–æ –æ—Ç 
#                          1       –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –∏ –º–µ–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–µ–ª–∏—á–∏–Ω—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞, –ø–æ—ç—Ç–æ–º—É 
#                 SEz = ‚àí‚àí‚àí‚àí‚àí‚àí     –≤—ã—á–∏—Å–ª–∏—Ç—å –µ–≥–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –æ—à–∏–±–∫—É –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–ª–æ–∂–Ω–µ–µ. –û–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –¥–≤–∞ —ç—Ç–∞–ø–∞:
#                       ‚àö(n-3)     —Å–Ω–∞—á–∞–ª–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤ –≤–∏–¥–µ z-–∑–Ω–∞—á–µ–Ω–∏—è.
             
                  SEz_œÅ <-1/sqrt(nrow(x)-3)
             
#                 –ó–∞—Ç–µ–º, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –∏–∑ Z-—à–∫–∞–ª—ã –≤ —à–∫–∞–ª—É –∑–Ω–∞—á–µ–Ω–∏–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ç.–µ.
#                 –æ–±—Ä–∞—Ç–Ω–æ–µ z-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –§–∏—à–µ—Ä–∞, —Ç.–µ. –Ω–∞–π—Ç–∏ –≥–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∏–π —Ç–∞–Ω–≥–µ–Ω—Å SEz:  
                  
                  SEr_œÅ <- tanh(SEz_œÅ)
                  
                  cat("‚Ä¢ –ü–∏—Ä—Å–æ–Ω–∞  œÅ: ",  SEr_œÅ, "\n")
                  
#          7.2.2) –°–ø–∏—Ä–º–µ–Ω–∞:                  
           
                  SEz_rs <- sqrt((1+rs^2/2)/(nrow(x)-3))
                  SEr_rs <- tanh(SEz_rs)
                  cat("‚Ä¢ –°–ø–∏—Ä–º–µ–Ω–∞ rs:",  SEr_rs, "\n\n")
                  

#     7.3) –î–∞–ª–µ–µ —Å—Ç—Ä–æ–∏–º –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Ç–µ–º –∂–µ —Å–ø–æ—Å–æ–±–æ–º, —á—Ç–æ –¥–ª—è –¥–æ–ª–∏ –∏ —Å—Ä–µ–¥–Ω–µ–≥–æ:
#          –ø–æ–º–æ—â—å—é SEz –Ω–∞—Ö–æ–¥–∏–º –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É –Ω–æ—Ä–º–∞–ª—å–Ω–æ–º—É —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫—É—é –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å MOE –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è –¥–æ–≤–µ—Ä–∏—è 
#          –∏ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –µ—ë –≤–ª–µ–≤–æ –∏ –≤–ø—Ä–∞–≤–æ –æ—Ç z-–∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ (—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –≤—ã—á–∏—Ç–∞–µ–º –∏–∑ –Ω–µ–≥–æ –∏ –ø—Ä–∏–±–∞–≤–ª—è–µ–º –∫ –Ω–µ–º—É).        

           cat("–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã CI –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏:\n")      
                  
           for (i in 1:length(CL)){
             # CL[i] <- CL[i]/100
             alpha <- (1 - CL[i])/2
             quantile <- qnorm(alpha)
             MOE_œÅ <- quantile * SEz_œÅ
             MOE_rs<- quantile * SEz_rs
             
#          –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è r, –æ—Å—Ç–∞—ë—Ç—Å—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±–∞ 
#          –Ω–∞–π–¥–µ–Ω–Ω—ã–µ z-–∑–Ω–∞—á–µ–Ω–∏—è –≥—Ä–∞–Ω–∏—Ü CI –≤ –∑–Ω–∞—á–µ–Ω–∏—è –∏—Å—Ö–æ–¥–Ω–æ–π —à–∫–∞–ª—ã –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ 
#          –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ —Ç–µ–º –∂–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º, –∫–æ—Ç–æ—Ä–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–æ—Å—å –ø—Ä–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏–∏ 
#          —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–∏, —Ç.–µ. –æ–±—Ä–∞—Ç–Ω—ã–º z-–ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º –§–∏—à–µ—Ä–∞. –î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π 
#          –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–∞–Ω–≥–æ–≤–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ rs –°–ø–∏—Ä–º–µ–Ω–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è —Ç–µ–º –∂–µ 
#          —Å–ø–æ—Å–æ–±–æ–º, –Ω–æ —Å–æ —Å–≤–æ–µ–π —Ñ–æ—Ä–º—É–ª–æ–π –¥–ª—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –æ—à–∏–±–∫–∏.
             
           CImin_œÅ  <- tanh(z_œÅ + MOE_œÅ) # –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –µ—ë –≤–ª–µ–≤–æ –∏ –≤–ø—Ä–∞–≤–æ –æ—Ç z-–∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 
           CImax_œÅ  <- tanh(z_œÅ - MOE_œÅ)
           
           CImin_rs <- tanh(z_rs + MOE_rs) # –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –µ—ë –≤–ª–µ–≤–æ –∏ –≤–ø—Ä–∞–≤–æ –æ—Ç z-–∑–Ω–∞—á–µ–Ω–∏—è –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ 
           CImax_rs <- tanh(z_rs - MOE_rs)
           
           cat("‚Ä¢ –ü–∏—Ä—Å–æ–Ω–∞:  –ø—Ä–∏ CL=", paste0(CL[i]*100,"%:"), (CImin_œÅ)," ‚àí ", (CImax_œÅ), "\n")
           cat("‚Ä¢ –°–ø–∏—Ä–º–µ–Ω–∞: –ø—Ä–∏ CL=", paste0(CL[i]*100,"%:"), (CImin_rs)," ‚àí ",(CImax_rs), "\n")
           
           CI.DF_cor <- data.frame("–ú–µ—Ç–æ–¥" =c("‚Ä¢ –ü–∏—Ä—Å–æ–Ω–∞: ", "‚Ä¢ –°–ø–∏—Ä–º–µ–Ω–∞:"),
                                   "–ø—Ä–∏ CI"=c(paste0(CL[i]*100,"%:"), paste0(CL[i]*100,"%:")),
                                   "CI min"=c(CImin_œÅ, CImin_rs),
                                   "CI max"=c(CImax_œÅ, CImax_rs)
                                   )
           }; print(CI.DF_cor) 
     }           
     
# 8) –†–∞—Å—á–µ—Ç –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –¥–ª—è –≥—Ä—É–ø–ø:  
     
     if (!is.null(CL_n_group)) { 
       CL_group <- CL_n_group/100
       a1 <- 1-CL_group
       
       x.grp.mean   <- tapply(x[[1]], x[[2]], FUN = mean)  
       x.grp.sd   <- tapply(x[[1]], x[[2]], FUN = sd) 
       
       n_group <- length(x.grp.sd)
       n <- nrow(x)/n_group
       
       SEM_vec <- 0
       MOE_sem_vec<- 0
       
#    Œº - MOE ‚â§ X ‚â§ Œº + MOE, –≥–¥–µ x - –≤—ã–±–æ—Ä–æ—á–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ
       
       CI.DF<- data.frame("var1")
       for (i in 1:n_group) {
         SEM_vec[i] <- x.grp.sd[[i]]/sqrt(n)
         MOE_sem_vec[i] <- (0 - qt(0.5*a1, n-1)) * SEM_vec[i]
   
         CI.DF[i,1]<-names(x.grp.sd[i])
         
         CI.DF[i,2]<-x.grp.mean[i] - (MOE_sem_vec[i])
         CI.DF[i,3]<-"‚â§"
         CI.DF[i,4]<-x.grp.mean[i]
         CI.DF[i,5]<-"‚â§"
         CI.DF[i,6]<-x.grp.mean[i] + (MOE_sem_vec[i])
         CI.DF[i,7]<-" "
         CI.DF[i,8]<-MOE_sem_vec[i]
         CI.DF[i,9]<-SEM_vec[i] 
         
         
         i<-i+1
         }
       
       cat("–î–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª CI –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –≥—Ä—É–ø–ø –ø—Ä–∏ CL =", paste0(CL_n_group,"%:"), "\n\n")  
       names(CI.DF) <- c("–≥—Ä—É–ø–ø–∞","Œº - MOE", "  ", "   X   ", "  ", "Œº + MOE", "", "MOE", "SEM")
       print(CI.DF)
       cat("\n\n")
         
       CI.DF2 <- CI.DF
       CI.DF2 <- CI.DF2[, -3]
       CI.DF2 <- CI.DF2[, -4]
       CI.DF2 <- CI.DF2[, -5]
       CI.DF2 <- CI.DF2[, -5]
       CI.DF2 <- CI.DF2[, -5]
       return(CI.DF2)
     }
}