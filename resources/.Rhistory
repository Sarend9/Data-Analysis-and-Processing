x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
View(x5)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
x5.tbl <- table(x5); x5.tbl
Static_output(x5)
View(Static_output)
op1 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
op2 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
#fb <- read.csv("data_fb.dat")
place.op1 <- "op1"
op1 <- cbind(op1, place.op1)
place.op2 <- "op2"
op2 <- cbind(op2, place.op2)
#place.fb <- "fb"
#fb <- cbind(fb, place.fb)
names(op1) <- c("res","op")
names(op2) <- c("res","op")
#names(fb) <- c("email","place")
email.soc <- rbind(op1, op2)
email.soc$res <- factor(email.soc$res) # перевод переменной из числового формата в фактор
levels(email.soc$res) <- c("prop", "true", "false")  # названия уровней
cont.table <- table(email.soc)
relat.cont.table <- cont.table/nrow(email.soc)
marg.rows <- vector()  # пустой вектор
marg.cols <- vector()  # пустой вектор
marg.rows <- apply(relat.cont.table, MARGIN = 1, FUN = sum)  # суммы по строкам
marg.cols <- apply(relat.cont.table, MARGIN = 2, FUN = sum)  # суммы по столбцам
model.prob <- marg.rows %o% marg.cols  # внешнее произведение векторов
model.freq <- model.prob*nrow(email.soc)
xi2 <- sum((cont.table-model.freq)^2/model.freq)
vc <- sqrt(xi2/(nrow(email.soc)*(min(nrow(cont.table),ncol(cont.table))-1)))
selected <- email.soc$op[email.soc$res=="prop"]
my_range <- function(x){max(x)-min(x)}
my_IQR <- function(x){quantile(x, 0.75) - quantile(x, 0.25)}
my_disp <- function(x){sum((x - mean(x)) ^ 2)/length(x)}
my_stdotk <- function(x){sqrt(my_disp(x))}
s2 <- function(x){sum((x - mean(x)) ^ 2)/(length(x)-1)}
s <- function(x){sqrt(s2(x))}
p <- length(selected)/nrow(email.soc)
sem <- function(x){s(x)/sqrt(length(x))}
sep <- sqrt((p*(1-p))/34)
al <- 1-0.95
moe <- (0-qnorm(0.5*al))*sep
selected
email.soc
selected
s2
s2(email.soc)
s2(email.soc[[1]])
s2(email.soc[1])
s2(email.soc[[2]])
p <- length(selected)/nrow(email.soc)
sem <- function(x){s(x)/sqrt(length(x))}
sep <- sqrt((p*(1-p))/34)
al <- 1-0.95
moe <- (0-qnorm(0.5*al))*sep
moe
p
nrow(email.soc)
nrow(selected)
length(selected)
length(selected)
nrow(email.soc)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(email.soc, p_SEP = 60)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
p <- length(selected)/nrow(email.soc)
Static_output(x5, p_SEP.onli = c(p, 34, 95))
Static_output(x5,CL_n - 95, p_SEP.onli = c(p, 34))
Static_output(x5, CL_n - 95, p_SEP.onli = c(p, 34))
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
# x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
# Если есть группы в столбце, то переводим их текст, чтобы функция распознала
x3[[1]] <- as.character(x3[[1]])
Anova.disp(x3, "Диаграмма", "Ось Х", "Ось Y")
Static_output(x3, 90, CL_n_group = 99)
# x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
# Если есть группы в столбце, то переводим их текст, чтобы функция распознала
x3[[1]] <- as.character(x3[[1]])
Anova.disp(x3, "Диаграмма", "Ось Х", "Ось Y")
Static_output(x3, 90, CL_n_group = 99)
Static_output(x3, CL_n = 95, p_SEP.onli = c(p, 34))
p <- length(selected)/nrow(email.soc)
op1 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
op2 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
#fb <- read.csv("data_fb.dat")
place.op1 <- "op1"
op1 <- cbind(op1, place.op1)
place.op2 <- "op2"
op2 <- cbind(op2, place.op2)
#place.fb <- "fb"
#fb <- cbind(fb, place.fb)
names(op1) <- c("res","op")
names(op2) <- c("res","op")
#names(fb) <- c("email","place")
email.soc <- rbind(op1, op2)
email.soc$res <- factor(email.soc$res) # перевод переменной из числового формата в фактор
levels(email.soc$res) <- c("prop", "true", "false")  # названия уровней
cont.table <- table(email.soc)
relat.cont.table <- cont.table/nrow(email.soc)
marg.rows <- vector()  # пустой вектор
marg.cols <- vector()  # пустой вектор
marg.rows <- apply(relat.cont.table, MARGIN = 1, FUN = sum)  # суммы по строкам
marg.cols <- apply(relat.cont.table, MARGIN = 2, FUN = sum)  # суммы по столбцам
model.prob <- marg.rows %o% marg.cols  # внешнее произведение векторов
model.freq <- model.prob*nrow(email.soc)
xi2 <- sum((cont.table-model.freq)^2/model.freq)
vc <- sqrt(xi2/(nrow(email.soc)*(min(nrow(cont.table),ncol(cont.table))-1)))
selected <- email.soc$op[email.soc$res=="prop"]
my_range <- function(x){max(x)-min(x)}
my_IQR <- function(x){quantile(x, 0.75) - quantile(x, 0.25)}
my_disp <- function(x){sum((x - mean(x)) ^ 2)/length(x)}
my_stdotk <- function(x){sqrt(my_disp(x))}
s2 <- function(x){sum((x - mean(x)) ^ 2)/(length(x)-1)}
s <- function(x){sqrt(s2(x))}
p <- length(selected)/nrow(email.soc)
sem <- function(x){s(x)/sqrt(length(x))}
sep <- sqrt((p*(1-p))/34)
al <- 1-0.95
moe <- (0-qnorm(0.5*al))*sep
p <- length(selected)/nrow(email.soc)
Static_output(x3, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x3, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(x3, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x3, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
op1 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
op2 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
#fb <- read.csv("data_fb.dat")
place.op1 <- "op1"
op1 <- cbind(op1, place.op1)
place.op2 <- "op2"
op2 <- cbind(op2, place.op2)
#place.fb <- "fb"
#fb <- cbind(fb, place.fb)
names(op1) <- c("res","op")
names(op2) <- c("res","op")
#names(fb) <- c("email","place")
email.soc <- rbind(op1, op2)
email.soc$res <- factor(email.soc$res) # перевод переменной из числового формата в фактор
levels(email.soc$res) <- c("prop", "true", "false")  # названия уровней
cont.table <- table(email.soc)
relat.cont.table <- cont.table/nrow(email.soc)
marg.rows <- vector()  # пустой вектор
marg.cols <- vector()  # пустой вектор
marg.rows <- apply(relat.cont.table, MARGIN = 1, FUN = sum)  # суммы по строкам
marg.cols <- apply(relat.cont.table, MARGIN = 2, FUN = sum)  # суммы по столбцам
model.prob <- marg.rows %o% marg.cols  # внешнее произведение векторов
model.freq <- model.prob*nrow(email.soc)
xi2 <- sum((cont.table-model.freq)^2/model.freq)
vc <- sqrt(xi2/(nrow(email.soc)*(min(nrow(cont.table),ncol(cont.table))-1)))
selected <- email.soc$op[email.soc$res=="prop"]
my_range <- function(x){max(x)-min(x)}
my_IQR <- function(x){quantile(x, 0.75) - quantile(x, 0.25)}
my_disp <- function(x){sum((x - mean(x)) ^ 2)/length(x)}
my_stdotk <- function(x){sqrt(my_disp(x))}
s2 <- function(x){sum((x - mean(x)) ^ 2)/(length(x)-1)}
s <- function(x){sqrt(s2(x))}
p <- length(selected)/nrow(email.soc)
sem <- function(x){s(x)/sqrt(length(x))}
sep <- sqrt((p*(1-p))/34)
al <- 1-0.95
moe <- (0-qnorm(0.5*al))*sep
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(x3)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(x3)
Static_output(x3[1])
Static_output(x3[[1]])
Static_output(x3[1])
x3[1][1]
x3[1][1][1]
Static_output(x3[1])
x3[1][[1]]
x3[[1]]
Static_output(x3[2])
Static_output(x3)
Static_output(x5, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
Static_output(email.soc, CL_n = c(90,95), p_SEP.onli = c(p, 34))
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
my_range(email.soc)
summary(email.soc)
IQR(email.soc)
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
View(x5)
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
# SEp - Если нужно посчитать с данными, где все столбцы не числовые:
# p_SEP.onli - первый параметр - p, второй n.
selected <- x5$result[x5$result=="пропуск"]
p <- length(selected)/nrow(x5)
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
# SEp - Если нужно посчитать с данными, где все столбцы не числовые:
# p_SEP.onli - первый параметр - p, второй n.
selected <- x5$result[x5$result=="пропуск"]
p <- length(selected)/nrow(x5)
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
# SEp - Если нужно посчитать с данными, где все столбцы не числовые:
# p_SEP.onli - первый параметр - p, второй n.
selected <- x5$result[x5$result=="пропуск"]
p <- length(selected)/nrow(x5)
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
op1 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
op2 <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
#fb <- read.csv("data_fb.dat")
place.op1 <- "op1"
op1 <- cbind(op1, place.op1)
place.op2 <- "op2"
op2 <- cbind(op2, place.op2)
#place.fb <- "fb"
#fb <- cbind(fb, place.fb)
names(op1) <- c("res","op")
names(op2) <- c("res","op")
#names(fb) <- c("email","place")
email.soc <- rbind(op1, op2)
email.soc$res <- factor(email.soc$res) # перевод переменной из числового формата в фактор
levels(email.soc$res) <- c("prop", "true", "false")  # названия уровней
cont.table <- table(email.soc)
relat.cont.table <- cont.table/nrow(email.soc)
marg.rows <- vector()  # пустой вектор
marg.cols <- vector()  # пустой вектор
marg.rows <- apply(relat.cont.table, MARGIN = 1, FUN = sum)  # суммы по строкам
marg.cols <- apply(relat.cont.table, MARGIN = 2, FUN = sum)  # суммы по столбцам
model.prob <- marg.rows %o% marg.cols  # внешнее произведение векторов
model.freq <- model.prob*nrow(email.soc)
xi2 <- sum((cont.table-model.freq)^2/model.freq)
vc <- sqrt(xi2/(nrow(email.soc)*(min(nrow(cont.table),ncol(cont.table))-1)))
selected <- email.soc$op[email.soc$res=="prop"]
my_range <- function(x){max(x)-min(x)}
my_IQR <- function(x){quantile(x, 0.75) - quantile(x, 0.25)}
my_disp <- function(x){sum((x - mean(x)) ^ 2)/length(x)}
my_stdotk <- function(x){sqrt(my_disp(x))}
s2 <- function(x){sum((x - mean(x)) ^ 2)/(length(x)-1)}
s <- function(x){sqrt(s2(x))}
p <- length(selected)/nrow(email.soc)
sem <- function(x){s(x)/sqrt(length(x))}
sep <- sqrt((p*(1-p))/34)
al <- 1-0.95
moe <- (0-qnorm(0.5*al))*sep
5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
# SEp - Если нужно посчитать с данными, где все столбцы не числовые:
# p_SEP.onli - первый параметр - p, второй n.
selected <- x5$result[x5$result=="пропуск"]
p <- length(selected)/nrow(x5)
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
# АВТО-РЕШЕНИЕ
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
# SEp - Если нужно посчитать с данными, где все столбцы не числовые:
# p_SEP.onli - первый параметр - p, второй n.
selected <- x5$result[x5$result=="пропуск"]
p <- length(selected)/nrow(x5)
#                                                почему 34 хз, так было в решении
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
# Задание №7 (Задание 10)
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE)
# Задание №8
library(ggplot2)
theme_set(theme_bw(base_size = 14))  # чёрно-белое оформление, базовый размер шрифта
fig<-ggplot(x7) +
aes(x = IQ, y = performance) +
geom_point() +
geom_smooth(method = 'lm', col = 'red', level = 0.9)
fig + xlab("IQ, балл") +
ylab("Успеваемость") +  ggtitle("Доверительная полоса")
View(Anova.regr)
View(Anova.regr)
View(Anova.disp)
View(Anova.regr)
View(Anova.disp)
View(Anova.disp)
View(Anova.regr)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
90/100
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
detach("package:ggplot2", unload = TRUE)
library(ggplot2)
ggplot(x5)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
library(ggplot2)
theme_set(theme_bw(base_size = 14))  # чёрно-белое оформление, базовый размер шрифта
fig<-ggplot(x7) +
aes(x = IQ, y = performance) +
geom_point() +
geom_smooth(method = 'lm', col = 'red', level = 0.9)
fig + xlab("IQ, балл") +
ylab("Успеваемость") +  ggtitle("Доверительная полоса")
fig
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
fig<-ggplot(x7) +
aes(x = IQ, y = performance) +
geom_point() +
geom_smooth(method = 'lm', col = 'red', level = 0.9)  + xlab("IQ, балл") +
ylab("Успеваемость") +  ggtitle("Доверительная полоса")
fig<-ggplot(x7) +
aes(x = IQ, y = performance) +
geom_point() +
geom_smooth(method = 'lm', col = 'red', level = 0.9)  + xlab("IQ, балл") +
ylab("Успеваемость") +  ggtitle("Доверительная полоса")
fig
x<-x7
x.gg <-ggplot(x) +
aes(y = x[[2]], x = x[[1]]) +
geom_point(col = 'blue', cex = 1.5) +
geom_smooth(method = 'lm', col = 'red', level = 0.9, fill = 'pink')+
labs(title = "main.plot",
y = "ylab.plot", x = "xlab.plot")
x.gg
x.gg
print(x.gg)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
x7<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/7-8.tests.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
str(x7)  # вывод сведений о структуре объекта
Anova.regr(x7, 90, FALSE, main.plot = "Доверительная полоса", xlab.plot = "IQ, балл", ylab.plot = "Успеваемость")
Anova.regr(x7, 90, FALSE)
# x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
# Если есть группы в столбце, то переводим их текст, чтобы функция распознала
x3[[1]] <- as.character(x3[[1]])
# Все названия сама проставит
Anova.disp(x3)
Anova.disp(x3, "Диаграмма", "Ось Х", "Ось Y")
Static_output(x3, 90, CL_n_group = 99)
# Задание №1 (Задание 9)
x1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/1-2.artist.dat")
x1_2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/1-2.techn.dat")
x1 <- cbind(x1, x1_2)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Pearson.P(x1)
# Задание №2
#На диаграмме двумерного распределения наблюдается нелинейная монотонная корреляция.
#Коэффициент ранговой корреляции Спирмена = -0.8820429 говорит о тесной связи переменных.
#Отрицательный знак корреляции Спирмена говорит об отрицательной корреляции,
#переменные изменяются разнонаправленно.
# Задание №3 (Задание 12)
# x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
x3<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/3-4.pults.dat")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
# Если есть группы в столбце, то переводим их текст, чтобы функция распознала
x3[[1]] <- as.character(x3[[1]])
# Все названия сама проставит
Anova.disp(x3)
Anova.disp(x3, "Диаграмма", "Ось Х", "Ось Y")
Static_output(x3, 90, CL_n_group = 99)
# Задание №4
# Задание №5 (Задание 8)
x5_op1<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator1.dat")
x5_op2<- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 2/5-6.operator2.dat")
x5_op1$action <- "Оператор 1"; head(x5_op1)
x5_op2$action <- "Оператор 2"; head(x5_op2)
x5 <- rbind(x5_op1, x5_op2)
x5$result <- factor(x5$result)
levels(x5$result) <- c("пропуск", "верное", "ложное")
# АВТО-РЕШЕНИЕ
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Cramer.V(x5)
# SEp - Если нужно посчитать с данными, где все столбцы не числовые:
# p_SEP.onli - первый параметр - p, второй n.
selected <- x5$result[x5$result=="пропуск"]
p <- length(selected)/nrow(x5)
#                                                почему 34 хз, так было в решении
Static_output(email.soc, CL_n = 95, p_SEP.onli = c(p, 34))
