#           предположение, что эти водители в целом различаются по
#           распределению протяжённости своих дневных поездок.
# 1) Дано:
x9   <- read.csv("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/drivers.dat")
P_true <- 0.5
#    1.1)
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
car1<-vector()
car2<-vector()
for (i in 1:nrow(x9)) {
if (x9$car[i]==2) {
car2[length(car2)+1]<- x9$distance[i]
}
else{
car1[length(car1)+1]<- x9$distance[i]
}
}
car1 <- x9[,2][x9[,1]==1]
car2 <- x9[,2][x9[,1]==2]
#    Или
car1 <- x9[[2]][x9[[1]]==1]
car2 <- x9[[2]][x9[[1]]==2]
ks.test(car1,car2) # критерий однородности Смирнова
p_value <- ks.test(car1,car2)[[2]]
if    (p_value < P_true)
{cat("\nНулевая гипотеза H0 - \033[1mотвергается\033[0m\n")
cat("Результат оказался статистически \033[1mзначимым\033[0m\n")
} else
{cat("\nНулевая гипотеза H0 - \033[1mне отвергается\033[0m\n")
cat("Результат оказался статистически \033[1mне значимым\033[0m\n")}
ks.test(car1,car2)
ks.test(x9)
ks.test(x9[[1]]~x9[[2]])
ks.test(x9[[2]]~x9[[1]])
x9[[2]]~x9[[1]]
# Вопрос 1.1: В экзаменационном тесте нужно отмечать как правильный один из двух вариантов ответа.
#             Всего в тесте 22 вопросов одинаковой трудности.
#             Учащийся правильно ответил на 19 вопросов.
#             Действительно ли учащийся что-то знает по
#             сдаваемому предмету или же отвечал наугад, и ему просто повезло?
# 1) Дано:
num_successes <- 19-1 # число успехов
num_attempts  <- 22   # число попыток
#    1.1) Сначала формулируем нулевую статистическую гипотезу: H0:Pверно=0.5.
#         Мы можем дать объяснение, что на самом деле учащемуся везде и отвечал на угал.
#         Иначе говоря, правильный ответ не связан со знанием, никакой закономерности
#         за отгадываниями не кроется
#         Гипотеза об отсутствии закономерности называется нулевой и обозначается H0
#                                                          ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
P_true <- 0.5 # вероятность успеха
#         Эту гипотезу о случайности угадывания мы можем сформулировать уже в статистических
#         терминах: нам могут чисто случайно попасться (случайная выборка) несколько правильных
#         ответов подряд, но в целом (в генеральной совокупности) правильные и неправильные ответы
#         встречаются одинаково часто (распределены равномерно). Такая гипотеза называется
#         статистической и может быть кратко записана в виде формулы: H0:Pверно=0.5.
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#    1.2) Для работы с биномиальным распределением в R имеется стандартный набор функций:
#         • pbinom(),
#         • qbinom(),
#         • dbinom(),
#         • rbinom().
cumulative_prob <- pbinom(q    = num_successes,    # число успехов
size = num_attempts,     # число попыток
prob = P_true)           # вероятность успеха
cumulative_prob
#                                                                                "19 - число успехов"
#         Таким образом мы вычислили кумулятивную вероятность верных ответов от 0 до 19.
#    1.3) Теперь вычтем её из 1 и получим кумулятивную вероятность верных ответов от 19 (число успехов) и больше:
p_value = 1 - cumulative_prob; p_value
# ИЛИ
# binom.test(x = num_successes,
#            n = num_attempts,
#            p = P_true)
#         -!ПРИМЕЧАНИЕ!-
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         Вероятность в статистике понимается как потенциальная встречаемость чего-либо.
#         p-значение — это встречаемость результата не хуже, чем наш, при условии, что нулевая гипотеза истинна.
#         p-значение — это НЕ вероятность того, что нулевая гипотеза истинна!
#         “Встречаемость гипотезы” — бессмыслица: гипотеза не встречается, она либо истинна, либо ложна.
#    1.4) Cудим по p-значению о том, насколько адекватна нулевая гипотеза и значим полученный результат.
#         Если p < 0.05, H0 отвергается, а результат расценивается как статистически значимый.
#                           ¯¯¯¯¯¯¯¯¯¯¯                                ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
cat("\n   • p-значение ", p_value,     "\n")
if    (p_value < 0.05)
{cat("\nНулевая гипотеза H0 - \033[1mотвергается\033[0m\n")
cat("Результат оказался статистически \033[1mзначимым\033[0m\n")
cat("Таким образом, гипотеза о том, что ... \033[1mподтвертидась\033[0m\n")
} else
{cat("\nНулевая гипотеза H0 - \033[1mне отвергается\033[0m\n")
cat("Результат оказался статистически \033[1mне значимым\033[0m\n")
cat("Таким образом, гипотеза о том, что ... \033[1mне подтвертидась\033[0m\n")}
#         -!ПРИМЕЧАНИЕ!-
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         проверка значимости имеет смысл, только если завершается
#         содержательным выводом относительно исходной гипотезы.
# Вопрос 1.2: Проверьте ту же гипотезу исследования при условии, что вариантов ответа
#             на каждый вопрос было не 2, а 4, и верных ответов оказалось 5 из 22.
# 2) Дано:
num_successes <- 5-1  # число успехов
num_attempts  <- 22 # число попыток
P_true <- 1/4 # вероятность успеха
cumulative_prob <- pbinom(q    = num_successes,    # число успехов
size = num_attempts,     # число попыток
prob = P_true)           # вероятность успеха
cumulative_prob
p_value = 1 - cumulative_prob; p_value
# # ИЛИ
#
# binom.test(x=5-1, n = 22, p = 1/4)
cat("\n   • p-значение ", p_value,     "\n")
cat("\nУчащийся в экзаменационном тесте правильно ответил в\n",
paste0(round(((num_successes+1)*100/ num_attempts)),"%"), "случаев, всего вопросов было", paste0(num_attempts,"."), "Для проверки
гипотезы о том, что он что-то знал по сдаваемому
предмету, использовался биномиальный критерий.")
if    (p_value < 0.05)
{cat("\nНулевая гипотеза H0 - \033[1mотвергается\033[0m\n")
cat("Результат оказался статистически \033[1mзначимым\033[0m\n")
cat("Таким образом, гипотеза (исследования) о том, что ... \033[1mподтвертидась.\033[0m\n")
} else
{cat("\nНулевая гипотеза H0 - \033[1mне отвергается\033[0m\n")
cat("Результат оказался статистически \033[1mне значимым\033[0m\n")
cat("Таким образом, гипотеза (исследования) о том, что ... \033[1mне подтвертидась.\033[0m\n")}
# Вопрос 2:
# Построим такую диаграмму для нулевой гипотезы на примере с
# угадыванием 5 раз из 22 и выделим цветом столбики, отображающие p-значение.
library(ggplot2)
# 1) Первая команда создаёт вектор success чисел возможных успехов:
#    от 0 до num_attempts из 22 попыток.
success <- 0:num_attempts
# 2) Затем функция data.frame создаёт таблицу данных, первым столбцом которой
#    становится вектор success, а вторым — вектор prob, в который мы тут же с
#    помощью dbinom() сохраняем вероятности биномиального распределения,
#    соответствующие значениям success.
tbl <- data.frame(success, prob = dbinom(success,
num_attempts, # число успехов
P_true))      # вероятность успеха
#    Заметим, что данные мы создали именно в виде таблицы: векторов
#    аргумент data функции ggplot не принимает.
num_successes<-(num_successes+1)
# 3) Теперь по полученной таблице построим диаграмму этого распределения:
ggplot() +
geom_col(aes(success, prob), data = tbl)  # столбиковая диаграмма по частотам
#    Слой geom_col() строит диаграмму со значениями success
#    по оси x и столбиками высотой prob из нашей таблицы.
#    Остаётся выделить столбики значений, отображающие p-
#    значение, т.е. суммарную вероятность успехов от "число успехов" и
#    выше. Для этого добавим ещё один такой же слой, но
#    другого цвета и с диапазоном значений x не ниже "число успехов":
ggplot(data = tbl, aes(success, prob)) +  # общие аргументы
geom_col() +  # столбиковая диаграмма
#                                         число успехов
geom_col(data = tbl[tbl$success >= num_successes, ], fill = "red")  # другой диапазон x и заливка цветом
#    С помощью фильтра мы отобрали из таблицы данных
#    только строки с числом успехов большим или равным "число успехов".
#    Дополнительно мы перенесли аргументы первого слоя
#    geom_col() в начало функции ggplot(): так они становятся
#    общими для всех слоёв.
# 4) Настроим внешний вид диаграммы, чтобы столбики были
#    не такие широкие, как у номинальной переменной:
plot.x1 <- ggplot(data = tbl, aes(success, prob)) +
geom_col(width = 0.4, fill = 'light gray', colour = "black") +  # узкие столбики с заливкой и контуром разных цветов
geom_col(data = tbl[tbl$success >= num_successes, ], width = 0.4, fill = "red", colour = 'brown') +
theme_bw() +  # ч/б тема
theme(panel.grid = element_blank(), plot.title = element_text(face = 'bold', hjust = 0.5))+  # отключение сетки
labs(title = "Распределения вероятностей вариантов ответа",
y = 'вероятность',
x = 'число верных ответов')
plot(plot.x1)
# Учащийся в экзаменационном тесте правильно ответил в 18% случаев, всего вопросов было 22. Для проверки гипотезы о том, что он что-то знал по сдаваемому предмету, использовался биномиальный критерий. Результат оказался статистически не значимым (p= 0.675).
# Таким образом, гипотеза о том, что учащийся что-то знал по сдаваемому предмету, не подтвердилась.
# Учащийся в экзаменационном тесте правильно ответил в 18% случаев, всего вопросов было 22. Для проверки гипотезы о том, что он что-то знал по сдаваемому предмету, использовался биномиальный критерий. Результат оказался статистически не значимым (p= 0.675).
# Таким образом, гипотеза о том, что учащийся что-то знал по сдаваемому предмету, не подтвердилась.
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 1-2 (13) биномиальный критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 1-2 (13) биномиальный критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 1-2 (13) биномиальный критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func3.R")
Binom_func_13.1(19, 22, 0.5)
Binom_func_13.1(5, 22, 1/4)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func3.R")
View(Kriteri_soglasia_X2_13.3)
Kriteri_soglasia_X2_13.3()
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 3-4 (13) критерий согласия χ2 Пирсона (одновыборочный).R")
Kriteri_soglasia_X2_13.3()
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 3-4 (13) критерий согласия χ2 Пирсона (одновыборочный).R")
View(x3)
table(x3) / sum(table(x3)) * 100
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 3-4 (13) критерий согласия χ2 Пирсона (одновыборочный).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 3-4 (13) критерий согласия χ2 Пирсона (одновыборочный).R")
View(x3)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 5-6 (13) критерия однородности χ2 Пирсона и точного критерия Фишера.R")
View(p_value)
View(x5)
View(x5_2)
View(x5_1)
View(x5_2)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 5-6 (13) критерия однородности χ2 Пирсона и точного критерия Фишера.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 5-6 (13) критерия однородности χ2 Пирсона и точного критерия Фишера.R")
table(x5)
mean(table(x5))
# Вопрос3: Получены следующие данные о географии заявок:
request <- c("МСК", "МСК", "СПБ", "СПБ", "СПБ", "МСК", "СПБ", "СПБ", "МСК", "ЕКБ")
# Определите:
#Объем наблюдений:
length(request)
#Абсолютная частота определенного элемента вектора:
table(request)["СПБ"]
#Относительная частота определенного элемента вектора:
(table(request)/length(request))["МСК"]
#Относительная частота заявок определенного элемента вектора в процентах:________
(table(request)/length(request))["ЕКБ"]*100
for (i in 1:nrow(table(x5[[1]]))){
(print(length(x5[[1]][x5[[1]]==i & x5[[2]]=="male"])/nrow(x5)*100))}
for (i in 1:nrow(table(x5[[1]]))){
(print(length(x5[[1]][x5[[1]]==i & x5[[2]]=="female"])/nrow(x5)*100))}
View(x5)
nrow(table(x5[[1]])))
nrow(table(x5[[1]]))
for (i in 1:nrow(table(x5[[1]]))){
(cat("группа:",i,"частота",(length(x5[[1]][x5[[1]]==i & x5[[2]]=="male"])/nrow(x5)*100))}
for (i in 1:nrow(table(x5[[1]]))){
(cat("группа:",i,"частота",(length(x5[[1]][x5[[1]]==i & x5[[2]]=="male"])/nrow(x5)*100), "\n"))}
x5[[2]]=="male"
x5[[2]]
x5[[2]][1]
table(x5[[2]])
table(x5[[2]])[1]
table(x5[[2]])[2]
table(x5[[2]])[[1]]
names(table(x5[[2]])[1])
cat("группа:", names(table(x5[[2]])[1]),"\n")
for (i in 1:nrow(table(x5[[1]]))){
(cat("группа:",i,"частота",(length(x5[[1]][x5[[1]]==i & x5[[2]]==names(table(x5[[2]])[1])])/nrow(x5)*100), "\n"))}
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 5-6 (13) критерия однородности χ2 Пирсона и точного критерия Фишера.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 5-6 (13) критерия однородности χ2 Пирсона и точного критерия Фишера.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 7-8 (13) критерий согласия Колмогорова (одновыборочный).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func3.R")
View(x7)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 13/Вопрос 9-10 (13) критерий однородности Смирнова (двухвыборочный).R")
View(x9)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
# Вопрос 1: Средний балл по учебному предмету за прошлые годы
#           составлял 6.5. В этом году преподаватель изменил форму
#           самостоятельной работы с бумажной на онлайновую,
#           после чего учащиеся получили индивидуальные баллы:
#           score.dat.
# 1) Дано:
x1 <- "score.dat"; x1   <- read.csv(paste0(dirname(rstudioapi::getSourceEditorContext()$path), "/", x1))
# 1) Проверьте предположение о том, что новая форма
#    самостоятельной работы повышает средний результат
#    обучения, предполагаемый размер этого эффекта d = 0.4,
#    при условии, что стандартное отклонение оценок за
#    прошлые годы составило 1 балл, и выбран уровень
#    значимости α=0.05.
#    1.1) Дано:
#         ¯¯¯¯
d <- 0.4           # - размер эффекта (d Коэна — это разность двух сравниваемых средних)
α <- 0.05
s <- 1             # - выборочное стандартное отклонение оценок за прошлые годы составило 1 балл
μ <- 6.5           # - генеральное среднее
x <- mean(x1[[1]]) # - выборочное среднее
N <- nrow(x1)
#    1.2) Введите статистику критерия:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
SEM <- s/sqrt(N)   # - Cтандартная ошибка выборочного среднего SEM
#         Вычисление z-критерия сводится к переводу разности между выборочным и
#         теоретическим (генеральным) средними в шкалу Z, для чего эту разность
#         делят на стандартную ошибку среднего:
z_test <- (x - μ)/SEM; z_test
#    1.3) Критическое значение:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         В рамках процедуры проверки гипотез по Нейману — Пирсону мы по тому же z-распределению
#         находим критическое значение как его квантиль, предварительно выбрав уровень значимости
#         В нашем примере при выбранной α = 0.05 критическое значение z_crit = z0.05.
z_crit <- qnorm(1-α); z_crit
#    1.4) Вычислите мощность критерия:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         *Альтернативную гипотезу обычно HA или H1
#         Вычислим мощность z-критерия, т.е. вероятность при верной "HA", имеющемся n
#         и выбранной α получить разность между средними, переведённую в Z-шкалу,
#         не меньше, чем критическое значение. Таким образом, нам нужно для нормального
#         распределения с единичным стандартным отклонением и центром, соответствующим
#         z-значению разности средних, найти суммарную вероятность значений не ниже zcrit.
#         Переводим разность средних в z-значение:
z_μA_μ0<-(d*s)/SEM # d Коэна — это разность двух сравниваемых средних
#         Мощность определяется как вероятность диапазона значений нормального
#         распределения с единичным стандартным отклонением и центром "z_μA_μ0,
#         ограниченного слева критическим значением "z_crit", либо стандартного
#         нормального  распределения, ограниченного значением z_power≈(z_crit−z_μA_μ0),
#         и составляет pnorm(-z_power).
z_power<- pnorm(-(z_crit - z_μA_μ0)); z_power
#    1.5) Примите решение:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
# if    (z_power > z_crit)
# {cat("\nПри уровне значимости - \033[1", paste0("α = ", α),"\033[0m\n")
#   cat("отклонена \033[1mнулевая\033[0m\nи принята \033[1mальтернативная\033[0m\")
#   cat("Таким образом, гипотеза о том, что ... \033[1mподтвертидась\033[0m\n")
#
#
#
#  отклонена нулевая гипотеза и принята альтернативная (z=4.47; d=0.46).
#   paste0("z = ", z_power, "d = ", d)
#
#
#
# } else
# {cat("\nНулевая гипотеза H0 - \033[1mне отвергается\033[0m\n")
#   cat("Результат оказался статистически \033[1mне значимым\033[0m\n")
#   cat("Таким образом, гипотеза о том, что ... \033[1mне подтвертидась\033[0m\n")}
#
#
#    1.6) Укажите полученный размер эффекта d:
#         Критерии согласия средних d Коэна:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         d Коэна — это разность двух сравниваемых средних, нормированная на стандартное
#         отклонение, т.е. выраженная в его единицах. Таким образом, чтобы определить d, нам
#         нужно знать стандартное отклонение переменной. Это стандартное отклонение либо
#         находят в результатах предыдущих исследований, либо пытаются сделать о нём более
#         или менее разумное предположение.
sd(x1[[1]]) # - выборочное стандартное отклонение
Cohens_D <- (x - μ)/ sd(x1[[1]]); Cohens_D
# или
library(lsr)
Cohens_D <- cohensD(x1[[1]], mu=μ); Cohens_D
#    1.7) Определите объём выборки, необходимый для мощности критерия 0.8 (не округляйте!):
#
#         Определим теперь, какой объём выборки необходим при той же α для достижения z-
#         критерием пороговой мощности 0.8. Начнём с уравнения минимального обнаруживаемого
#         размера эффекта (MDE), аналогично тому, как делали это для биномиального критерия:
#
#              (z_1-α + |z_β| * (σ/√n))     (z_1-α + |z_β|)
#         d = -------------------------- = -----------------
#                         σ                        √n
#
#         Из полученной краткой формулы MDE выводим уравнение необходимого объёма выборки:
#
#              z_1-α + |z_β|
#         n = (-------------)^2
#                     d
#
σ <- sqrt(sum((x1[[1]] - x)^2)/N)
n <- ((qnorm(1-α)+qnorm(0.8))/d)^2; n
# 2) Проверьте то же предположение при условии, что
#    стандартное отклонение оценок за прошлые годы
#    неизвестно.
#    2.1) Введите статистику критерия:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
t_test <- as.numeric(t.test(x1, mu = μ, alternative = 'greater')[[1]]); t_test
#    2.2) Критическое значение:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         Критическое значение находится как квантиль α либо 1 − α выборочного
#         распределения статистики критерия, аналогично первым шагам построения
#         доверительного интервала. В примере с отгадыванием руки, если выбрать α = 0.05,
#         то при 20 попытках критическое значение числа успехов окажется равным 15 —
df     <- as.numeric(t.test(x1, mu = μ, alternative = 'greater')[[2]]) # - степень свободы
t_crit <- qt(1-α, df); t_crit
#    2.3) Вычислите мощность критерия:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
#         Мощность статистического критерия вычисляется с помощью выборочного
#         распределения статистики критерия при верной альтернативной гипотезе.
#         Она находится по этому распределению как вероятность попадания
#         статистики критерия в критическую область.
sred  <- (x-μ)/sd(x1[[1]])
SEM_t <- s/sqrt(N)
t_μA_μ0 <- (Cohens_D*sd(x1[[1]]))/SEM_t # d Коэна — это разность двух сравниваемых средних
t_power <- t_crit - t_μA_μ0;  t_power
t_power <- pt(abs(t_power), df = df, ncp = sred); t_power
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))
library(pwr)
pwr.t.test(n = NULL, d = 0.4, power = 0.8, sig.level = 0.05)
pwr.t.test(n = n, d = Cohens_D, power = NULL, sig.level = 0.05)
#    2.4) Примите решение:
#         ¯¯¯¯¯¯¯¯¯¯¯¯¯¯¯
pwr.t.test(n = n, d = Cohens_D, power = NULL, sig.level = 0.05,
alternative = "greater")
# Для проверки гипотезы о влиянии новой формы самостоятельной работы на средний результат обучения применялся одновыборочный z-критерий.
# При уровне значимости α = 0.05 отклонена нулевая гипотеза и принята альтернативная (z=4.47; d=0.46).
# Полученная оценка размера эффекта d = 0.46, говорит о слабой связи между переменными.
# Таким образом, подтвердилась гипотеза исследования: новая форма самостоятельной работы повышает средний результат обучения.
#
# При проверке той же гипотезе при условии, что стандартное отклонение оценок за прошлые годы неизвестно, применялся одновыборочный t-критерий.
# При уровне значимости α = 0.05 отклонена нулевая гипотеза и принята альтернативная (t=2.11; d=0.4).
# Таким образом, подтвердилась гипотеза исследования: новая форма самостоятельной работы повышает средний результат обучения.
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
z_test <- (x - μ)/SEM; z_test
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))[[1]]
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))[[2]]
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))[[3]]
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))[[4]]
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))[[5]]
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — тест/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
α
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
t_power
t_power <- power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = α,
type = "paired",
alternative = c("one.sided"))
power.t.test(N,
delta = d*sd(x1[[1]]),
sd = sd(x1[[1]]),
sig.level = 0.05,
type = "paired",
alternative = c("one.sided"))[[5]]
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 3-4 (14) двухвыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 3-4 (14) двухвыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 3-4 (14) двухвыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 3-4 (14) двухвыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 3-4 (14) двухвыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 3-4 (14) двухвыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
View(x4)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
View(x4)
r.Pirson <- cor.test(Second_variable, Intercept)[[4]]; r.Pirson
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
Pearson.P(x4)
Pearson.P(x4)
x4[c(1,2)]
Pearson.P(x4[c(1,2)])
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Функции для R/R_test_func2.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 16/Вопрос 3-5 (16).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 16/Вопрос 3-5 (16).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 16/Вопрос 3-5 (16).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 16/Вопрос 3-5 (16).R")
cor.test(Second_variable, Intercept)
summary(lm(Intercept ~ Second_variable + Third_variable, data = x3)
)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 16/Вопрос 3-5 (16).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
View(x4)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 16/Вопрос 3-5 (16).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 15/Вопрос 5 (15).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 15/Вопрос 5 (15).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 14/Вопрос 1-2 (14) одновыборочный t-критерий.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 15/Вопрос 5 (15).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/Задание 15/Вопрос 5 (15).R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
file <- " results.dat"; x5   <- read.csv(paste0(dirname(rstudioapi::getSourceEditorContext()$path), "/", file)); rm(file)
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
results.dat
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
source("C:/Users/ak179/OneDrive/Магистратура/2 КУРС/1 СЕМЕСТР/Лекции (2 курс)/Язык R (шпоры и задачи)/Скрипты/КР 3 — финал/KR3.R")
